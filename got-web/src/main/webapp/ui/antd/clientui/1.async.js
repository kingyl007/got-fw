(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[1],{"+B/R":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("jCWc");var r=i(a("kPKH"));a("14J3");var s=i(a("BMrR")),n=i(a("MVZn"));a("sRBo");var d=i(a("kaz8"));a("ozfa");var u,c,f=i(a("MJZm")),h=a("MuoO"),m=(i(a("usdK")),l(a("dNXO"))),p=i(a("wVw7")),v=f.default.TreeNode,g=d.default.Group,w="1",y="0";function C(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout,o=e.grid,r=o.data,s=o.fwPage;return{loading:e.loading.models.grid||e.loading.models.fw,dispatch:a,fwCoord:l,layout:i,fwPage:s,data:r}}var D=e=>{return{getSelectData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getSelectData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},saveSelectData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/saveSelectData",payload:{fwCoord:a,fwParam:l,callback:i}})},deleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/deleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},getGridData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getGridData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},loadLayout:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,fwParam:l,callback:i}})}}},E=(u=(0,h.connect)(C,D),u(c=class extends o.Component{isResourceChecked(e){return void 0!=e.HAVE_PRIVILEGE?e.HAVE_PRIVILEGE:null}constructor(e){super(e),this.getSelectData=(e=>{var t=e.fwPage,a=e.fwParam,l=e.fwCoord,i=(0,n.default)({},this.state.fwParam,a);this.props.getSelectData({fwPage:(0,n.default)({},this.state.fwPage,t),fwParam:i,fwCoord:(0,n.default)({},this.getFwCoord(),l),callback:e=>{this.setState({fwPage:e.page,data:e.data})}})}),this.getGridData=(e=>{var t=e.fwPage,a=e.fwParam,l=e.fwCoord,i=(0,n.default)({},this.state.fwParam,a);this.props.getGridData({fwPage:(0,n.default)({},this.state.fwPage,t),fwParam:i,fwCoord:(0,n.default)({},this.getFwCoord(),l),callback:e=>{this.setState({fwPage:e.page,data:e.data})}})}),this.pageChangeHandler=function(e,t){this.getGridData({fwPage:{pageNumber:e,pageSize:t}})},this.OP_COL={title:"Operation",dataIndex:"_FW_ACTIONS",render:(e,t,a)=>o.default.createElement("span",{className:p.default.operation},(this.getLayout().otherActions["inList"]?this.getLayout().otherActions["inList"]:[]).filter(e=>1==e.visible).map((e,l)=>{return e.fw_index=l,this.getActionEntry(e.click).layout(this,e.id,t,a)}))},this.COLS=[{title:"\u529f\u80fd\u6743\u9650",dataIndex:"RES_NAME"}],this.getDataLevel=(e=>{return void 0!=e.DATA_LEVEL_MAP?e.DATA_LEVEL_MAP:[]}),this.setPrivilege=((e,t)=>{var a=t.HAVE_PRIVILEGE,l=t.DATA_LEVEL;void 0!=a&&(e.HAVE_PRIVILEGE=a),void 0!=l&&(e.DATA_LEVEL_MAP=l),this.state.changedResource[e.PKEY]=e}),this.onRowCheckedChange=function(e,t,a,l,i,o){var r=a?w:y;if(this.setPrivilege(t,{HAVE_PRIVILEGE:r}),t.nodes&&t.nodes.map(e=>this.onRowCheckedChange(t,e,a,null,i,o+1)),this.state.expandedFunctions[t.PKEY]){t.columnList&&t.columnList.map(e=>this.setPrivilege(e,{HAVE_PRIVILEGE:r})),t.actionList&&t.actionList.map(e=>this.setPrivilege(e,{HAVE_PRIVILEGE:r}));var s=this.getDataLevel(t);if(s)Object.keys(s).map(e=>s[e]=r);else{var n=this.buildDataLevelOptions(t);s={},n.map(e=>s[e.value]=r),this.setPrivilege(t,{DATA_LEVEL:s})}}this.setState({layout:this.state.layout})},this.onExpandFunction=function(e,t,a){if(e)if(this.state.expandedFunctions[t.PKEY]&&!a);else{var l={selectedData:(0,n.default)({},t)},i=a||this.getLayout();l.selectedData[i.ROLE_ID_KEY]=i[i.ROLE_ID_KEY],this.props.loadLayout({fwCoord:this.getFwCoord(),fwParam:l,callback:e=>{e.actionList&&e.actionList.map(e=>{null==this.isResourceChecked(e)&&this.isResourceChecked(t)==w&&this.setPrivilege(e,{HAVE_PRIVILEGE:w})}),e.columnList&&e.columnList.map(e=>{null==this.isResourceChecked(e)&&this.isResourceChecked(t)==w&&this.setPrivilege(e,{HAVE_PRIVILEGE:w})}),t.actionList=e.actionList,t.columnList=e.columnList,this.state.expandedFunctions[t.PKEY]=t,this.setState({layout:this.getLayout(),expandedFunctions:this.state.expandedFunctions})}})}},this.onCheckGroupChange=((e,t)=>{console.info("onCheckGroupChange",e,t),e.map(e=>this.setPrivilege(e,{HAVE_PRIVILEGE:t.indexOf(e.PKEY)>=0?w:y})),this.setState({layout:this.state.layout})}),this.onCheckAllChange=((e,t,a)=>{var l=a.target.checked;t.map(e=>this.setPrivilege(e,{HAVE_PRIVILEGE:l?w:y})),this.setState({layout:this.state.layout})}),this.onDataLevelCheckGroupChange=((e,t)=>{var a=this.getDataLevel(e);a||(a={},this.setPrivilege(e,{DATA_LEVEL:a})),t.map(e=>a[e]=w),Object.keys(a).map(e=>t.some(t=>t==e)?null:a[e]=y),this.setPrivilege(e,{DATA_LEVEL:a}),this.setState({layout:this.getLayout()})}),this.onDataLevelCheckAllChange=((e,t,a)=>{var l=a.target.checked;l?this.onDataLevelCheckGroupChange(e,t.map(e=>e.value)):this.onDataLevelCheckGroupChange(e,[])}),this.buildDataLevelOptions=(e=>{var t=[];if(e.HAVE_CUST_COL==w||e.HAVE_DEPT_COL==w||e.HAVE_OWNER_COL==w){var a=this.getLayout().dictMap.DATA_LEVEL;t.push({label:a[0],value:"0"}),e.HAVE_CUST_COL==w&&Object.keys(a).filter(e=>e>0&&e<9).map(e=>t.push({value:e,label:a[e]})),e.HAVE_DEPT_COL==w&&Object.keys(a).filter(e=>e>10&&e<19).map(e=>t.push({value:e,label:a[e]})),e.HAVE_OWNER_COL==w&&Object.keys(a).filter(e=>e>20&&e<29).map(e=>t.push({value:e,label:a[e]}))}return t}),this.buildFunctionSubPanels=(e=>{var t=e.actionList?e.actionList.map(e=>({label:e.RES_NAME,value:e.PKEY})):[],a=e.columnList?e.columnList.map(e=>({label:e.RES_NAME,value:e.PKEY})):[],l=this.buildDataLevelOptions(e),i=null;t.length>0&&(i=o.default.createElement("div",null,o.default.createElement("div",{style:{borderBottom:"1px solid #E9E9E9"}},o.default.createElement(d.default,{indeterminate:e.actionList.some(e=>this.isResourceChecked(e)==w)&&e.actionList.some(e=>this.isResourceChecked(e)!=w),onChange:t=>this.onCheckAllChange(e,e.actionList,t),checked:e.actionList.every(e=>this.isResourceChecked(e)==w)},o.default.createElement("b",null,"\u64cd\u4f5c"))),o.default.createElement(g,{options:t,defaultValue:e.actionList.filter(e=>this.isResourceChecked(e)==w).map(e=>e.PKEY),value:e.actionList.filter(e=>this.isResourceChecked(e)==w).map(e=>e.PKEY),onChange:t=>this.onCheckGroupChange(e.actionList,t)}),o.default.createElement("br",null),o.default.createElement("br",null)));var r=null;a.length>0&&(r=o.default.createElement("div",null,o.default.createElement("div",{style:{borderBottom:"1px solid #E9E9E9"}},o.default.createElement(d.default,{indeterminate:e.columnList.some(e=>this.isResourceChecked(e)==w)&&e.columnList.some(e=>this.isResourceChecked(e)!=w),onChange:t=>this.onCheckAllChange(e,e.columnList,t),checked:e.columnList.every(e=>this.isResourceChecked(e)==w)},o.default.createElement("b",null,"\u5217"))),o.default.createElement(g,{options:a,defaultValue:e.columnList.filter(e=>this.isResourceChecked(e)==w).map(e=>e.PKEY),value:e.columnList.filter(e=>this.isResourceChecked(e)==w).map(e=>e.PKEY),onChange:t=>this.onCheckGroupChange(e.columnList,t)}),o.default.createElement("br",null),o.default.createElement("br",null)));var s=null;if(l.length>0){var n=this.getDataLevel(e),u=this.isResourceChecked(e);null==n&&(n={},l.map(e=>n[e.value]=u),this.setPrivilege(e,{DATA_LEVEL:n})),s=o.default.createElement("div",null,o.default.createElement("div",{style:{borderBottom:"1px solid #E9E9E9"}},o.default.createElement(d.default,{indeterminate:l.some(e=>n[e.value]==w)&&l.some(e=>n[e.value]!=w),onChange:t=>this.onDataLevelCheckAllChange(e,l,t),checked:l.every(e=>n[e.value]==w)},o.default.createElement("b",null,"\u6570\u636e\u6743\u9650"))),o.default.createElement(g,{options:l,defaultValue:Object.keys(n).filter(e=>n[e]==w),value:Object.keys(n).filter(e=>n[e]==w),onChange:t=>this.onDataLevelCheckGroupChange(e,t)}),o.default.createElement("br",null),o.default.createElement("br",null))}return i||r||s?o.default.createElement("div",null,i,r,s):o.default.createElement("div",null,"\u65e0\u6570\u636e")}),this.onTreeNodeChecked=((e,t)=>{console.info("onTreeNodeChecked",t);var a={};e&&e.map(e=>{a[e]=!0}),this.setState({selectedResource:a})}),this.renderTreeNodes=(e=>e?e.map(e=>o.default.createElement(v,{title:e.RES_NAME,key:e.PKEY,dataRef:e},this.renderTreeNodes(e.nodes))):null),this.findNode=((e,t)=>{var a=t;if(void 0==a)a=this.getLayout().gotResource;else if(null==t||t.length<1)return null;var l=a.filter(t=>t[this.getLayout().argument.treeIdField]==e);if(l.length>0)return l[0];var i=a.filter(e=>e.nodes&&e.nodes.length>0).map(t=>this.findNode(e,t.nodes)).filter(e=>!!e);return i.length>0?i[0]:null}),this.getSelectedNodes=((e,t)=>{e&&Array.isArray(e)&&e.filter(e=>e.nodes).map(e=>{e.nodes.filter(e=>e.HAVE_PRIVILEGE==w).map(e=>t[e.PKEY]=!0),this.getSelectedNodes(e.nodes,t)})}),this.getLayout=(()=>{return this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,n.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return m.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.state=(0,n.default)({},e,{fwParam:(0,n.default)({},e.fwParam),buttonSize:e.buttonSize?e.buttonSize:"default",tableSize:e.tableSize?e.tableSize:"small",showSelectCol:!!e.showSelectCol&&e.showSelectCol,queryPanelExpanded:!1,expandedAllGroup:!0,dialogs:{},actionInList:[],changedResource:{},expandedFunctions:{},expandedKeys:[],selectedResource:null,checkStrictly:!1})}componentWillReceiveProps(e){if((JSON.stringify(e.openerSelectedData)!=JSON.stringify(this.props.openerSelectedData)||e.innerLayout!=this.getLayout())&&e.innerLayout){e.innerLayout.gotResource.map(e=>{this.state.expandedFunctions[e.PKEY]&&(this.state.expandedFunctions[e.PKEY]=e),e.nodes&&e.nodes.map(e=>{this.state.expandedFunctions[e.PKEY]&&(this.state.expandedFunctions[e.PKEY]=e)})});var t=e.innerLayout.gotResource.map(e=>e.PKEY),a={};this.getSelectedNodes(e.innerLayout.gotResource,a),this.setState({selectedResource:a,expandedKeys:t}),Object.values(this.state.expandedFunctions).map(t=>this.onExpandFunction(!0,t,e.innerLayout)),this.setState({changedResource:{},expandedAllGroup:!0})}}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.getLayout().onQuery&&this.getActionEntry(this.getLayout().onQuery).logic(this,this.getLayout().onQuery,null,-1,null)}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=m.buildGridMenus(this,p.default),t=m.buildGridQueryArea(this);return o.default.createElement("div",{className:p.default.normal,style:this.props.style},o.default.createElement("div",{style:{width:"95%",margin:"10px"}},o.default.createElement(s.default,null,t),o.default.createElement(s.default,null,o.default.createElement(r.default,{span:24,style:{textAlign:"right"}},e))),o.default.createElement("div",{className:"search-result-list",style:{width:"95%",margin:"10px"}},o.default.createElement(f.default,{checkable:!0,checkStrictly:this.state.checkStrictly,autoExpandParent:this.state.expandedAllGroup,defaultCheckedKeys:this.getLayout().gotResource?this.getLayout().gotResource.filter(e=>e.HAVE_PRIVILEGE==w).map(e=>e.PKEY):[],checkedKeys:Object.keys(this.state.selectedResource?this.state.selectedResource:{}),onCheck:(e,t)=>this.onTreeNodeChecked(e,t),expandedKeys:this.state.expandedKeys,onExpand:(e,t)=>{t.expanded,t.node;return this.setState({expandedKeys:e})}},o.default.createElement(v,{title:"\u5168\u90e8",key:"FW_ALL"},this.renderTreeNodes(this.getLayout().gotResource)))),Object.values(this.state.dialogs))}})||c);t.default=E},"+Se9":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("T2oS");var r=i(a("W9HT"));a("8dk+");var s=i(a("eZ87"));a("IzEo");var n=i(a("bx4M"));a("14J3");var d=i(a("BMrR"));a("jCWc");var u=i(a("kPKH"));a("+L6B");var c=i(a("2/Rp")),f=i(a("pVnL"));a("miYZ");var h=i(a("tsqr")),m=i(a("MVZn"));a("7Kak");var p=i(a("9yH6"));a("OaEy");var v=i(a("2fM7"));a("y8nQ");var g=i(a("Vl3Y"));a("B9cy");var w,y,C=i(a("Ol7k")),D=a("MuoO"),E=(i(a("usdK")),l(a("dNXO"))),b=i(a("wVw7")),S=a("0Fy/"),L={labelCol:{xs:{span:8},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16}}},P=(C.default.Header,C.default.Footer,C.default.Sider),k=C.default.Content,I=g.default.Item,R=v.default.Option,T=p.default.Group;function A(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout,o=e.grid,r=o.data,s=o.fwPage;return{loading:e.loading.models.grid||e.loading.models.fw,editLoading:e.loading.models.edit,dispatch:a,fwCoord:l,layout:i,fwPage:s,data:r}}var _=e=>{return{getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},getSelectData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getSelectData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},saveSelectData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/saveSelectData",payload:{fwCoord:a,fwParam:l,callback:i}})},validDeleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/validDeleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},deleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/deleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},getGridData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.otherParams,r=t.callback;e({type:"grid/getGridData",payload:{fwPage:a,fwParam:l,fwCoord:i,otherParams:o,callback:r}})},loadLayout:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,fwParam:l,callback:i}})}}},O=(w=(0,D.connect)(A,_),w(y=class extends o.Component{constructor(e){super(e),this.getSelectData=(e=>{var t=e.fwPage,a=e.fwParam,l=e.fwCoord,i=(0,m.default)({},this.state.fwParam,{openerSelectedData:(0,m.default)({},this.props.openerSelectedData)},a);this.props.getSelectData({fwPage:(0,m.default)({},this.state.fwPage,t),fwParam:i,fwCoord:(0,m.default)({},this.getFwCoord(),l),callback:e=>{this.setState({fwPage:e.page?e.page:{},data:e.data})}})}),this.getGridData=(e=>{var t=e.fwPage,a=e.fwParam,l=e.fwCoord,i=e.otherParams;console.info("getGridData",JSON.stringify(this.state.otherParams));var o=this.getLayout(),r=o.columnMap,s=this.state.queryColumnValues,n=Object.keys(s).map(e=>{if(s[e]){var t=r[e];if(t){if(t.dictionary)return{field:t.id,operator:"=",value1:s[e]};if("DATE"==t.type||"DATETIME"==t.type)return s[e][0]&&s[e][1]?{field:t.id,operator:"BETWEEN",value1:s[e][0],value2:s[e][1]}:void 0}return{field:e,operator:"LIKE",value1:s[e]}}}).filter(e=>e),d=(0,m.default)({},this.state.fwParam,{conditions:n,selectedTreeNodeId:this.props.selectedTreeNodeId?this.props.selectedTreeNodeId:null,treeConnectColumn:this.props.gridToTreeField?this.props.gridToTreeField:null},a);this.props.getGridData({otherParams:(0,m.default)({},this.state.otherParams,i),fwPage:(0,m.default)({},this.state.fwPage,t),fwParam:d,fwCoord:(0,m.default)({},this.getFwCoord(),l),callback:e=>{var t=d.queryType;"member"==t?(this.setState({fwPage:e.page,memberData:e.data}),this.showMembers(e.data)):(this.setState({fwPage:e.page,shopData:e.data}),this.showShops(e.data,this.state.radius))}})}),this.showShops=((e,t)=>{e.map((e,l)=>{e.LAT>0&&e.LNG>0&&this.state.map.showPoint({id:"shop"+e.SID,name:e.NAME,lat:e.LAT,lng:e.LNG,icon:a("AXMr"),radius:1e3*t,lineColor:"#ff0000",centerToOverlay:0==l,lineThickness:1,fillColor:"#ff0000"})})}),this.queryMember=(e=>{this.getGridData({fwParam:{queryType:"member"}})}),this.showMembers=(e=>{this.state.map.clearClusters(),Object.keys(this.state.addedMembers).map(e=>this.state.map.deletePoint(e)),(!e||e.length<1)&&h.default.info("\u6ca1\u6709\u7b26\u5408\u6761\u4ef6\u7684\u4f1a\u5458"),this.state.addedMembers={};var t=0;e.map(e=>{if(e.LAT>0&&e.LNG>0){var l="<b>"+e.MEMBER_NAME+" ("+this.getLayout().dictMap["MEMBER_LEVEL"][e.MEMBER_LEVEL]+") /"+e.VEHICLE_NUM+"</b><br>";e.GPS_TIME&&(l+=e.GPS_TIME+"<br>");var i=e.ADDRESS?e.ADDRESS.split("\u3001").join(""):"";l+=i+"(<a href='javascript:{window.copy(\""+i+'");window.message.info("\u590d\u5236\u6210\u529f")}\'>\u590d\u5236</a>)',this.state.map.showPoint({id:"member"+e.SID,name:e.MEMBER_NAME,lat:e.LAT,lng:e.LNG,centerToOverlay:!1,icon:a("bOKo"),doneCallback:(e,t)=>this.markerAddedCallback(e,t),infoContent:l}),++t}}),this.setState({validMemberCount:t})}),this.markerAddedCallback=((e,t)=>{this.state.addedMembers[e]=t,Object.keys(this.state.addedMembers).length==this.state.validMemberCount&&this.state.map.clusterMarkers(Object.values(this.state.addedMembers))}),this.pageChangeHandler=function(e,t){this.getGridData({fwPage:{pageNumber:e,pageSize:t}})},this.OP_COL={title:"Operation",dataIndex:"_FW_ACTIONS",render:(e,t,a)=>o.default.createElement("span",{className:b.default.operation},(this.getLayout().otherActions["inList"]?this.getLayout().otherActions["inList"]:[]).filter(e=>1==e.visible).map((e,l)=>{return e.fw_index=l,this.getActionEntry(e.click).layout(this,e.id,t,a)}))},this.handleQueryInputChange=((e,t)=>{console.info("input",e,t.target.value);var a=this.state.queryColumnValues;a[e]=t.target.value,this.setState({queryColumnValues:a})}),this.handleQuerySelectChange=((e,t,a)=>{console.info("select",e,t,a);var l=this.state.queryColumnValues,i=this.state,o=i.brand,r=i.serial,s=i.type;l[e]=void 0==t?null:Array.isArray(t)?t.join(","):t,"CAR_BRAND"==e?(o=t,r="",s=""):"CAR_SERIAL"==e?(r=t,s=""):"CAR_TYPE"==e&&(s=t),this.setState({queryColumnValues:l,brand:o,serial:r,type:s})}),this.handleQueryDateRangeChange=((e,t,a)=>{console.info("date",e,t,a);var l=this.state.queryColumnValues;l[e]=a,this.setState({queryColumnValues:l})}),this.radiusChange=(e=>{this.setState({radius:e}),this.showShops(this.state.shopData,e)}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,m.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.onComponentRef=((e,t)=>{this.state.components[e]=t}),this.getComponent=(e=>{return this.state.components[e]}),this.getActionEntry=function(e){return E.getActionEntry(this,e)},this.handleAction=function(e,t,a){var l=null,i=null;t?(l=t,i=e):(l=e.key,i=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[l].click).logic(this,l,a,-1,i)},this.state=(0,m.default)({},e,{gridResult:{},fwParam:(0,m.default)({},e.fwParam),otherParams:{},buttonSize:e.buttonSize?e.buttonSize:"default",tableSize:e.tableSize?e.tableSize:"middle",showSelectCol:!!e.showSelectCol&&e.showSelectCol,selectedRecord:{},selectedRowKeys:[],queryPanelExpanded:!1,dialogs:{},components:{},actionInList:[],queryColumnValues:{},radius:5,brand:"",serial:"",type:"",addedMembers:{},validMemberCount:0})}componentWillReceiveProps(e){if(console.info(e.openerSelectedData!=this.props.openerSelectedData,e.openerSelectedData,this.props.openerSelectedData),e.openerSelectedData||e.innerLayout||e.innerFwCoord||e.selectedTreeNodeId||e.otherParams){if(e.openerSelectedData!=this.props.openerSelectedData||e.innerLayout!=this.props.innerLayout||e.innerFwCoord!=this.props.innerFwCoord){console.info("grid receive props2",e);var t=e.innerLayout?e.innerLayout:this.getLayout();this.state.innerLayout=t,this.state.innerFwCoord=e.innerFwCoord,t.onQuery&&this.getActionEntry(t.onQuery).logic(this,t.onQuery,null,-1,null)}e.selectedTreeNodeId!=this.props.selectedTreeNodeId&&this.getGridData({fwParam:{selectedTreeNodeId:e.selectedTreeNodeId}}),e.otherParams!=this.props.otherParams&&(console.info("nextOtherParams",e.otherParams),this.getGridData({otherParams:e.otherParams}))}}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){this.getLayout().onQuery&&this.getActionEntry(this.getLayout().onQuery).logic(this,this.getLayout().onQuery,null,-1,null)}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e={0:"0",10:"10",20:"20"};return o.default.createElement(r.default,{spinning:this.props.loading},o.default.createElement("div",{style:{height:"100%"}},o.default.createElement(C.default,null,o.default.createElement(P,{width:300,style:{overflow:"auto",left:0,backgroundColor:"#ffffff"}},o.default.createElement(n.default,{title:"\u7b5b\u9009\u4f1a\u5458",style:{height:"100%"}},o.default.createElement(g.default,{layout:"vertical"},o.default.createElement(I,(0,f.default)({},L,{style:{paddingBottom:0},label:"\u8f66\u578b"}),o.default.createElement(v.default,{allowClear:!0,placeholder:"\u8bf7\u9009\u62e9",style:{width:"100%"},value:this.state.brand,onChange:(e,t)=>this.handleQuerySelectChange("CAR_BRAND",e)},o.default.createElement(R,{key:"_ALL",value:""},"\u5168\u90e8\u54c1\u724c"),Object.keys(this.getLayout().carModels).map(e=>o.default.createElement(R,{key:e,value:e},e)))),o.default.createElement(I,(0,f.default)({},L,{style:{paddingBottom:0},label:" "}),o.default.createElement(v.default,{allowClear:!0,placeholder:"\u8bf7\u9009\u62e9",disabled:!this.state.brand,style:{width:"100%"},value:this.state.serial,onChange:(e,t)=>this.handleQuerySelectChange("CAR_SERIAL",e)},o.default.createElement(R,{key:"_ALL",value:""},"\u5168\u90e8\u7cfb\u5217"),this.state.brand?Object.keys(this.getLayout().carModels[this.state.brand]).map(e=>o.default.createElement(R,{key:e,value:e},e)):null)),o.default.createElement(I,(0,f.default)({},L,{style:{paddingBottom:0},label:" "}),o.default.createElement(v.default,{allowClear:!0,placeholder:"\u8bf7\u9009\u62e9",disabled:!this.state.brand||!this.state.serial,style:{width:"100%"},value:this.state.type,onChange:(e,t)=>this.handleQuerySelectChange("CAR_TYPE",e)},o.default.createElement(R,{key:"_ALL",value:""},"\u5168\u90e8\u578b\u53f7"),this.state.brand&&this.state.serial?Object.keys(this.getLayout().carModels[this.state.brand][this.state.serial]).map(e=>o.default.createElement(R,{key:e,value:e},e)):null)),o.default.createElement(I,(0,f.default)({},L,{style:{paddingBottom:0},label:"\u4f1a\u5458\u7b49\u7ea7"}),o.default.createElement(v.default,{allowClear:!0,placeholder:"\u8bf7\u9009\u62e9",mode:"multiple",style:{width:"100%"},onChange:(e,t)=>this.handleQuerySelectChange("MEMBER_LEVEL",e)},Object.keys(this.getLayout().dictMap["MEMBER_LEVEL"]).map(e=>o.default.createElement(R,{key:e,value:e},this.getLayout().dictMap["MEMBER_LEVEL"][e])))),o.default.createElement(I,(0,f.default)({},L,{style:{paddingBottom:0},label:"\u8d2d\u8f66\u65e5\u671f"}),o.default.createElement(v.default,{allowClear:!0,placeholder:"\u8bf7\u9009\u62e9",mode:"multiple",style:{width:"100%"},onChange:(e,t)=>this.handleQuerySelectChange("BUY_DATE",e)},Object.keys(this.getLayout().dictMap["LATEST_RETURN_SHOP_SPAN"]).map(e=>o.default.createElement(R,{key:e,value:e},this.getLayout().dictMap["LATEST_RETURN_SHOP_SPAN"][e])))),o.default.createElement(I,(0,f.default)({},L,{style:{paddingBottom:0},label:"\u6700\u540e\u56de\u573a"}),o.default.createElement(v.default,{allowClear:!0,placeholder:"\u8bf7\u9009\u62e9",mode:"multiple",style:{width:"100%"},onChange:(e,t)=>this.handleQuerySelectChange("LATEST_RETURN_DATE",e)},Object.keys(this.getLayout().dictMap["LATEST_RETURN_SHOP_SPAN"]).map(e=>o.default.createElement(R,{key:e,value:e},this.getLayout().dictMap["LATEST_RETURN_SHOP_SPAN"][e])))),o.default.createElement(I,(0,f.default)({},L,{style:{paddingBottom:0},label:"\u67e5\u770b"}),o.default.createElement(T,{onChange:e=>this.handleQuerySelectChange("LOC_TYPE",e.target.value),defaultValue:"0"},Object.keys(this.getLayout().dictMap["LOC_TYPE"]).map(e=>o.default.createElement(p.default,{key:e,value:e},this.getLayout().dictMap["LOC_TYPE"][e]))))),o.default.createElement(d.default,null,o.default.createElement(u.default,{style:{textAlign:"center"}},o.default.createElement(c.default,{type:"primary",loading:this.props.loading,onClick:e=>this.queryMember(e)},"\u67e5\u770b\u5206\u5e03"))))),o.default.createElement(k,{style:{overflow:"auto",height:"84vh"}},o.default.createElement("div",{style:{padding:20,fontSize:14,color:"#ffffff",textAlign:"center",position:"absolute",width:200,height:90,right:10,top:40,backgroundColor:"#ff8c00",opacity:.6,zIndex:1e3}},"\u95e8\u5e97\u670d\u52a1\u534a\u5f84(km)",o.default.createElement(s.default,{defaultValue:30,tooltipVisible:!0,marks:e,max:20,min:0,step:1,defaultValue:5,value:this.state.radius,onChange:e=>this.radiusChange(e)})),o.default.createElement(S.Map,{width:"100%",height:"84vh",onRef:e=>this.setState({map:e})})))))}})||y);t.default=O},"+p4c":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=f,t.logic=h,t.handleOk=m,t.handleCancel=p;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr"));a("2qtc");var s=i(a("kLXV"));a("+L6B");var n=i(a("2/Rp")),d=i(a("MVZn"));a("Pwec");var u=i(a("CtXQ")),c=l(a("uYVn"));function f(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(u.default,{type:this.action.icon}),this.action.label," "))}function h(e,t,l,i,u){this.view=e,this.record=l,this.recordIndex=i,this.event=u;var c={function:"members",view:"detail"},f={openerActionId:"showVehicleLocation",openerFunction:"",openerView:"",oldData:{},newData:{}},h=null;h=a("i307").default;var m=e=>{if(this.innerLayout=e,l){var t=this.view.state.dialogs,a=e.columns.filter(e=>e.visible),i=a.length<5?"25vw":"42vw",u=[],m='GPS\u8bbe\u5907\u4f4d\u7f6e:<br>{GPS_TIME}<br>{ADDRESS}(<a href=\'javascript:{window.copy("{ADDRESS}");window.message.info("\u590d\u5236\u6210\u529f")}\'>\u590d\u5236</a>)',p=(0,d.default)({},this.record);p.ADDRESS&&(p.ADDRESS=p.ADDRESS.split(";")[0].split("\u3001").join("")),Object.keys(p).map(e=>{m=m.split("{"+e+"}").join(p[e])});var v=[{id:"device_location",name:"GPS\u4f4d\u7f6e",lat:p.LAT2,lng:p.LNG2,icon:null,infoContent:m,buttonOpts:{offset:{x:20,y:60}}}];u.push(o.default.createElement(n.default,{key:"back",onClick:e=>this.handleCancel(e)},"\u5173\u95ed")),t[this.id]=o.default.createElement(s.default,{width:i,key:this.id,title:e.title,visible:!0,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4fdd\u5b58",onOk:e=>this.handleOk(e),footer:u},o.default.createElement(h,{selectedData:this.record,innerLayout:e,innerFwCoord:c,fwParam:f,showAsDialog:!0,dataManaged:!0,initData:l,points:v,onRef:e=>this.onRef(e)})),this.view.setState({dialogs:t})}else r.default.error("\u52a0\u8f7d\u6570\u636e\u9519\u8bef",10)};this.innerLayout?m(this.innerLayout):this.view.props.loadLayout({fwCoord:c,fwParam:f,callback:m})}function m(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{var i=this.dialog.state.formData,o=this.dialog.state.fwParam.newData;Object.keys(i).map(e=>o[e]=i[e].value);var s=(0,d.default)({},this.dialog.state.fwParam,{newData:o});this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:s,callback:a=>{if(a.success)c.isEmpty(a.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}c.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}})}})}function p(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},"0TFb":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=f,t.logic=h,t.handleOk=m,t.handleCancel=p;var o=i(a("q1tI"));a("2qtc");var r=i(a("kLXV"));a("+L6B");var s=i(a("2/Rp")),n=i(a("MVZn"));a("miYZ");var d=i(a("tsqr"));a("Pwec");var u=i(a("CtXQ")),c=l(a("uYVn"));function f(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(u.default,{type:this.action.icon}),this.action.label," "))}function h(e,t,l,i,u){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=u,null==l&&this.view.state.selectedRowKeys&&this.view.state.selectedRowKeys.length>0){var c=this.view.state.selectedRowKeys[0];this.record=this.view.state.data[c],this.recordIndex=c}if(this.record||null!=this.action.argument&&void 0!=this.action.argument.needSelectData&&null!=this.action.argument.needSelectData&&"1"!=this.action.argument.needSelectData){var f=(0,n.default)({},this.view.getFwCoord(),{view:"detail"});this.action.argument&&(this.action.argument.function&&(f["function"]=this.action.argument.function),this.action.argument.view&&(f["view"]=this.action.argument.view));var h={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{}},m=null;if(console.info("this.action",this.action),this.action.argument&&this.action.argument.antdPath){var p=this.action.argument.antdPath;m=a("RO01")(`./${p}`).default}else m=a("E6qp").default;var v=e=>{this.innerLayout||(this.innerLayout={}),this.innerLayout[t]=e,this.view.props.getEditData({fwCoord:f,fwParam:(0,n.default)({},h,{selectedData:this.record}),callback:t=>{if(t){var a=this.view.state.dialogs,l=(e.columns.filter(e=>e.visible),"50vw"),i=[];i.push(o.default.createElement(s.default,{key:"back",onClick:e=>this.handleCancel(e)},"\u5173\u95ed")),this.action.argument&&this.action.argument.showActions&&this.action.argument.showActions.split(",").map(e=>{var a=this.view.getLayout().actionArgs[e];a&&this.view.getActionEntry(a.click).isValid(this.view,e,t)&&i.push(o.default.createElement(s.default,{key:e,onClick:a=>this.view.handleAction((0,n.default)({},a,{fwSourceAction:this}),e,t)},a.label))}),a[this.id]=o.default.createElement(r.default,{width:l,key:this.id,title:e.title,visible:!0,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4fdd\u5b58",onOk:e=>this.handleOk(e),footer:i},o.default.createElement(m,{selectedData:this.record,innerLayout:e,innerFwCoord:f,fwParam:h,showAsDialog:!0,dataManaged:!0,initData:t,onRef:e=>this.onRef(e)})),this.view.setState({dialogs:a})}else d.default.error("\u52a0\u8f7d\u6570\u636e\u9519\u8bef",10)}})};this.innerLayout&&this.innerLayout[t]?v(this.innerLayout[t]):this.view.props.loadLayout({fwCoord:f,fwParam:h,callback:v})}else d.default.error("\u8bf7\u9009\u62e9\u8981\u67e5\u770b\u7684\u6570\u636e",5)}function m(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{var i=this.dialog.state.formData,o=this.dialog.state.fwParam.newData;Object.keys(i).map(e=>o[e]=i[e].value);var r=(0,n.default)({},this.dialog.state.fwParam,{newData:o});this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:r,callback:a=>{if(a.success)c.isEmpty(a.errorMsg)?d.default.success("\u4fdd\u5b58\u6210\u529f"):d.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}c.isEmpty(a.errorMsg)||d.default.error(a.errorMsg,10)}}})}})}function p(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},"1jeA":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("g9YV");var r=i(a("wCAj"));a("14J3");var s=i(a("BMrR"));a("jCWc");var n=i(a("kPKH"));a("+L6B");var d=i(a("2/Rp"));a("qVdP");var u=i(a("jsC+"));a("lUTK");var c=i(a("BvKs"));a("Pwec");var f=i(a("CtXQ"));a("5NDa");var h=i(a("5rEg")),m=i(a("MVZn"));a("sRBo");var p,v,g=i(a("kaz8")),w=a("MuoO"),y=(i(a("usdK")),i(a("wVw7"))),C=l(a("dNXO")),D=g.default.Group,E="1",b="0";function S(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout,o=e.grid,r=o.data,s=o.fwPage;return{loading:e.loading.models.grid||e.loading.models.fw,dispatch:a,fwCoord:l,layout:i,fwPage:s,data:r}}var L=e=>{return{getSelectData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getSelectData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},saveSelectData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/saveSelectData",payload:{fwCoord:a,fwParam:l,callback:i}})},deleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/deleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},getGridData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getGridData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},loadLayout:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,fwParam:l,callback:i}})}}},P=(p=(0,w.connect)(S,L),p(v=class extends o.Component{isResourceChecked(e){return void 0!=e.HAVE_PRIVILEGE?e.HAVE_PRIVILEGE:null}constructor(e){super(e),this.getSelectData=(e=>{var t=e.fwPage,a=e.fwParam,l=e.fwCoord,i=(0,m.default)({},this.state.fwParam,a);this.props.getSelectData({fwPage:(0,m.default)({},this.state.fwPage,t),fwParam:i,fwCoord:(0,m.default)({},this.getFwCoord(),l),callback:e=>{this.setState({fwPage:e.page,data:e.data})}})}),this.getGridData=(e=>{var t=e.fwPage,a=e.fwParam,l=e.fwCoord,i=(0,m.default)({},this.state.fwParam,a);this.props.getGridData({fwPage:(0,m.default)({},this.state.fwPage,t),fwParam:i,fwCoord:(0,m.default)({},this.getFwCoord(),l),callback:e=>{this.setState({fwPage:e.page,data:e.data})}})}),this.pageChangeHandler=function(e,t){this.getGridData({fwPage:{pageNumber:e,pageSize:t}})},this.OP_COL={title:"Operation",dataIndex:"_FW_ACTIONS",render:(e,t,a)=>o.default.createElement("span",{className:y.default.operation},(this.getLayout().otherActions["inList"]?this.getLayout().otherActions["inList"]:[]).filter(e=>1==e.visible).map((e,l)=>{return e.fw_index=l,this.getActionEntry(e.click).layout(this,e.id,t,a)}))},this.COLS=[{title:"\u529f\u80fd\u6743\u9650",dataIndex:"RES_NAME"}],this.getDataLevel=(e=>{return void 0!=e.DATA_LEVEL_MAP?e.DATA_LEVEL_MAP:[]}),this.setPrivilege=((e,t)=>{var a=t.HAVE_PRIVILEGE,l=t.DATA_LEVEL;void 0!=a&&(e.HAVE_PRIVILEGE=a),void 0!=l&&(e.DATA_LEVEL_MAP=l),this.state.changedResource[e.PKEY]=e}),this.onRowCheckedChange=function(e,t,a,l,i,o){var r=a?E:b;if(this.setPrivilege(t,{HAVE_PRIVILEGE:r}),t.nodes&&t.nodes.map(e=>this.onRowCheckedChange(t,e,a,null,i,o+1)),this.state.expandedFunctions[t.PKEY]){t.columnList&&t.columnList.map(e=>this.setPrivilege(e,{HAVE_PRIVILEGE:r})),t.actionList&&t.actionList.map(e=>this.setPrivilege(e,{HAVE_PRIVILEGE:r}));var s=this.getDataLevel(t);if(s)Object.keys(s).map(e=>s[e]=r);else{var n=this.buildDataLevelOptions(t);s={},n.map(e=>s[e.value]=r),this.setPrivilege(t,{DATA_LEVEL:s})}}this.setState({layout:this.state.layout})},this.onExpandFunction=function(e,t,a){if(e)if(this.state.expandedFunctions[t.PKEY]&&!a);else{var l={selectedData:(0,m.default)({},t)},i=a||this.getLayout();l.selectedData[i.ROLE_ID_KEY]=i[i.ROLE_ID_KEY],this.props.loadLayout({fwCoord:this.getFwCoord(),fwParam:l,callback:e=>{e.actionList&&e.actionList.map(e=>{null==this.isResourceChecked(e)&&this.isResourceChecked(t)==E&&this.setPrivilege(e,{HAVE_PRIVILEGE:E})}),e.columnList&&e.columnList.map(e=>{null==this.isResourceChecked(e)&&this.isResourceChecked(t)==E&&this.setPrivilege(e,{HAVE_PRIVILEGE:E})}),t.actionList=e.actionList,t.columnList=e.columnList,this.state.expandedFunctions[t.PKEY]=t,this.setState({layout:this.getLayout(),expandedFunctions:this.state.expandedFunctions})}})}},this.onCheckGroupChange=((e,t)=>{console.info("onCheckGroupChange",e,t),e.map(e=>this.setPrivilege(e,{HAVE_PRIVILEGE:t.indexOf(e.PKEY)>=0?E:b})),this.setState({layout:this.state.layout})}),this.onCheckAllChange=((e,t,a)=>{var l=a.target.checked;t.map(e=>this.setPrivilege(e,{HAVE_PRIVILEGE:l?E:b})),this.setState({layout:this.state.layout})}),this.onDataLevelCheckGroupChange=((e,t)=>{var a=this.getDataLevel(e);a||(a={},this.setPrivilege(e,{DATA_LEVEL:a})),t.map(e=>a[e]=E),Object.keys(a).map(e=>t.some(t=>t==e)?null:a[e]=b),this.setPrivilege(e,{DATA_LEVEL:a}),this.setState({layout:this.getLayout()})}),this.onDataLevelCheckAllChange=((e,t,a)=>{var l=a.target.checked;l?this.onDataLevelCheckGroupChange(e,t.map(e=>e.value)):this.onDataLevelCheckGroupChange(e,[])}),this.buildDataLevelOptions=(e=>{var t=[];if(e.HAVE_CUST_COL==E||e.HAVE_DEPT_COL==E||e.HAVE_OWNER_COL==E){var a=this.getLayout().dictMap.DATA_LEVEL;t.push({label:a[0],value:"0"}),e.HAVE_CUST_COL==E&&Object.keys(a).filter(e=>e>0&&e<9).map(e=>t.push({value:e,label:a[e]})),e.HAVE_DEPT_COL==E&&Object.keys(a).filter(e=>e>10&&e<19).map(e=>t.push({value:e,label:a[e]})),e.HAVE_OWNER_COL==E&&Object.keys(a).filter(e=>e>20&&e<29).map(e=>t.push({value:e,label:a[e]}))}return t}),this.buildFunctionSubPanels=(e=>{var t=e.actionList?e.actionList.map(e=>({label:e.RES_NAME,value:e.PKEY})):[],a=e.columnList?e.columnList.map(e=>({label:e.RES_NAME,value:e.PKEY})):[],l=this.buildDataLevelOptions(e),i=null;t.length>0&&(i=o.default.createElement("div",null,o.default.createElement("div",{style:{borderBottom:"1px solid #E9E9E9"}},o.default.createElement(g.default,{indeterminate:e.actionList.some(e=>this.isResourceChecked(e)==E)&&e.actionList.some(e=>this.isResourceChecked(e)!=E),onChange:t=>this.onCheckAllChange(e,e.actionList,t),checked:e.actionList.every(e=>this.isResourceChecked(e)==E)},o.default.createElement("b",null,"\u64cd\u4f5c"))),o.default.createElement(D,{options:t,defaultValue:e.actionList.filter(e=>this.isResourceChecked(e)==E).map(e=>e.PKEY),value:e.actionList.filter(e=>this.isResourceChecked(e)==E).map(e=>e.PKEY),onChange:t=>this.onCheckGroupChange(e.actionList,t)}),o.default.createElement("br",null),o.default.createElement("br",null)));var r=null;a.length>0&&(r=o.default.createElement("div",null,o.default.createElement("div",{style:{borderBottom:"1px solid #E9E9E9"}},o.default.createElement(g.default,{indeterminate:e.columnList.some(e=>this.isResourceChecked(e)==E)&&e.columnList.some(e=>this.isResourceChecked(e)!=E),onChange:t=>this.onCheckAllChange(e,e.columnList,t),checked:e.columnList.every(e=>this.isResourceChecked(e)==E)},o.default.createElement("b",null,"\u5217"))),o.default.createElement(D,{options:a,defaultValue:e.columnList.filter(e=>this.isResourceChecked(e)==E).map(e=>e.PKEY),value:e.columnList.filter(e=>this.isResourceChecked(e)==E).map(e=>e.PKEY),onChange:t=>this.onCheckGroupChange(e.columnList,t)}),o.default.createElement("br",null),o.default.createElement("br",null)));var s=null;if(l.length>0){var n=this.getDataLevel(e),d=this.isResourceChecked(e);null==n&&(n={},l.map(e=>n[e.value]=d),this.setPrivilege(e,{DATA_LEVEL:n})),s=o.default.createElement("div",null,o.default.createElement("div",{style:{borderBottom:"1px solid #E9E9E9"}},o.default.createElement(g.default,{indeterminate:l.some(e=>n[e.value]==E)&&l.some(e=>n[e.value]!=E),onChange:t=>this.onDataLevelCheckAllChange(e,l,t),checked:l.every(e=>n[e.value]==E)},o.default.createElement("b",null,"\u6570\u636e\u6743\u9650"))),o.default.createElement(D,{options:l,defaultValue:Object.keys(n).filter(e=>n[e]==E),value:Object.keys(n).filter(e=>n[e]==E),onChange:t=>this.onDataLevelCheckGroupChange(e,t)}),o.default.createElement("br",null),o.default.createElement("br",null))}return i||r||s?o.default.createElement("div",null,i,r,s):o.default.createElement("div",null,"\u65e0\u6570\u636e")}),this.getLayout=(()=>{return this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,m.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return C.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.state=(0,m.default)({},e,{fwParam:(0,m.default)({},e.fwParam),buttonSize:e.buttonSize?e.buttonSize:"default",tableSize:e.tableSize?e.tableSize:"small",showSelectCol:!!e.showSelectCol&&e.showSelectCol,queryPanelExpanded:!1,expandedAllGroup:!0,dialogs:{},actionInList:[],changedResource:{},expandedFunctions:{}})}componentWillReceiveProps(e){e.innerLayout[e.innerLayout.ROLE_ID_KEY]!=this.getLayout()[this.getLayout().ROLE_ID_KEY]&&(console.info("nextProps",e),e.innerLayout.gotResource.map(e=>{this.state.expandedFunctions[e.PKEY]&&(this.state.expandedFunctions[e.PKEY]=e),e.nodes&&e.nodes.map(e=>{this.state.expandedFunctions[e.PKEY]&&(this.state.expandedFunctions[e.PKEY]=e)})}),Object.values(this.state.expandedFunctions).map(t=>this.onExpandFunction(!0,t,e.innerLayout)),this.setState({changedResource:{},expandedAllGroup:!0}))}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.getLayout().onQuery&&this.getActionEntry(this.getLayout().onQuery).logic(this,this.getLayout().onQuery,null,-1,null)}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.getLayout().actions.map(e=>{var t=[];if("searchGrp"!==e.id&&"gridSearchGrp"!==e.id&&"searchList"!==e.id||t.push(o.default.createElement(h.default,{key:e.id,size:this.state.buttonSize,className:y.default.queryValue,defaultValue:this.state.fwParam.queryValue,onPressEnter:e=>this.handleAction(e,"searchList"),onChange:e=>this.setState({fwParam:(0,m.default)({},this.state.fwParam,{queryValue:e.target.value})})})),"group"==e.tag){var a=e.children.filter(e=>e.visible);if(a.length>1){var l=o.default.createElement(c.default,{onClick:e=>this.handleAction(e)},a.filter((t,a)=>!e.showDefault||a>0).map(e=>o.default.createElement(c.default.Item,{key:e.id},o.default.createElement(f.default,{type:e.icon}),e.label)));return e.showDefault?o.default.createElement("span",{key:e.id},t,o.default.createElement(u.default.Button,{key:e.id,size:this.state.buttonSize,onClick:t=>this.handleAction(t,e.children[0].id),overlay:l},o.default.createElement(f.default,{type:e.children[0].icon}),e.children[0].label)):o.default.createElement("span",{key:e.id},t,o.default.createElement(u.default,{overlay:l},o.default.createElement(d.default,{style:{marginLeft:8},size:this.state.buttonSize},o.default.createElement(f.default,{type:e.icon}),e.label," ",o.default.createElement(f.default,{type:"down"}))))}if(1==a.length)return o.default.createElement("span",{key:a[0].id},t,o.default.createElement(d.default,{key:a[0].id,style:{marginLeft:8},size:this.state.buttonSize,onClick:e=>this.handleAction(e,a[0].id)},o.default.createElement(f.default,{type:a[0].icon}),a[0].label))}else if(e.visible)return o.default.createElement("span",{key:e.id},t,o.default.createElement(d.default,{key:e.id,type:"primary",style:{marginLeft:8},size:this.state.buttonSize,onClick:t=>this.handleAction(t,e.id)},o.default.createElement(f.default,{type:e.icon}),e.label))}),t=[];return this.getLayout().argument&&this.getLayout().argument.queryFields&&t.push(o.default.createElement(n.default,{key:"expanded",span:24,style:{textAlign:"right"}},o.default.createElement("a",{style:{marginLeft:8,fontSize:12},onClick:e=>this.setState({queryPanelExpanded:!this.state.queryPanelExpanded})},this.state.queryPanelExpanded?"\u5173\u95ed":"\u5c55\u5f00"," ",o.default.createElement(f.default,{type:this.state.queryPanelExpanded?"up":"down"})))),o.default.createElement("div",{className:y.default.normal},o.default.createElement("div",{style:{width:"95%",margin:"10px"}},o.default.createElement(s.default,null,t),o.default.createElement(s.default,null,o.default.createElement(n.default,{span:24,style:{textAlign:"right"}},e))),o.default.createElement("div",{className:"search-result-list",style:{width:"95%",margin:"10px"}},o.default.createElement(r.default,{loading:this.props.loading,columns:this.COLS,dataSource:this.getLayout().gotResource,pagination:!1,rowKey:"PKEY",size:this.state.tableSize,bordered:!0,defaultExpandAllRows:this.state.expandedAllGroup,childrenColumnName:"_EMPTY",rowSelection:{type:"checkbox",selectedRowKeys:this.getLayout().gotResource?this.getLayout().gotResource.filter(e=>this.isResourceChecked(e)==E||e.nodes&&e.nodes.some(e=>this.isResourceChecked(e)==E)).map(e=>e.PKEY):[],onSelect:(e,t,a,l)=>this.onRowCheckedChange(null,e,t,a,l,1),onSelectAll:(e,t,a)=>console.info("onselectAll",e),getCheckboxProps:e=>({indeterminate:!!e.nodes&&e.nodes.some(e=>this.isResourceChecked(e)==E)&&e.nodes.some(e=>this.isResourceChecked(e)!=E)})},expandedRowRender:e=>o.default.createElement(r.default,{style:{margin:0},rowSelection:{type:"checkbox",selectedRowKeys:e.nodes?e.nodes.filter(e=>this.isResourceChecked(e)==E).map(e=>e.PKEY):[],onSelect:(t,a,l,i)=>this.onRowCheckedChange(e,t,a,l,i,2)},columns:this.COLS,dataSource:e.nodes,pagination:!1,rowKey:"PKEY",size:"small",showHeader:!1,childrenColumnName:"_EMPTY",onExpand:(e,t)=>this.onExpandFunction(e,t),expandedRowRender:e=>o.default.createElement("div",{style:{margin:10}},this.buildFunctionSubPanels(e))})})),Object.values(this.state.dialogs))}})||v);t.default=P},"3ICH":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("14J3");var r=i(a("BMrR"));a("jCWc");var s=i(a("kPKH"));a("5Dmo");var n=i(a("3S7+")),d=i(a("2mBW"));a("miYZ");var u=i(a("tsqr"));a("giR+");var c=i(a("fyUT"));a("Xi6J");var f=i(a("kl6h"));a("iQDF");var h=i(a("+eQT"));a("O3gP");var m=i(a("lrIw"));a("6UJt");var p=i(a("DFOY"));a("nRaC");var v=i(a("5RzL"));a("T2oS");var g=i(a("W9HT")),w=i(a("pVnL")),y=i(a("MVZn"));a("sRBo");var C=i(a("kaz8"));a("7Kak");var D=i(a("9yH6"));a("OaEy");var E=i(a("2fM7"));a("5NDa");var b=i(a("5rEg"));a("y8nQ");var S=i(a("Vl3Y"));a("ozfa");var L=i(a("MJZm"));a("B9cy");var P,k,I=i(a("Ol7k")),R=a("MuoO"),T=(i(a("QCDS")),i(a("YEhg")),l(a("uYVn"))),A=l(a("dNXO")),_=i(a("wd/R"));a("XDpg"),_.default.locale("zh-cn");I.default.Header,I.default.Footer,I.default.Sider,I.default.Content;var O=L.default.TreeNode,M=S.default.Item,F=b.default.TextArea,N=E.default.Option,j=D.default.Group,V=C.default.Group,x={labelCol:{span:6,style:{width:75}},wrapperCol:{span:18}},z={labelCol:{span:10},wrapperCol:{span:14}},Y={labelCol:{span:4},wrapperCol:{span:20}};function G(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.edit,dispatch:a,fwCoord:l,layout:i}}var q=e=>{return{getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})}}},U=(P=(0,R.connect)(G,q),P(k=class extends o.Component{constructor(e){super(e),this.convertToCascadeData=((e,t)=>{return e?e.map(e=>{return e.value=e[t.value],e.label=e[t.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e.children&&(e.children=this.convertToCascadeData(e.children,t)),e}):null}),this.loadCascaderData=((e,t)=>{var a=e[e.length-1];a.loading=!0;var l=t.valueRef;this.getTreeData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:l.function,view:l.view}),fwParam:{distinct:l.distinct?l.distinct:null,queryColumns:l.value+","+l.label+","+(l.otherRefs?l.otherRefs:""),selectedTreeNodeId:e.map(e=>e[l.value]).join(",")},callback:e=>{a.loading=!1,a.children=this.convertToCascadeData(e.data,l),this.setState({refData:this.state.refData})}})}),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,y.default)({},this.state.fwParam,{openerSelectedData:(0,y.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,y.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(O,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+","+(t.valueRef.otherRefs?t.valueRef.otherRefs:""),selectedTreeNodeId:e.props.eventKey},callback:e=>{i.children=e.data,a.defaultOpen=!0,console.info(a.data),l(),this.setState({refData:this.state.refData})}}))})),this.onCascaderChange=((e,t,a)=>{if(console.info("onCascaderChange",e.id,t,a),"ADDRESS_SELECT"==e.id){var l=this.state,i=l.fwParam,o=l.formData,r=l.manualValues;i.newData||(i.newData={}),i.newData[e.id]=t.join(","),o[e.id]||(o[e.id]={}),o[e.id].value=t.join(","),o.LAT&&(o.LAT.value=null),o.LNG&&(o.LNG.value=null),r[e.id]=t,this.setState({fwParam:i,manualValues:r,formData:o})}}),this.onAutoCompleteSelect=((e,t,a)=>{console.info("onAutoCompleteSelect",e.id,t,a)}),this.onSelectChange=((e,t,a)=>{console.info("onSelectChange",e.id,t,a)}),this.onSelectSelect=((e,t,a)=>{console.info("onSelectSelect",e.id,t,a)}),this.MONEY_IDS={BIZ_INS_DUE:150,FORCE_INS_DUE:150,BIZ_INS_DAMEGE:80,BIZ_INS_THIRD:80,BIZ_INS_OTHER:80,FORCE_INS_AMOUNT:80,STEAL_INS_AMOUNT:80,GPS_DEVICE_NO:"78%",ADDRESS_SELECT:"40%",ADDRESS:"50%"},this.getInputComponent=((e,t)=>{var a=this.state,l=a.components,i=a.refData,r=a.fwParam,s=a.formData,n=null,d={disabled:!e.editable,style:{width:this.MONEY_IDS[e.id]?this.MONEY_IDS[e.id]:"90%"}};t&&(d.value=this.state.manualValues[e.id]);var S="",L="";if(e.editable&&(S=e.prompt?e.prompt:"\u8bf7\u8f93\u5165",L=e.prompt?e.prompt:"\u8bf7\u9009\u62e9"),"label"==e.ui)n=this.getDisplayValue(e);else if("MEMO"===e.type)n=o.default.createElement(F,(0,w.default)({},d,{rows:4}));else if("checkbox01"===e.ui)n=o.default.createElement(C.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictList[e.dictionary]){var P=this.getLayout().dictList[e.dictionary];if("radio"==e.ui)n=o.default.createElement(j,(0,w.default)({name:e.id},d),P.map(e=>o.default.createElement(D.default,{key:e.value,value:String(e.value)},e.label)));else if("checkbox"==e.ui){var k=P;n=o.default.createElement(V,(0,w.default)({name:e.id},d,{options:k}))}else n=o.default.createElement(E.default,d,P.map(e=>o.default.createElement(N,{key:e.value,value:e.value},e.label)))}else if("TreeSelect"===e.ui&&e.valueRef){var I=e.valueRef;if(!i[e.id]){var R=null;I.function==this.props.fwParam.openerFunction&&I.view==this.props.fwParam.openerView&&this.props.treeData&&(R=this.props.treeData),i[e.id]={loading:!1,data:R,queryIndex:0,defaultOpen:!1}}var T=i[e.id];T.data||(T.data=[],this.props.getTreeData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:I.function,view:I.view}),fwParam:{distinct:I.distinct?I.distinct:null,queryColumns:I.value+","+I.label+","+(I.otherRefs?I.otherRefs:"")},callback:t=>{t.success?(T.data=t.data,console.info("result.data",T.data),T.loading=!1,i[e.id]=T,this.setState({refData:i})):T.data=null}})),n=o.default.createElement(v.default,(0,w.default)({},d,{placeholder:L,notFoundContent:T.loading?o.default.createElement(g.default,{size:"small"}):null,showArrow:!0,showSearch:!0,searchPlaceholder:"\u8f93\u5165\u641c\u7d22",filterTreeNode:(e,t)=>{return console.info("treeNode",t),t.props.title.indexOf(e)>=0},treeNodeFilterProp:"title",filterOption:!1,loadData:t=>this.onTreeSelectLoadData(t,e,T),treeExpandedKeys:T.expandedKeys?T.expandedKeys:T.data.map(e=>String(e[I.value])),onTreeExpand:e=>{T.expandedKeys=e,T.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:T.defaultOpen,onSearch1:t=>{T.timeout&&(clearTimeout(T.timeout),T.timeout=null),T.currentValue=t;var a=()=>{console.info(t),T.loading=!0,this.props.getRefData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:I.function,view:I.view}),fwParam:{queryStr:t,distinct:I.distinct?I.distinct:null,queryColumns:I.value+","+I.label+","+(I.otherRefs?I.otherRefs:"")},callback:a=>{T.currentValue==t&&(T.data=a.data,T.loading=!1,T.defaultOpen=!0,s[e.id].value=t,this.setState({refData:i,fwParam:r,formData:s}))}})};T.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(T.data,I))}else if("Cascader"==e.ui&&e.valueRef){var A=e.valueRef;if(!i[e.id]){var O={};O[A.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),O[A.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var M=i[e.id];M.data||(M.data=[],this.props.getTreeData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:A.function,view:A.view}),fwParam:{distinct:A.distinct?A.distinct:null,queryColumns:A.value+","+A.label+","+(A.otherRefs?A.otherRefs:""),selectedId:this.state.manualValues[e.id]?this.state.manualValues[e.id].join(","):null},callback:t=>{t.success?(M.data=this.convertToCascadeData(t.data,A),M.loading=!1,i[e.id]=M,this.setState({refData:i})):M.data=null}})),n=o.default.createElement(p.default,(0,w.default)({},d,{placeholder:L,options:M.data,loadData:t=>this.loadCascaderData(t,e),onChange:(t,a)=>this.onCascaderChange(e,t,a),showSearch:{filter:(e,t)=>{return t.some(t=>t.label.toLowerCase().indexOf(e.toLowerCase())>-1)}}}))}else if("AutoComplete"==e.ui&&e.valueRef){var x=e.valueRef;i[e.id]||(i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i}));var z=i[e.id];n=o.default.createElement(m.default,(0,w.default)({},d,{placeholder:S,dataSource:z.data,defaultOpen:z.defaultOpen,onSelect:(t,a)=>this.onAutoCompleteSelect(e,t,a),onSearch:e=>{z.timeout&&(clearTimeout(z.timeout),z.timeout=null),z.currentValue=e;var t=()=>{z.loading=!0,this.props.getRefData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:x.function,view:x.view}),fwParam:(0,y.default)({},this.state.fwParam,{queryValue:e,distinct:x.distinct?x.distinct:null,queryColumns:x.value+","+x.label+","+(x.otherRefs?x.otherRefs:"")}),callback:t=>{if(z.currentValue==e){var a={};t.success&&t.data.map(e=>{a[e[x.label]]=e}),z.dataMap=a,z.data=Object.keys(a),z.loading=!1,z.defaultOpen=!0,z.autoFocus=!0,this.setState({refData:i,fwParam:r})}}})};z.timeout=setTimeout(t,900)}}))}else if(null!=e.valueRef){var Y=e.valueRef;if(!i[e.id]){var G={};G[Y.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),G[Y.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var q=i[e.id];q.data||(q.data=[],this.props.getRefData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:Y.function,view:Y.view}),fwParam:{distinct:Y.distinct?Y.distinct:null,queryColumns:Y.value+","+Y.label+","+(Y.otherRefs?Y.otherRefs:"")},callback:t=>{var a,l=[],o={};(t.success&&(l=t.data,l&&l.map(e=>o[e[Y.value]]=e)),e.showColumn)&&function(){console.info("showColumn",s[e.showColumn],s[e.id]);var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],i=s[e.id]&&s[e.id].value?s[e.id].value.split(","):[],o=null;if(i.length>0&&t.length==i.length)for(a=0;a<i.length;++a)l.some(e=>e[Y.value]==i[a])||(o={},o[Y.value]=i[a],o[Y.label]=t[a],l.push(o))}();q.data=l,q.dataMap=o,q.loading=!1,i[e.id]=q,this.setState({refData:i,formData:s})}}));var U=q.data.map(e=>o.default.createElement(N,{key:e[Y.value]},e[Y.label],Y.otherRefs?Y.otherRefs.split(",").map(t=>{e[t]}):""));n=o.default.createElement(E.default,(0,w.default)({},d,{placeholder:L,showSearch:!0,mode:e.multiSelect?"multiple":null,notFoundContent:q.loading?o.default.createElement(g.default,{size:"small"}):null,showArrow:!0,filterOption:!1,labelInValue:!0,autoFocus:q.autoFocus,defaultOpen:q.defaultOpen,onSelect:(t,a)=>this.onSelectSelect(e,t,a),onChange:(t,a)=>this.onSelectChange(e,t,a),onSearch:t=>{q.timeout&&(clearTimeout(q.timeout),q.timeout=null),q.currentValue=t;var a=()=>{q.loading=!0,this.props.getRefData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:Y.function,view:Y.view}),fwParam:{queryValue:t,distinct:Y.distinct?Y.distinct:null,queryColumns:Y.value+","+Y.label+","+(Y.otherRefs?Y.otherRefs:"")},callback:a=>{if(q.currentValue==t){var l,o=[],r={};if(a.success&&(o=a.data,o&&o.map(e=>r[e[Y.value]]=e)),e.showColumn)(function(){var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],a=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],i=null;if(a.length>0&&t.length==a.length)for(l=0;l<a.length;++l)o.some(e=>e[Y.value]==a[l])||(i={},i[Y.value]=a[l],i[Y.label]=t[l],o.push(i))})();q.data=o,q.dataMap=r,q.loading=!1,q.defaultOpen=!0,q.autoFocus=!0,this.setState({refData:i})}}})};q.timeout=setTimeout(a,500)}}),U)}else if("DatePicker"===e.ui){var B=()=>!1;"today"==e.min?B=(e=>e&&e<(0,_.default)().startOf("day")):"today"==e.max&&(B=(e=>e&&e>(0,_.default)().endOf("day"))),n=o.default.createElement(h.default,(0,w.default)({},d,{disabledDate:e=>B(e),placeholder:L}))}else if("TimePicker"===e.ui)n=o.default.createElement(f.default,d);else if("InputNumber"===e.ui)n=o.default.createElement(c.default,(0,w.default)({},d,{placeholder:S}));else if("Upload"===e.ui){var K=(0,y.default)({},this.getFwCoord(),{view:"create"}),W={openerActionId:e.id,openerFunction:this.getFwCoord()["function"],openerView:this.getFwCoord().view,oldData:{},newData:{},saveType:"checkonly"},H=this.objectToFormInputs({fwCoord:K,fwParam:W},null,null),X={name:e.id+"_importFile",action:"/fw/importData?fwCoord.project="+this.getFwCoord().project+"&",data:H,onChange(t){if(this.view.setState({loading:!0}),t.file.status,"done"===t.file.status){var a=t.file.response;this.view.setState({uploadedFile:t.file.name,uploadResult:null,loading:!1}),a.success?(r.connectFilePath=a.connectFilePath,this.view.setState({fwParam:r}),u.default.info("\u6587\u4ef6\u6821\u9a8c\u901a\u8fc7")):a.connectFilePath?this.view.setState({uploadResult:o.default.createElement("span",{dangerouslySetInnerHTML:{__html:'<font color="#ff0000"><a href="/fw/download?fileName='+a.connectFilePath+'" target="_blank">\u4e0a\u4f20\u6587\u4ef6\u6709\u8bef\uff0c\u70b9\u6b64\u4e0b\u8f7d\u660e\u7ec6</a></font>'}})}):a.errorMsg&&u.default.error(a.errorMsg,10)}else"error"===t.file.status&&(this.view.setState({loading:!1}),u.default.error(`${e.label}\u5bfc\u5165\u9519\u8bef`,10))}};X.view=this,n=o.default.createElement(Upload,(0,w.default)({},d,X,{showUploadList:!1,style:{marginLeft:10}}),o.default.createElement("a",{href:"javascript:;"},this.state.uploadedFile?this.state.uploadedFile:"\u70b9\u6b64\u4e0a\u4f20"))}else"MAP"==e.ui?(console.info("col.ui",e.ui),n=o.default.createElement(b.default,(0,w.default)({},d,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn;return n||(n=o.default.createElement(b.default,(0,w.default)({},d,{type:e.ui?e.ui:"text",placeholder:S}))),l[e.id]=n,n}),this.normFile=(e=>{return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.file&&e.file.response?e.file.response.success?e&&e.fileList:null:e&&e.fileList}),this.objectToFormInputs=function(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>this.objectToFormInputs(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]).replace(/%/g,"%25").replace(/\&/g,"%26").replace(/\+/g,"%2B").replace(/\=/g,"%3D"):this.objectToFormInputs(e[o],i,l)}return i},this.handleFormChange=(e=>{if(e){var t=this.state,a=t.fwParam,l=t.formData;a.newData||(a.newData={}),Object.keys(e).map(t=>{var i=e[t],o=this.getLayout().columnMap[t],r=o.ui,s=null;if(i&&null!=i.value)if(this.state.formData[t]||(this.state.formData[t]={}),s=i.value,"DatePicker"===r)s=i.value.format(o.pattern?o.pattern:"YYYY-MM-DD");else if("TimePicker"===r)s=i.value.format(o.pattern?o.pattern:"HH:mm:ss");else if("checkbox01"===r)s=i.value?"1":"0";else if(o.dictionary)"checkbox"==o.ui&&Array.isArray(i.value)&&(s=i.value.join(","));else if("Cascader"==o.ui)Array.isArray(i.value)&&(s=i.value.join(","),console.info("Cascader",i.value,s));else if("AutoComplete"==o.ui){if(s=i.value,"ADDRESS"==o.id){s.length>50&&(s=s.substr(0,50));var n=this.state,u=n.manualValues,c=n.refData,f=c[o.id];if(f&&f.dataMap){var h=f.dataMap[s];if(console.info("colRefData",h),h){a.newData["LAT"]=h.lat,a.newData["LNG"]=h.lng,l.LAT&&(l.LAT.value=h.lat),l.LNG&&(l.LNG.value=h.lng);var m=[h.province,h.city,h.district],p=c["ADDRESS_SELECT"];p||((0,d.default)("addressSelectRefData"),p={},c["ADDRESS_SELECT"]=p),p.data||(p.data=[]);var v=p.data.filter(e=>e.value==h.province);if(console.info("provinceNode",v),v&&v.length>0){var g=v[0].children;g||(g=[],v[0].children=g);var w=g.filter(e=>e.value==h.city);if(console.info("cityNode",w),w&&w.length>0){var y=w[0].children;y||(y=[],w[0].children=y);var C=y.filter(e=>e.value==h.district);console.info("districtNode",C),C&&C.length>0||y.push({value:h.district,label:h.district,isLeaf:!0})}else g.push({value:h.city,label:h.city,isLeaf:!1,children:[{value:h.district,label:h.district,isLeaf:!0}]})}else p.data.push({value:h.province,label:h.province,isLeaf:!1,children:[{value:h.city,label:h.city,isLeaf:!1,children:[{value:h.district,label:h.district,isLeaf:!0}]}]});u["ADDRESS_SELECT"]=m,console.info("set manual address",u["ADDRESS_SELECT"]),a.newData["ADDRESS_SELECT"]=m.join(","),l["ADDRESS_SELECT"]||(l["ADDRESS_SELECT"]={}),l["ADDRESS_SELECT"].value=m.join(","),s=h.name}else console.info(o.id,"inputed",a.newData["LAT"],a.newData["LNG"],s,i.value),l.LAT&&(l.LAT.value=null),l.LNG&&(l.LNG.value=null);this.setState({manualValues:u,refData:c})}else console.info("clear"),l.LAT&&(l.LAT.value=null),l.LNG&&(l.LNG.value=null)}}else if(o.valueRef&&"TreeSelect"!=o.ui){if(s=Array.isArray(i.value)?i.value.filter(e=>e&&e.key).map(e=>e.key).join(","):i.value.key?i.value.key:null,o.showColumn){var D=this.getLayout().columnMap[o.showColumn.split(",")[0]];if(D){var E=i.value.map(e=>Array.isArray(e.label)?e.label[0]:e.label).join(",");this.state.formData[D.id]||(this.state.formData[D.id]={}),this.state.formData[D.id].value=E}}}else"Upload"===o.ui?(console.info("upload",s),Array.isArray(s)&&(s=s[0].name)):"MAP"==o.ui?(s=this.state.formData[t].value,i.dirty=!0):("string"==typeof s&&(s=s.trim(!0),o.size>0&&s.length>o.size&&(s=s.substr(0,o.size))),"NUM"==o.type&&("number"!==typeof s&&(s=new String(s).split("").filter(e=>!T.isEmpty(e)).filter((e,t,a)=>0==t&&"-"==e||"."==e&&a.filter((e,a)=>a<t).every(e=>"."!=e)||T.isNumber(e)).join("")),void 0!=o.min&&null!=o.min&&(null==s||s<o.min)&&(s=o.min),void 0!=o.max&&null!=o.max?s>o.max&&(s=o.max):o.size&&s>Math.pow(10,o.size)-1&&(s=Math.pow(10,o.size)-1)));if("GPS_DEVICE_NO"==o.id)console.info(o.id,i.value,s);else if("PRICE"==o.id){var b=parseInt(s);b>6e5&&(l["STEAL_INS"]&&(l["STEAL_INS"].value="0",a.newData["STEAL_INS"]="0"),l["STEAL_INS_AMOUNT"]&&(l["STEAL_INS_AMOUNT"]=0,a.newData["STEAL_INS_AMOUNT"]=0),l["FIRST_BENEFIT"]&&(l["FIRST_BENEFIT"]="",a.newData["FIRST_BENEFIT"]=""))}else"VIN"==o.id&&s&&(s=s.toUpperCase());i.value=s}),this.setState({formData:(0,y.default)({},this.state.formData,e),fwParam:a})}}),this.doOtherInputValidate=(()=>{var e=this.state,t=e.formData,a=e.fwParam;if(t["BIZ_INS"]&&"1"==t["BIZ_INS"].value&&(!t["BIZ_INS_DAMEGE"]||!t["BIZ_INS_DAMEGE"].value)&&(!t["BIZ_INS_THIRD"]||!t["BIZ_INS_THIRD"].value)&&(!t["BIZ_INS_OTHER"]||!t["BIZ_INS_OTHER"].value))return"\u8bf7\u8f93\u5165\u5546\u4e1a\u9669\u6295\u4fdd\u91d1\u989d";if(!t.LAT||!t.LAT.value||!t.LNG||!t.LNG.value){if(a.newData.ADDRESS_SELECT!=a.oldData.ADDRESS_SELECT||t.ADDRESS.value!=a.oldData.ADDRESS)return"\u8bf7\u9009\u62e9\u4f1a\u5458\u5730\u5740";t.LAT.value=a.oldData.LAT,t.LNG.value=a.oldData.LNG}}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],r=i;if(e.onFormat)r=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var s=this.getLayout().dictMap[e.dictionary][i];r=s||i}else e.showColumn&&(r=e.showColumn.split(",").map(e=>t[e]).join(" "));return o.default.createElement("span",null,r)}),this.showDeviceOnMap=(()=>{var e=this.state,t=e.formData,a=e.refData;if(t["GPS_DEVICE_NO"]&&t["GPS_DEVICE_NO"].value){var l=a["GPS_DEVICE_NO"];if(l&&l.dataMap){var i=t["GPS_DEVICE_NO"].value,o=l.dataMap[i];if(o)if(o.LAT2&&o.LNG2){console.info("deviceData",o);var r=this.getActionEntry("showMapWithoutQuery");console.info(r),this.getActionEntry("showMapWithoutQuery").logic(this,"showPosition",o,0,null)}else u.default.info("\u8bbe\u5907\u672a\u5b9a\u4f4d");else u.default.info("\u8bf7\u8f93\u5165\u6b63\u786e\u8bbe\u5907\u53f7!")}else u.default.info("\u8bf7\u8f93\u5165\u6b63\u786e\u8bbe\u5907\u53f7.")}else u.default.info("\u8bf7\u8f93\u5165\u6b63\u786e\u8bbe\u5907\u53f7")}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,y.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return A.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.FIX_WIDTH={ADDRESS:24},this.CustomizedForm=S.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t={};return this.getLayout().columns.filter(e=>e.visible).map(e=>{var a=(0,y.default)({},this.state.formData[e.id]);if(a&&null!=a.value)if("DatePicker"===e.ui)a.value=a.value?(0,_.default)(a.value,e.pattern?e.pattern:"YYYY-MM-DD"):a.value;else if("TimePicker"===e.ui)a.value=a.value?(0,_.default)(a.value,e.pattern?e.pattern:"HH:mm:ss"):a.value;else if("checkbox01"===e.ui)a.value="1"==a.value;else if(e.dictionary)"checkbox"==e.ui?Array.isArray(a.value)||(a.value=String(a.value).split(",")):a.value=String(a.value);else if("Cascader"==e.ui)a.value=String(a.value).split(",");else if("AutoComplete"==e.ui);else if(e.valueRef&&"TreeSelect"!=e.ui){if(Array.isArray(a.value)||(a.value?a.value=String(a.value).split(",").map(e=>({key:e})):a.value=[]),Array.isArray(a.value)&&e.showColumn){var l=this.state.formData[e.showColumn.split(",")[0]];l&&l.value&&l.value.split(",").map((e,t)=>a.value.length>t?a.value[t].label=e:null)}}else"MAP"==e.ui||("NUM"!=e.type||e.dictionary?a.value=String(a.value):(""==a.value&&(a.value=null),a.value));e.valueRef&&"TreeSelect"!=e.ui&&null==a.value&&delete a.value,t[e.id]=S.default.createFormField((0,y.default)({},a))}),t},onValuesChange(e,t){}})(e=>{this.state.form=e.form;var t=e.form.getFieldDecorator,a=this.getLayout().columns.filter(e=>e.visible),l={_default:[]},i={};this.getLayout().columnGroups&&this.getLayout().columnGroups.map(e=>i[e.id]=e),a.map(e=>{var t="_default";e.group&&i[e.group]&&(t=e.group),l[t]||(l[t]=[]),l[t].push(e)});var d=(e,l)=>e?e.map((e,i)=>{var r=[],d=this.state.formData;["CURRENT_MILE","NEXT_MAINTAIN_MILE","NEXT_MAINTAIN_DATE"].some(t=>t==e.id)?(e.editable=!d["MEMBER_SOURCE"]||"1"!=d["MEMBER_SOURCE"].value,e.tooltip=e.editable?null:"\u4f1a\u5458\u6765\u6e90\u662f\u81ea\u5e97\u8d2d\u8f66\u65f6\u4e0d\u9700\u8981\u8f93\u5165"):["BIZ_INS_DAMEGE","BIZ_INS_THIRD","BIZ_INS_OTHER"].some(t=>t==e.id)?(e.editable=d["BIZ_INS"]&&"1"==d["BIZ_INS"].value,e.tooltip=e.editable?null:"\u6f5c\u5ba2\u767b\u8bb0\u65f6\u4e0d\u9700\u8981\u8f93\u5165"):["FORCE_INS_AMOUNT"].some(t=>t==e.id)?(e.editable=d["FORCE_INS"]&&"1"==d["FORCE_INS"].value,e.tooltip=e.editable?null:"\u6f5c\u5ba2\u767b\u8bb0\u65f6\u4e0d\u9700\u8981\u8f93\u5165"):["STEAL_INS_AMOUNT","FIRST_BENEFIT"].some(t=>t==e.id)?(e.editable=d["STEAL_INS"]&&"1"==d["STEAL_INS"].value&&(!d["PRICE"]||!d["PRICE"].value||d["PRICE"].value<=6e5),e.tooltip=e.editable?null:"\u4e0d\u6295\u4fdd\u65f6\u4e0d\u9700\u8981\u8f93\u5165"):["STEAL_INS"].some(t=>t==e.id)&&(e.editable=!d["PRICE"]||!d["PRICE"].value||d["PRICE"].value<=6e5,e.tooltip=e.editable?null:"\u8f66\u4ef7\u9ad8\u4e8e60\u4e07\u65f6\u4e0d\u80fd\u6295\u4fdd"),["GPS_DEVICE_NO"].some(t=>t==e.id)&&(e.required=d["STEAL_INS"]&&"1"==d["STEAL_INS"].value,e.tooltip=e.required?"\u6295\u4fdd\u76d7\u62a2\u9669\u65f6\u5fc5\u987b\u8f93\u5165":null,e.required||d[e.id]&&d[e.id].errors&&(delete d[e.id].errors,this.setState({formData:d})));var u=!1;e.editable?(r.push({required:e.required,message:"\u8bf7\u8f93\u5165"+e.label}),"NUM"==e.type?e.dictionary||e.valueRef||(u=!0,e.max||e.size,e.min):e.dictionary||e.valueRef||"DatePicker"==e.ui||(u=!0,e.size)):d[e.id]&&d[e.id].errors&&(delete d[e.id].errors,this.setState({formData:d})),"ID_NO"==e.id&&r.push({validator(e,t,a){var l=[];t&&!T.validIdentityCodeValid(t)&&l.push(new Error("\u8bf7\u8f93\u5165\u6b63\u786e\u8eab\u4efd\u8bc1\u53f7")),a(l)}}),"MOBILE_NO"==e.id&&r.push({validator(e,t,a){var l=[];t&&!T.validMobileNo(t)&&l.push(new Error("\u8bf7\u8f93\u5165\u6b63\u786e\u624b\u673a\u53f7")),a(l)}}),"VIN"==e.id&&r.push({validator(e,t,a){var l=[];t&&!T.validateVIN(t)&&l.push(new Error("\u8bf7\u8f93\u5165\u6b63\u786eVIN\u7801")),a(l)}});var c={valuePropName:"value",rules:r};u&&(c.validateTrigger="onBlur"),"checkbox01"==e.ui?c.valuePropName="checked":"Upload"==e.ui&&(c.getValueFromEvent=this.normFile);var f=this.FIX_WIDTH[e.id]?this.FIX_WIDTH[e.id]:a.length>5&&(!l||0!=i)?12:24,h=o.default.createElement(n.default,{title:e.tooltip},t(e.id,c)(this.getInputComponent(e)));return o.default.createElement(s.default,{span:f,key:e.id},o.default.createElement(M,(0,w.default)({},l?0==i?Y:z:x,{label:l&&0==i?o.default.createElement("b",null,e.label):e.label}),"ADDRESS"==e.id?this.getInputComponent(this.getLayout().columnMap.ADDRESS_SELECT,!0):null,h,e.tail?" "+e.tail:null,"GPS_DEVICE_NO"==e.id?o.default.createElement("a",{href:"javascript:;",onClick:()=>this.showDeviceOnMap()},"\xa0\u67e5\u770b\u5b9a\u4f4d"):null))}):[],u=[];return Object.keys(l).length>1?["basic","vehicle"].map(e=>{i[e]&&l[e]&&l[e].length>0&&u.push(o.default.createElement(s.default,{span:24,key:"group_"+e,style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,i[e].title))),u=[...u,...d(l[e])]}):u=d(a),a.some(e=>"Upload"==e.ui)&&u.push(o.default.createElement(s.default,{key:"FW_uploadPrompt",span:24,style:{height:60,textAlign:"center"}},this.state.uploadResult)),o.default.createElement(S.default,{style:{height:"100%"}},o.default.createElement("div",{style:{overflow:"auto",height:"90%",left:0,padding:10,paddingBottom:20,backgroundColor:"#ffffff"}},o.default.createElement(r.default,null,u)))}),this.state=(0,y.default)({},e,{loading:!1,dialogs:{},form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{},uploadedFile:null,uploadResult:null,manualValues:{}})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData;t.newData=(0,y.default)({},this.props.initData),t.oldData=(0,y.default)({},this.props.initData),Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.setState({fwParam:this.state.fwParam,formData:a,refData:{}})}else if(this.props.showAsDialog){var l=(0,y.default)({},this.state.fwParam,{oldData:{},newData:{},selectedData:this.props.selectedData});this.props.getEditData({fwCoord:this.getFwCoord(),fwParam:l,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData,i=t.manualValues;a.newData=(0,y.default)({},e),a.oldData=(0,y.default)({},e),Object.keys(e).map(t=>l[t]={value:e[t]}),i["ADDRESS_SELECT"]=e["ADDRESS_SELECT"]?e["ADDRESS_SELECT"].split(","):[],this.setState({fwParam:this.state.fwParam,formData:l,refData:{},manualValues:i})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null)}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.CustomizedForm;return o.default.createElement("div",{style:{height:"100%"}},o.default.createElement(g.default,{style:{height:"100%"},spinning:this.props.loading||this.state.loading},o.default.createElement(e,{onChange:this.handleFormChange})),Object.values(this.state.dialogs))}})||k);t.default=U},"4fPC":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=s;var o=i(a("q1tI"));a("5Dmo");var r=i(a("3S7+"));l(a("uYVn"));function s(e,t,a,l,i){var s=null;s="0"==t.MSG_TYPE?t.ADDRESS:t.MEMBER_ADDRESS;var n=s;return s&&s.length>50&&(n=o.default.createElement(r.default,{title:s},s.substr(0,50),"...")),n}},"7IhZ":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=d,t.logic=u,t.handleOk=c,t.handleCancel=f;var o=i(a("q1tI"));a("2qtc");var r=i(a("kLXV")),s=i(a("MVZn"));a("Pwec");var n=i(a("CtXQ"));l(a("uYVn"));function d(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(n.default,{type:this.action.icon}),this.action.label," "))}function u(e,t,l,i,n){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=n;var d=(0,s.default)({},this.view.getFwCoord(),{function:this.action.argument.selectFunction,view:this.action.argument.selectView?this.action.argument.selectView:t}),u={openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord()["view"],openerActionId:t,openerSelectedData:l,showAsDialog:1};console.info("fwParam",u);var c=e=>{this.innerLayout||(this.innerLayout={}),this.innerLayout[t]=e;var l=this.view.state.dialogs,i=null;if(console.info("this.action",this.action),this.action.argument&&this.action.argument.antdPath){var s=this.action.argument.antdPath;i=a("RO01")(`./${s}`).default}else i=a("e/J2").default;l[this.id]=o.default.createElement(r.default,{width:"42vw",key:this.id,title:e.title,visible:!0,maskClosable:!1,confirmLoading:this.view.props.selectLoading,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4fdd\u5b58",onOk:e=>this.handleOk(e)},o.default.createElement(i,{fwParam:u,innerLayout:e,innerFwCoord:d,showAsDialog:!0,buttonSize:"small",tableSize:"small",showSelectCol:"checkbox",onRef:e=>this.onRef(e)})),this.view.setState({dialogs:l})};this.innerLayout&&this.innerLayout[t]?c(this.innerLayout[t]):this.view.props.loadLayout({fwCoord:d,fwParam:u,callback:c})}function c(e){}function f(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},"7nvx":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=h,t.logic=m;var o=i(a("q1tI"));a("P2fV");var r=i(a("NJEC"));a("Pwec");var s=i(a("CtXQ"));a("miYZ");var n=i(a("tsqr")),d=i(a("MVZn"));a("2qtc");var u=i(a("kLXV")),c=l(a("uYVn")),f=u.default.confirm;function h(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement(r.default,{key:this.action.fw_index,title:"\u786e\u8ba4\u8981\u5220\u9664\u5417?",visible:!!this.view.state.deleteConfirmVisible&&this.view.state.deleteConfirmVisible[l],onVisibleChange:e=>{var t=(0,d.default)({},this.view.state.deleteConfirmVisible);t[l]=e,e?this.view.props.validDeleteData({fwCoord:this.view.getFwCoord(),fwParam:(0,d.default)({},this.view.state.fwParam,{newListData:[a]}),callback:e=>{e.success?this.view.setState({deleteConfirmVisible:t}):c.isEmpty(e.errorMsg)||n.default.error(e.errorMsg,10)}}):this.view.setState({deleteConfirmVisible:t})},onConfirm:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(s.default,{type:this.action.icon}),this.action.label," "))}function m(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t];var o=!1;if(null==a){if(this.view.state.selectedRowKeys&&this.view.state.selectedRowKeys.length>0){var r=this.view.state.selectedRowKeys[0];this.record=this.view.state.data[r],this.recordIndex=r,o=!0}}else this.record=a,this.recordIndex=l;if(this.record){this.event=i;var s=(0,d.default)({},this.view.state.fwParam,{newListData:[this.record]}),u=()=>{this.view.props.deleteData({fwCoord:this.view.getFwCoord(),fwParam:s,callback:e=>{e.success?(c.isEmpty(e.errorMsg)?n.default.success("\u5220\u9664\u6210\u529f"):n.default.info(e.errorMsg,10),this.view.getGridData({})):c.isEmpty(e.errorMsg)||n.default.error(e.errorMsg,10)}})};o?this.view.props.validDeleteData({fwCoord:this.view.getFwCoord(),fwParam:s,callback:e=>{e.success?f({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417?",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk(){u()},onCancel(){console.log("Cancel")}}):c.isEmpty(e.errorMsg)||n.default.error(e.errorMsg,10)}}):u()}else n.default.error("\u8bf7\u9009\u62e9\u8981\u5220\u9664\u7684\u6570\u636e",5)}},"84t4":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("14J3");var r=i(a("BMrR"));a("jCWc");var s=i(a("kPKH"));a("DZo9");var n=i(a("8z0m"));a("miYZ");var d=i(a("tsqr"));a("giR+");var u=i(a("fyUT"));a("Xi6J");var c=i(a("kl6h"));a("iQDF");var f=i(a("+eQT"));a("O3gP");var h=i(a("lrIw"));a("6UJt");var m=i(a("DFOY"));a("nRaC");var p=i(a("5RzL"));a("T2oS");var v=i(a("W9HT")),g=i(a("pVnL")),w=i(a("MVZn"));a("2qtc");var y=i(a("kLXV"));a("sRBo");var C=i(a("kaz8"));a("7Kak");var D=i(a("9yH6"));a("OaEy");var E=i(a("2fM7"));a("5NDa");var b=i(a("5rEg"));a("y8nQ");var S=i(a("Vl3Y"));a("ozfa");var L,P,k=i(a("MJZm")),I=a("MuoO"),R=(i(a("QCDS")),l(a("uYVn"))),T=l(a("dNXO")),A=a("0Fy/"),_=i(a("wd/R"));a("XDpg"),_.default.locale("zh-cn");var O=k.default.TreeNode,M=S.default.Item,F=b.default.TextArea,N=E.default.Option,j=D.default.Group,V=C.default.Group,x=y.default.confirm,z={labelCol:{xs:{span:8},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16}}};function Y(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.create,dispatch:a,fwCoord:l,layout:i}}var G=e=>{return{getCreateData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"create/getCreateData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveCreateData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"create/saveCreateData",payload:{fwCoord:a,fwParam:l,callback:i}})}}},q=(L=(0,I.connect)(Y,G),L(P=class extends o.Component{constructor(e){super(e),this.convertToCascadeData=((e,t)=>{return e?e.map(e=>{return e.value=e[t.value],e.label=e[t.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e.children&&(e.children=this.convertToCascadeData(e.children,t)),e}):null}),this.loadCascaderData=((e,t)=>{var a=e[e.length-1];a.loading=!0;var l=t.valueRef;this.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:l.function,view:l.view}),fwParam:{distinct:l.distinct?l.distinct:null,queryColumns:l.value+","+l.label+(l.otherRefs?","+l.otherRefs:"")+(l.disableColumn?","+l.disableColumn:""),selectedTreeNodeId:e.map(e=>e[l.value]).join(","),selectedData:l.useCurrentData?this.getEditedNewData():null},callback:e=>{a.loading=!1,a.children=this.convertToCascadeData(e.data,l),this.setState({refData:this.state.refData})}})}),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,w.default)({},this.state.fwParam,{openerSelectedData:(0,w.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,w.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(O,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+(t.valueRef.otherRefs?","+t.valueRef.otherRefs:"")+(t.valueRef.disableColumn?","+t.valueRef.disableColumn:""),selectedTreeNodeId:e.props.eventKey,selectedData:t.valueRef.useCurrentData?this.getEditedNewData():null},callback:e=>{i.children=e.data,a.defaultOpen=!0,console.info(a.data),l(),this.setState({refData:this.state.refData})}}))})),this.onCascaderChange=((e,t,a)=>{if(console.info("onCascaderChange",e.id,t,a),"ADDRESS_SELECT"==e.id){var l=this.state,i=l.fwParam,o=l.formData,r=l.manualValues;i.newData||(i.newData={}),i.newData[e.id]=t.join(","),o[e.id]||(o[e.id]={}),o[e.id].value=t.join(","),r[e.id]=t,this.setState({fwParam:i,manualValues:r,formData:o})}}),this.onAutoCompleteSelect=((e,t,a)=>{console.info("onAutoCompleteSelect",e.id,t,a)}),this.onSelectChange=((e,t,a)=>{console.info("onSelectChange",e.id,t,a)}),this.onSelectSelect=((e,t,a)=>{console.info("onSelectSelect",e.id,t,a)}),this.MONEY_IDS={},this.getInputComponent=((e,t)=>{var a=this.state,l=a.components,i=a.refData,r=a.fwParam,s=a.formData,y=null,S={disabled:!e.editable,style:{width:"85%"}};t&&(S.value=this.state.manualValues[e.id]);var L="",P="";if(e.editable&&(L=e.prompt?e.prompt:"\u8bf7\u8f93\u5165",P=e.prompt?e.prompt:"\u8bf7\u9009\u62e9"),"label"==e.ui)y=this.getDisplayValue(e);else if("MEMO"===e.type)y=o.default.createElement(F,(0,g.default)({},S,{rows:4}));else if("checkbox01"===e.ui)y=o.default.createElement(C.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictList[e.dictionary]){var k=this.getLayout().dictList[e.dictionary];if("radio"==e.ui)y=o.default.createElement(j,(0,g.default)({name:e.id},S),k.map(e=>o.default.createElement(D.default,{key:e.value,value:String(e.value)},e.label)));else if("checkbox"==e.ui){var I=k;y=o.default.createElement(V,(0,g.default)({name:e.id},S,{options:I}))}else y=o.default.createElement(E.default,(0,g.default)({},S,{placeholder:P,showSearch:!0,mode:e.multiSelect?"multiple":null,optionFilterProp:"children",filterOption:(e,t)=>t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}),k.map(e=>o.default.createElement(N,{key:e.value,value:e.value},e.label)))}else if("TreeSelect"===e.ui&&e.valueRef){var R=e.valueRef;if(!i[e.id]){var T=null;R.function==this.props.fwParam.openerFunction&&R.view==this.props.fwParam.openerView&&this.props.treeData&&(T=this.props.treeData),i[e.id]={loading:!1,data:T,queryIndex:0,defaultOpen:!1}}var A=i[e.id];A.data||(A.data=[],this.props.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:R.function,view:R.view}),fwParam:{distinct:R.distinct?R.distinct:null,queryColumns:R.value+","+R.label+(R.otherRefs?","+R.otherRefs:"")+(R.disableColumn?","+R.disableColumn:""),selectedId:r&&r.newData&&r.newData[e.id]?r.newData[e.id]:null},callback:t=>{t.success?(A.data=t.data,A.loading=!1,i[e.id]=A,this.setState({refData:i})):A.data=null}})),y=o.default.createElement(p.default,(0,g.default)({},S,{placeholder:P,notFoundContent:A.loading?o.default.createElement(v.default,{size:"small"}):"\u65e0\u6570\u636e",showArrow:!0,showSearch:!0,searchPlaceholder:"\u8f93\u5165\u641c\u7d22",filterTreeNode:(e,t)=>{return console.info("treeNode",t),t.props.title.indexOf(e)>=0},treeNodeFilterProp:"title",filterOption:!1,loadData:t=>this.onTreeSelectLoadData(t,e,A),treeExpandedKeys:A.expandedKeys?A.expandedKeys:A.data.map(e=>String(e[R.value])),onTreeExpand:e=>{A.expandedKeys=e,A.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:A.defaultOpen,onSearch1:t=>{A.timeout&&(clearTimeout(A.timeout),A.timeout=null),A.currentValue=t;var a=()=>{console.info(t),A.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:R.function,view:R.view}),fwParam:{queryStr:t,distinct:R.distinct?R.distinct:null,queryColumns:R.value+","+R.label+(R.otherRefs?","+R.otherRefs:"")+(R.disableColumn?","+R.disableColumn:"")},callback:a=>{A.currentValue==t&&(A.data=a.data,A.loading=!1,A.defaultOpen=!0,s[e.id].value=t,this.setState({refData:i,fwParam:r,formData:s}))}})};A.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(A.data,R))}else if("Cascader"==e.ui&&e.valueRef){var _=e.valueRef;if(!i[e.id]){var O={};O[_.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),O[_.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var M=i[e.id];M.data||(M.data=[],this.props.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:_.function,view:_.view}),fwParam:{distinct:_.distinct?_.distinct:null,queryColumns:_.value+","+_.label+(_.otherRefs?","+_.otherRefs:"")+(_.disableColumn?","+_.disableColumn:""),selectedData:_.useCurrentData?this.getEditedNewData():null},callback:t=>{t.success?(M.data=this.convertToCascadeData(t.data,_),M.loading=!1,i[e.id]=M,this.setState({refData:i})):M.data=null}})),y=o.default.createElement(m.default,(0,g.default)({},S,{placeholder:P,options:M.data,loadData:t=>this.loadCascaderData(t,e),onChange:(t,a)=>this.onCascaderChange(e,t,a),showSearch:{filter:(e,t)=>{return t.some(t=>t.label.toLowerCase().indexOf(e.toLowerCase())>-1)}}}))}else if("AutoComplete"==e.ui&&e.valueRef){var x=e.valueRef;i[e.id]||(i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i}));var z=i[e.id];y=o.default.createElement(h.default,(0,g.default)({},S,{placeholder:L,dataSource:z.data,defaultOpen:z.defaultOpen,onSelect:(t,a)=>this.onAutoCompleteSelect(e,t,a),onSearch:e=>{z.timeout&&(clearTimeout(z.timeout),z.timeout=null),z.currentValue=e;var t=()=>{z.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:x.function,view:x.view}),fwParam:(0,w.default)({},this.state.fwParam,{queryValue:e,distinct:x.distinct?x.distinct:null,queryColumns:x.value+","+x.label+(x.otherRefs?","+x.otherRefs:"")+(x.disableColumn?","+x.disableColumn:""),selectedData:x.useCurrentData?this.getEditedNewData():null}),callback:t=>{if(z.currentValue==e){var a={};t.success&&t.data.map(e=>{a[e[x.label]]=e}),z.dataMap=a,z.data=Object.keys(a),z.loading=!1,z.defaultOpen=!0,z.autoFocus=!0,this.setState({refData:i,fwParam:r})}}})};z.timeout=setTimeout(t,900)}}))}else if(null!=e.valueRef){var Y=e.valueRef;if(!i[e.id]){var G={};G[Y.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),G[Y.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var q=i[e.id];q.data||(q.data=[],this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:Y.function,view:Y.view}),fwParam:{distinct:Y.distinct?Y.distinct:null,queryColumns:Y.value+","+Y.label+(Y.otherRefs?","+Y.otherRefs:"")+(Y.disableColumn?","+Y.disableColumn:""),selectedData:Y.useCurrentData?this.getEditedNewData():null},callback:t=>{var a,l=[],o={};(t.success&&(l=t.data,l&&l.map(e=>o[e[Y.value]]=e)),e.showColumn)&&function(){console.info("showColumn",s[e.showColumn],s[e.id]);var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],i=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],o=null;if(i.length>0&&t.length==i.length)for(a=0;a<i.length;++a)l.some(e=>e[Y.value]==i[a])||(o={},o[Y.value]=i[a],o[Y.label]=t[a],l.push(o))}();q.data=l,q.dataMap=o,q.loading=!1,i[e.id]=q,this.setState({refData:i,formData:s})}}));var U=q.data.map(e=>o.default.createElement(N,{key:e[Y.value],disabled:Y.disableColumn&&e[Y.disableColumn]==Y.disableValue},e[Y.label],Y.otherRefs?Y.otherRefs.split(",").map(t=>{e[t]}):""));y=o.default.createElement(E.default,(0,g.default)({},S,{placeholder:P,showSearch:!0,mode:e.multiSelect?"multiple":null,notFoundContent:q.loading?o.default.createElement(v.default,{size:"small"}):"\u65e0\u6570\u636e",showArrow:!0,filterOption:!1,labelInValue:!0,autoFocus:q.autoFocus,defaultOpen:q.defaultOpen,onSelect:(t,a)=>this.onSelectSelect(e,t,a),onChange:(t,a)=>this.onSelectChange(e,t,a),onSearch:t=>{q.timeout&&(clearTimeout(q.timeout),q.timeout=null),q.currentValue=t;var a=()=>{q.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:Y.function,view:Y.view}),fwParam:{queryValue:t,distinct:Y.distinct?Y.distinct:null,queryColumns:Y.value+","+Y.label+(Y.otherRefs?","+Y.otherRefs:"")+(Y.disableColumn?","+Y.disableColumn:""),selectedData:Y.useCurrentData?this.getEditedNewData():null},callback:a=>{if(q.currentValue==t){var l,o=[],r={};if(a.success&&(o=a.data,o&&o.map(e=>r[e[Y.value]]=e)),e.showColumn)(function(){var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],a=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],i=null;if(a.length>0&&t.length==a.length)for(l=0;l<a.length;++l)o.some(e=>e[Y.value]==a[l])||(i={},i[Y.value]=a[l],i[Y.label]=t[l],o.push(i))})();q.data=o,q.dataMap=r,q.loading=!1,q.defaultOpen=!0,q.autoFocus=!0,this.setState({refData:i})}}})};q.timeout=setTimeout(a,500)}}),U)}else if("DatePicker"===e.ui){var B=()=>!1;B=(t=>{var a=!1;return e.min&&t&&t<this.getRealDate(e.min).startOf("day")&&(a=!0),a||e.max&&t&&t>this.getRealDate(e.max).endOf("day")&&(a=!0),a}),y=o.default.createElement(f.default,(0,g.default)({},S,{disabledDate:e=>B(e),placeholder:P}))}else if("TimePicker"===e.ui)y=o.default.createElement(c.default,S);else if("InputNumber"===e.ui)y=o.default.createElement(u.default,(0,g.default)({},S,{placeholder:L}));else if("Upload"===e.ui){var K=(0,w.default)({},this.getFwCoord(),{view:"create"}),W={openerActionId:e.id,openerFunction:this.getFwCoord()["function"],openerView:this.getFwCoord().view,oldData:{},newData:{},saveType:"checkonly"},H=this.objectToFormInputs({fwCoord:K,fwParam:W},null,null),X={name:e.id+"_importFile",action:"/fw/importData?fwCoord.project="+this.getFwCoord().project+"&",data:H,onChange(t){if(this.view.setState({loading:!0}),t.file.status,"done"===t.file.status){var a=t.file.response;this.view.setState({uploadedFile:t.file.name,uploadResult:null,loading:!1}),a.success?(r.connectFilePath=a.connectFilePath,this.view.setState({fwParam:r}),d.default.info("\u6587\u4ef6\u6821\u9a8c\u901a\u8fc7")):a.connectFilePath?this.view.setState({uploadResult:o.default.createElement("span",{dangerouslySetInnerHTML:{__html:'<font color="#ff0000"><a href="/fw/download?fileName='+a.connectFilePath+'" target="_blank">\u4e0a\u4f20\u6587\u4ef6\u6709\u8bef\uff0c\u70b9\u6b64\u4e0b\u8f7d\u660e\u7ec6</a></font>'}})}):a.errorMsg&&d.default.error(a.errorMsg,10)}else"error"===t.file.status&&(this.view.setState({loading:!1}),d.default.error(`${e.label}\u5bfc\u5165\u9519\u8bef`,10))}};X.view=this;var Z=this.state.uploadedFile?this.state.uploadedFile:this.state.uploadShowLabel[e.id]?this.state.uploadShowLabel[e.id]:null;y=o.default.createElement(n.default,(0,g.default)({},S,X,{showUploadList:!1,style:{marginLeft:10}}),o.default.createElement("a",{href:"javascript:;"},Z||"\u70b9\u51fb\u4e0a\u4f20"))}else"MAP"==e.ui?(console.info("col.ui",e.ui),y=o.default.createElement(b.default,(0,g.default)({},S,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn;return y||(y=o.default.createElement(b.default,(0,g.default)({},S,{type:e.ui?e.ui:"text",placeholder:L}))),l[e.id]=y,y}),this.getRealDate=(e=>{if(0==e.indexOf("{today")&&e.indexOf("}")==e.length-1){var t=String(e).substring(6,e.length-1);return(0,_.default)().add(parseInt(t),"days")}return"today"==e?(0,_.default)():(0,_.default)(e)}),this.clearUpload=(e=>{var t=this.state,a=t.uploadShowLabel,l=t.formData;delete a[e.id],l[e.id]&&(l[e.id].value=null,l[e.id].dirty=!0),this.setState({uploadedFile:null,uploadShowLabel:a,formData:l})}),this.normFile=(e=>{return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.file&&e.file.response?e.file.response.success?e&&e.fileList:null:e&&e.fileList}),this.objectToFormInputs=function(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>this.objectToFormInputs(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]).replace(/%/g,"%25").replace(/\&/g,"%26").replace(/\+/g,"%2B").replace(/\=/g,"%3D"):this.objectToFormInputs(e[o],i,l)}return i},this.selectPointInMap=(e=>{var t=this.state.formData,a=this.getLayout().columnMap[e],l=a.showColumn.split(",");console.info("param",l,t),this.state.map.selectPoint({id:e,lat:t[l[0]]?t[l[0]].value:36,lng:t[l[1]]?t[l[1]].value:120,name:a.label,callback:(e,a,i,o,r)=>{console.info("callback",r,r.onlineStr),t[e]||(t[e]={}),t[l[0]]||(t[l[0]]={}),t[l[1]]||(t[l[1]]={}),t[e].value=r.onlineStr,t[l[0]].value=a,t[l[1]].value=i,console.info("newParam",a,i,t),this.setState({formData:t})}})}),this.handleFormChange=(e=>{if(e){var t=this.state,a=t.fwParam,l=(t.formData,this.state.insuranceData);a.newData||(a.newData={}),Object.keys(e).map(t=>{var a=e[t],i=this.getLayout().columnMap[t],o=0,r=null,s=null;void 0==i&&(r=t.split("?"),i=this.getLayout().columnMap[r[0]],r.length>1&&(o=r[1],s=l[o]));var n=i.ui,d=null;if(a&&null!=a.value)if(this.state.formData[t]||(this.state.formData[t]={}),d=a.value,"PARENT_PROXY"!=t&&"TYPE"!=t||(Object.keys(this.state.refData).map(e=>e.indexOf("INS_TEMPLATE_ID")>=0?delete this.state.refData[e]:null),l=[{}]),"DatePicker"===n)d=a.value.format(i.pattern?i.pattern:"YYYY-MM-DD");else if("TimePicker"===n)d=a.value.format(i.pattern?i.pattern:"HH:mm:ss");else if("checkbox01"===n)d=a.value?"1":"0";else if(i.dictionary)i.ui,Array.isArray(a.value)&&(d=a.value.join(","));else if("Cascader"==i.ui)Array.isArray(a.value)&&(d=a.value.join(","),console.info("Cascader",a.value,d));else if("AutoComplete"==i.ui)d=a.value;else if(i.valueRef&&"TreeSelect"!=i.ui){if(d=Array.isArray(a.value)?a.value.filter(e=>e&&e.key).map(e=>e.key).join(","):a.value.key?a.value.key:null,i.showColumn){var u=this.getLayout().columnMap[i.showColumn.split(",")[0]];if(u){var c=Object.values(a.value).map(e=>Array.isArray(e.label)?e.label[0]:e.label).join(",");this.state.formData[u.id]||(this.state.formData[u.id]={}),this.state.formData[u.id].value=c}}}else"Upload"===i.ui?(console.info("upload",d),Array.isArray(d)&&(d=d[0].name)):"MAP"==i.ui?(d=this.state.formData[t].value,a.dirty=!0):("string"==typeof d&&(d=d.trim(!0),i.size>0&&d.length>i.size&&(d=d.substr(0,i.size))),"NUM"==i.type&&("number"!==typeof d&&(d=new String(d).split("").filter(e=>!R.isEmpty(e)).filter((e,t,a)=>0==t&&"-"==e||"."==e&&a.filter((e,a)=>a<t).every(e=>"."!=e)||R.isNumber(e)).join("")),void 0!=i.min&&null!=i.min&&(null==d||d<i.min)&&(d=i.min),void 0!=i.max&&null!=i.max?d>i.max&&(d=i.max):i.size&&d>Math.pow(10,i.size)-1&&(d=Math.pow(10,i.size)-1)));a.value=d,null!=s&&(s[i.id]=d)}),this.setState({formData:(0,w.default)({},this.state.formData,e),fwParam:a,insuranceData:l})}}),this.doOtherInputValidate=(()=>{var e={},t=this.state.insuranceData;return t.map((t,a,l)=>{a>0&&l.filter((e,t)=>t<a).some(e=>e.INS_TEMPLATE_ID==t.INS_TEMPLATE_ID)&&(e["INS_TEMPLATE_ID?"+a]="\u6bcf\u4e2a\u4fdd\u5355\u53ea\u80fd\u6dfb\u52a0\u4e00\u6761\u8bb0\u5f55")}),Object.keys(e).length>0?e:null}),this.getEditedNewData=(()=>{var e=(0,w.default)({},this.props.clientNewData,this.state.fwParam.newData);return Object.keys(this.state.formData).map(t=>e[t]=this.state.formData[t].value),this.processNewData&&this.processNewData(e),e}),this.processNewData=(e=>{e.insuranceData=this.state.insuranceData}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],r=i;if(e.onFormat)r=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var s=this.getLayout().dictMap[e.dictionary][i];r=s||i}else e.showColumn&&(r=e.showColumn.split(",").map(e=>t[e]).join(" "));return o.default.createElement("span",null,r)}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,w.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return T.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.addInsurance=function(){var e=this.state.insuranceData;e.push({}),this.setState({insuranceData:e})},this.deleteInsurance=function(e){var t=this.state.insuranceData;1!=t.length&&x({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417?",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:()=>{e<t.length&&(t.splice(e,1),this.setState({insuranceData:t}))},onCancel(){console.log("Cancel")}})},this.FIX_WIDTH={},this.CustomizedForm=S.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t=(e,t)=>{if(e&&null!=e.value)if("DatePicker"===t.ui)e.value=e.value?(0,_.default)(e.value,t.pattern?t.pattern:"YYYY-MM-DD"):e.value;else if("TimePicker"===t.ui)e.value=e.value?(0,_.default)(e.value,t.pattern?t.pattern:"HH:mm:ss"):e.value;else if("checkbox01"===t.ui)e.value="1"==e.value;else if(t.dictionary)"checkbox"==t.ui?Array.isArray(e.value)||(e.value=String(e.value).split(",")):t.multiSelect?e.value?e.value=String(e.value).split(","):e.value=null:e.value=String(e.value);else if("Cascader"==t.ui)e.value=String(e.value).split(",");else if("AutoComplete"==t.ui);else if(t.valueRef&&"TreeSelect"!=t.ui){if(Array.isArray(e.value)||(e.value?e.value=String(e.value).split(",").map(e=>({key:e})):e.value=[]),Array.isArray(e.value)&&t.showColumn){var a=this.state.formData[t.showColumn.split(",")[0]];a&&a.value&&a.value.split(",").map((t,a)=>e.value.length>a?e.value[a].label=t:null)}}else"MAP"==t.ui?e.value=e.value.split("\u3001").join(""):"NUM"!=t.type||t.dictionary?e.value=String(e.value):(""===e.value&&(e.value=null),e.value);(void 0===e.value||null===e.value||""===e.value||Array.isArray(e.value)&&0==e.value.length)&&delete e.value},a={};this.getLayout().columns.filter(e=>e.visible).map(e=>{var l=(0,w.default)({},this.state.formData[e.id]);t(l,e),a[e.id]=S.default.createFormField((0,w.default)({},l))});var l=this.state.insuranceData;return this.getLayout().columns.filter(e=>e.visible&&"insurance"==e.group).map(e=>{l.map((l,i)=>{var o=(0,w.default)({},this.state.formData[e.id+"?"+i],{value:l[e.id]});t(o,e),a[e.id+"?"+i]=S.default.createFormField((0,w.default)({},o))})}),a},onValuesChange(e,t){}})(e=>{this.state.form=e.form;var t=e.form.getFieldDecorator,l=this.getLayout().columns.filter(e=>e.visible),i={_default:[]},n={};this.getLayout().columnGroups&&this.getLayout().columnGroups.map(e=>n[e.id]=e),l.map(e=>{var t="_default";e.group&&n[e.group]&&(t=e.group),i[t]||(i[t]=[]),i[t].push(e)});var d=(e,i,r)=>e?e.map(e=>{var n=[],d=this.state.formData,u=e.id;void 0!=r&&(u=u+"?"+r),["PARENT_PROXY"].some(e=>e==u)&&(e.required=d["TYPE"]&&"2"==d["TYPE"].value,e.editable=e.required,e.required||d[u]&&d[u].errors&&(delete d[u].errors,this.setState({formData:d}))),"insurance"==e.group&&(e.required=!0);var c=!1;if(e.editable&&(n.push({required:e.required,message:"\u8bf7\u8f93\u5165"+e.label}),"NUM"==e.type?e.dictionary||e.valueRef||(c=!0,e.max||e.size,e.min):e.dictionary||e.valueRef||"DatePicker"==e.ui||(c=!0,e.size)),e.onValidate&&this.getLayout().clientLogicMap[e.onValidate]){var f=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onValidate].file}`);n.push({validator:(t,a,l)=>{var i=[];a&&!f.validate(a,this.state.fwParam.newData,0,e,this)&&i.push(new Error(f.errorMsg(a,this.state.fwParam.newData,0,e,this))),l(i)}})}var h={valuePropName:"value",rules:n};return c&&(h.validateTrigger="onBlur"),"checkbox01"==e.ui?h.valuePropName="checked":"Upload"==e.ui&&(h.getValueFromEvent=this.normFile),o.default.createElement(s.default,{span:"insurance"==i?u.indexOf("INS_TEMPLATE_ID")>=0?24:8:l.length>=4||l.some(e=>"MAP"==e.ui)?12:24,key:u},o.default.createElement(M,(0,g.default)({},z,{label:e.label}),t(u,h)(this.getInputComponent(e)),this.state.insuranceData.length>1&&u.indexOf("INS_TEMPLATE_ID")>=0?o.default.createElement("a",{style:{color:"red"},onClick:()=>this.deleteInsurance(r)},"\xa0\u5220\u9664"):e.tail?" "+e.tail:null))}):[],u=[];return Object.keys(i).length>1?["_default",...this.getLayout().columnGroups.map(e=>e.id)].map(e=>{n[e]&&i[e]&&i[e].length>0&&u.push(o.default.createElement(s.default,{span:24,key:"group_"+e,style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,n[e].title),"\xa0","insurance"==e?o.default.createElement("a",{onClick:()=>this.addInsurance()},"\u6dfb\u52a0\u4fdd\u5355"):null)),"insurance"==e?this.state.insuranceData.map((t,a)=>{u=[...u,...d(i[e],e,a)]}):u=[...u,...d(i[e],e)]}):u=d(l,null),l.some(e=>"Upload"==e.ui)&&u.push(o.default.createElement(s.default,{key:"FW_uploadPrompt",span:24,style:{height:60,textAlign:"center"}},this.state.uploadResult)),o.default.createElement(S.default,null,o.default.createElement(r.default,{gutter:1},u))}),this.state=(0,w.default)({},e,{loading:!1,dialogs:{},form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{},uploadedFile:null,uploadResult:null,uploadShowLabel:{},manualValues:{},insuranceData:[{}]})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData,l=e.uploadShowLabel;t.newData=(0,w.default)({},this.props.initData),t.oldData={},Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.getLayout().columns.filter(e=>"Upload"==e.ui).map(e=>l[e.id]=this.props.initData[e.id]),this.setState({fwParam:this.state.fwParam,formData:a,refData:{},uploadShowLabel:l},()=>{this.getLayout().columns.filter(e=>"MAP"==e.ui).map(e=>this.selectPointInMap(e.id))})}else if(this.props.showAsDialog){console.info("2",this.props.clientNewData);var i=(0,w.default)({},this.state.fwParam,{oldData:{},newData:this.props.clientNewData});this.props.getCreateData({fwCoord:this.getFwCoord(),fwParam:i,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData,i=e["_FW_DYNAMIC_LAYOUT"];delete e["_FW_DYNAMIC_LAYOUT"],i&&i.columns&&i.columns.map(e=>{var t=this.getLayout().columnMap[e.id];t&&Object.keys(e).map(a=>t[a]=e[a])}),a.newData=(0,w.default)({},e),a.oldData={},Object.keys(e).map(t=>l[t]={value:e[t]}),this.setState({fwParam:this.state.fwParam,formData:l,refData:{}})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null)}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.CustomizedForm;return o.default.createElement("div",null,o.default.createElement(v.default,{spinning:this.props.loading||this.state.loading},o.default.createElement(e,{onChange:this.handleFormChange}),this.getLayout().columns.some(e=>e.visible&&"MAP"==e.ui)?o.default.createElement(A.Map,{height:"50vh",showQueryControl:!0,onRef:e=>this.setState({map:e})}):null),Object.values(this.state.dialogs))}})||P);t.default=q},"8vKD":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=c,t.logic=f,t.handleOk=h,t.handleCancel=m;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr")),s=i(a("MVZn"));a("2qtc");var n=i(a("kLXV"));a("Pwec");var d=i(a("CtXQ")),u=l(a("uYVn"));function c(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(d.default,{type:this.action.icon}),this.action.label," "))}function f(e,t,l,i,r){this.view=e,this.record=l,this.recordIndex=i,this.event=r;var s={function:"vehicle",view:"edit"},d={openerActionId:"showEditInList",openerFunction:"",openerView:"",oldData:{},newData:{}},u=null;u=a("Tpzm").default;var c=e=>{this.innerLayout||(this.innerLayout={}),this.innerLayout[t]=e;var a=this.view.state.dialogs,l=e.columns.filter(e=>e.visible),i=l.length<5?"25vw":"42vw";a[this.id]=o.default.createElement(n.default,{width:i,key:this.id,title:e.title,visible:!0,maskClosable:!1,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4fdd\u5b58",onOk:e=>this.handleOk(e)},o.default.createElement(u,{selectedData:this.record,innerLayout:e,innerFwCoord:s,fwParam:d,showAsDialog:!0,onRef:e=>this.onRef(e)})),this.view.setState({dialogs:a})};this.innerLayout&&this.innerLayout[t]?c(this.innerLayout[t]):this.view.props.loadLayout({fwCoord:s,fwParam:d,callback:c})}function h(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{if(this.dialog.doOtherInputValidate){var i=this.dialog.doOtherInputValidate();if(i){if(Array.isArray(i)){var o={};Object.keys(i).map(e=>{var t=n[e];o[e]=(0,s.default)({},t,{errors:[new Error(i[e])]})}),t.setFields(o)}else r.default.error(i);return}}var n=this.dialog.state.formData,d=this.dialog.state.fwParam.newData;Object.keys(n).map(e=>d[e]=n[e].value);var c=(0,s.default)({},this.dialog.state.fwParam,{newData:d});this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:c,callback:a=>{if(a.success)u.isEmpty(a.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(a.errorMsg,10),this.view.loadMemberInfo(this.view.props),this.view.props.refreshMemberList&&this.view.props.refreshMemberList(),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}u.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}})}})}function m(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},"8zqI":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=u,t.logic=f,t.handleOk=h,t.handleCancel=m;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr")),s=i(a("MVZn"));a("Pwec");var n=i(a("CtXQ")),d=l(a("uYVn"));function u(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(n.default,{type:this.action.icon}),this.action.label," "))}function f(e,t,a,l,i,o){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i;var n=this.view.state.data;this.view.props.saveSelectData({fwCoord:this.view.getFwCoord(),fwParam:(0,s.default)({},this.view.state.fwParam,{openerSelectedData:this.view.props.openerSelectedData,oldListData:n.filter(e=>e.FW_SELECTED),newListData:n.filter(e=>e.selected)}),callback:e=>{if(n.map(e=>e.FW_SELECTED=e.selected),o)o(e);else if(e.success)d.isEmpty(e.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(e.errorMsg,10);else{if(e.validResultMap){var t={};Object.keys(e.validResultMap).map(a=>{t[a]={value:values[a],errors:[new Error(e.validResultMap[a])]}}),form.setFields(t)}d.isEmpty(e.errorMsg)||r.default.error(e.errorMsg,10)}}})}function h(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{a?console.info("error",a):(console.info("values",l,this.dialog.props.fwParam.oldData),this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:(0,s.default)({},this.dialog.state.fwParam),callback:a=>{if(a.success)d.isEmpty(a.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(a.errorMsg,10),this.dialog.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}d.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}}))})}function m(e){c;var t=this.dialog.state.dialogs;delete t[this.id],this.dialog.setState({dialogs:t})}},ApSM:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=n,t.logic=d,t.handleOk=u,t.handleCancel=c;var o=i(a("q1tI")),r=i(a("MVZn"));a("miYZ");var s=i(a("tsqr"));l(a("uYVn"));function n(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],console.info("layout executed",this),o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(Icon,{type:this.action.icon}),this.action.label," "))}function d(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i;this.view.getLayout().argument.treeIdField,this.view.getLayout().argument.treeParentIdField;if(!this.record){var o=null;this.view.state.selectedKeys&&this.view.state.selectedKeys.length>0&&(o=this.view.state.selectedKeys[0]);var n=null;o&&(n=this.view.findNode(o)),this.record=n}if(null!=this.record)if("1"!=this.record.TYPE){e.getLayout().argument.treeCanAddRoot,this.record=(0,r.default)({},this.record,{children:null});while(this.record.PARENT_ID)this.record=this.view.findNode(this.record.PARENT_ID);this.view.getActionEntry("showCreateChildInTree").logic(e,"showCreateChildInTree",this.record,0,i)}else s.default.info("\u4e0d\u53ef\u65b0\u589e\u4ee3\u7406\u5546\u4e0b\u5c5e\u95e8\u5e97",5);else s.default.info("\u8bf7\u9009\u62e9\u8981\u65b0\u5efa\u95e8\u5e97\u7684\u5ba2\u6237",5)}function u(e){}function c(e){}},CD6Z:function(e,t,a){"use strict";var l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.validate=o,t.errorMsg=r;var i=l(a("uYVn"));function o(e,t,a,l,o){return!e||i.validMobileNo(e)}function r(e,t,a,l,i){return"\u8bf7\u8f93\u5165\u6b63\u786e\u7684"+l.label}},CRJk:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o,r,s=l(a("q1tI")),n=i(a("MVZn")),d=a("MuoO"),u=l(a("dNXO"));function c(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.fw,dispatch:a,fwCoord:l,layout:i}}var f=e=>{return{loadLayout:t=>{var a=t.fwCoord,l=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,callback:l}})}}},h=(o=(0,d.connect)(c,f),o(r=class extends s.Component{constructor(e){super(e),this.getLayout=(()=>{return this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,n.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return u.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(a).logic(this,a,null,-1,l)},this.state=(0,n.default)({},e,{dialogs:{}})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this)}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){return s.default.createElement("div",null,"Demo Page")}})||r);t.default=h},CSog:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=d,t.logic=u,t.handleOk=c,t.handleCancel=f;var o=i(a("q1tI")),r=i(a("MVZn"));a("Pwec");var s=i(a("CtXQ")),n=l(a("uYVn"));function d(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(s.default,{type:this.action.icon}),this.action.label," "))}function u(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,this.view.state.fwParam=(0,r.default)({},this.view.state.fwParam,{oldData:(0,r.default)({},this.view.props.selectedData),newData:(0,r.default)({},this.view.props.selectedData)}),this.view.props.getCreateData({fwCoord:this.view.getFwCoord(),fwParam:{selectedData:(0,r.default)({},this.view.props.selectedData)},callback:e=>{var t={};Object.keys(e).map(a=>t[a]={value:e[a]}),this.view.setState({fwParam:(0,r.default)({},this.view.state.fwParam,{oldData:{},newData:(0,r.default)({},e)}),formData:t,manualValues:{}}),this.view.afterSetCreateData&&this.view.afterSetCreateData()}})}function c(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{a?console.info("error",a):(console.info("values",l,this.dialog.props.fwParam.oldData),this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:(0,r.default)({},this.dialog.state.fwParam),callback:a=>{if(a.success)n.isEmpty(a.errorMsg)?message.success("\u4fdd\u5b58\u6210\u529f"):message.info(a.errorMsg,10),this.dialog.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}n.isEmpty(a.errorMsg)||message.error(a.errorMsg,10)}}}))})}function f(e){var t=this.dialog.state.dialogs;delete t[this.id],this.dialog.setState({dialogs:t})}},CYmM:function(e,t,a){"use strict";var l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.validate=o,t.errorMsg=r;var i=l(a("uYVn"));function o(e,t,a,l,o){return!e||i.validateVIN(e)}function r(e,t,a,l,i){return"\u8bf7\u8f93\u5165\u6b63\u786e\u7684"+l.label}},Cl18:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("14J3");var r=i(a("BMrR"));a("jCWc");var s=i(a("kPKH"));a("DZo9");var n=i(a("8z0m"));a("miYZ");var d=i(a("tsqr"));a("giR+");var u=i(a("fyUT"));a("Xi6J");var c=i(a("kl6h"));a("iQDF");var f=i(a("+eQT"));a("O3gP");var h=i(a("lrIw"));a("6UJt");var m=i(a("DFOY"));a("nRaC");var p=i(a("5RzL"));a("T2oS");var v=i(a("W9HT")),g=i(a("pVnL")),w=i(a("MVZn"));a("2qtc");var y=i(a("kLXV"));a("sRBo");var C=i(a("kaz8"));a("7Kak");var D=i(a("9yH6"));a("OaEy");var E=i(a("2fM7"));a("5NDa");var b=i(a("5rEg"));a("y8nQ");var S=i(a("Vl3Y"));a("ozfa");var L,P,k=i(a("MJZm")),I=a("MuoO"),R=(i(a("QCDS")),l(a("uYVn"))),T=l(a("dNXO")),A=a("0Fy/"),_=i(a("wd/R"));a("XDpg"),_.default.locale("zh-cn");var O=k.default.TreeNode,M=S.default.Item,F=b.default.TextArea,N=E.default.Option,j=D.default.Group,V=C.default.Group,x=y.default.confirm,z={labelCol:{xs:{span:8},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16}}};function Y(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.edit,dispatch:a,fwCoord:l,layout:i}}var G=e=>{return{getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})}}},q=(L=(0,I.connect)(Y,G),L(P=class extends o.Component{constructor(e){super(e),this.convertToCascadeData=((e,t)=>{return e?e.map(e=>{return e.value=e[t.value],e.label=e[t.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e.children&&(e.children=this.convertToCascadeData(e.children,t)),e}):null}),this.loadCascaderData=((e,t)=>{var a=e[e.length-1];a.loading=!0;var l=t.valueRef;this.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:l.function,view:l.view}),fwParam:{distinct:l.distinct?l.distinct:null,queryColumns:l.value+","+l.label+(l.otherRefs?","+l.otherRefs:"")+(l.disableColumn?","+l.disableColumn:""),selectedTreeNodeId:e.map(e=>e[l.value]).join(","),selectedData:l.useCurrentData?this.getEditedNewData():null},callback:e=>{a.loading=!1,a.children=this.convertToCascadeData(e.data,l),this.setState({refData:this.state.refData})}})}),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,w.default)({},this.state.fwParam,{openerSelectedData:(0,w.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,w.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(O,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+(t.valueRef.otherRefs?","+t.valueRef.otherRefs:"")+(t.valueRef.disableColumn?","+t.valueRef.disableColumn:""),selectedTreeNodeId:e.props.eventKey,selectedData:t.valueRef.useCurrentData?this.getEditedNewData():null},callback:e=>{i.children=e.data,a.defaultOpen=!0,console.info(a.data),l(),this.setState({refData:this.state.refData})}}))})),this.onCascaderChange=((e,t,a)=>{if(console.info("onCascaderChange",e.id,t,a),"ADDRESS_SELECT"==e.id){var l=this.state,i=l.fwParam,o=l.formData,r=l.manualValues;i.newData||(i.newData={}),i.newData[e.id]=t.join(","),o[e.id]||(o[e.id]={}),o[e.id].value=t.join(","),r[e.id]=t,this.setState({fwParam:i,manualValues:r,formData:o})}}),this.onAutoCompleteSelect=((e,t,a)=>{console.info("onAutoCompleteSelect",e.id,t,a)}),this.onSelectChange=((e,t,a)=>{console.info("onSelectChange",e.id,t,a)}),this.onSelectSelect=((e,t,a)=>{console.info("onSelectSelect",e.id,t,a)}),this.MONEY_IDS={},this.getInputComponent=((e,t)=>{var a=this.state,l=a.components,i=a.refData,r=a.fwParam,s=a.formData,y=null,S={disabled:!e.editable,style:{width:"85%"}};t&&(S.value=this.state.manualValues[e.id]);var L="",P="";if(e.editable&&(L=e.prompt?e.prompt:"\u8bf7\u8f93\u5165",P=e.prompt?e.prompt:"\u8bf7\u9009\u62e9"),"label"==e.ui)y=this.getDisplayValue(e);else if("MEMO"===e.type)y=o.default.createElement(F,(0,g.default)({},S,{rows:4}));else if("checkbox01"===e.ui)y=o.default.createElement(C.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictList[e.dictionary]){var k=this.getLayout().dictList[e.dictionary];if("radio"==e.ui)y=o.default.createElement(j,(0,g.default)({name:e.id},S),k.map(e=>o.default.createElement(D.default,{key:e.value,value:String(e.value)},e.label)));else if("checkbox"==e.ui){var I=k;y=o.default.createElement(V,(0,g.default)({name:e.id},S,{options:I}))}else y=o.default.createElement(E.default,(0,g.default)({},S,{placeholder:P,showSearch:!0,mode:e.multiSelect?"multiple":null,optionFilterProp:"children",filterOption:(e,t)=>t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}),k.map(e=>o.default.createElement(N,{key:e.value,value:e.value},e.label)))}else if("TreeSelect"===e.ui&&e.valueRef){var R=e.valueRef;if(!i[e.id]){var T=null;R.function==this.props.fwParam.openerFunction&&R.view==this.props.fwParam.openerView&&this.props.treeData&&(T=this.props.treeData),i[e.id]={loading:!1,data:T,queryIndex:0,defaultOpen:!1}}var A=i[e.id];A.data||(A.data=[],this.props.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:R.function,view:R.view}),fwParam:{distinct:R.distinct?R.distinct:null,queryColumns:R.value+","+R.label+(R.otherRefs?","+R.otherRefs:"")+(R.disableColumn?","+R.disableColumn:""),selectedId:r&&r.newData&&r.newData[e.id]?r.newData[e.id]:null},callback:t=>{t.success?(A.data=t.data,A.loading=!1,i[e.id]=A,this.setState({refData:i})):A.data=null}})),y=o.default.createElement(p.default,(0,g.default)({},S,{placeholder:P,notFoundContent:A.loading?o.default.createElement(v.default,{size:"small"}):"\u65e0\u6570\u636e",showArrow:!0,showSearch:!0,searchPlaceholder:"\u8f93\u5165\u641c\u7d22",filterTreeNode:(e,t)=>{return console.info("treeNode",t),t.props.title.indexOf(e)>=0},treeNodeFilterProp:"title",filterOption:!1,loadData:t=>this.onTreeSelectLoadData(t,e,A),treeExpandedKeys:A.expandedKeys?A.expandedKeys:A.data.map(e=>String(e[R.value])),onTreeExpand:e=>{A.expandedKeys=e,A.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:A.defaultOpen,onSearch1:t=>{A.timeout&&(clearTimeout(A.timeout),A.timeout=null),A.currentValue=t;var a=()=>{console.info(t),A.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:R.function,view:R.view}),fwParam:{queryStr:t,distinct:R.distinct?R.distinct:null,queryColumns:R.value+","+R.label+(R.otherRefs?","+R.otherRefs:"")+(R.disableColumn?","+R.disableColumn:"")},callback:a=>{A.currentValue==t&&(A.data=a.data,A.loading=!1,A.defaultOpen=!0,s[e.id].value=t,this.setState({refData:i,fwParam:r,formData:s}))}})};A.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(A.data,R))}else if("Cascader"==e.ui&&e.valueRef){var _=e.valueRef;if(!i[e.id]){var O={};O[_.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),O[_.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var M=i[e.id];M.data||(M.data=[],this.props.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:_.function,view:_.view}),fwParam:{distinct:_.distinct?_.distinct:null,queryColumns:_.value+","+_.label+(_.otherRefs?","+_.otherRefs:"")+(_.disableColumn?","+_.disableColumn:""),selectedData:_.useCurrentData?this.getEditedNewData():null},callback:t=>{t.success?(M.data=this.convertToCascadeData(t.data,_),M.loading=!1,i[e.id]=M,this.setState({refData:i})):M.data=null}})),y=o.default.createElement(m.default,(0,g.default)({},S,{placeholder:P,options:M.data,loadData:t=>this.loadCascaderData(t,e),onChange:(t,a)=>this.onCascaderChange(e,t,a),showSearch:{filter:(e,t)=>{return t.some(t=>t.label.toLowerCase().indexOf(e.toLowerCase())>-1)}}}))}else if("AutoComplete"==e.ui&&e.valueRef){var x=e.valueRef;i[e.id]||(i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i}));var z=i[e.id];y=o.default.createElement(h.default,(0,g.default)({},S,{placeholder:L,dataSource:z.data,defaultOpen:z.defaultOpen,onSelect:(t,a)=>this.onAutoCompleteSelect(e,t,a),onSearch:e=>{z.timeout&&(clearTimeout(z.timeout),z.timeout=null),z.currentValue=e;var t=()=>{z.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:x.function,view:x.view}),fwParam:(0,w.default)({},this.state.fwParam,{queryValue:e,distinct:x.distinct?x.distinct:null,queryColumns:x.value+","+x.label+(x.otherRefs?","+x.otherRefs:"")+(x.disableColumn?","+x.disableColumn:""),selectedData:x.useCurrentData?this.getEditedNewData():null}),callback:t=>{if(z.currentValue==e){var a={};t.success&&t.data.map(e=>{a[e[x.label]]=e}),z.dataMap=a,z.data=Object.keys(a),z.loading=!1,z.defaultOpen=!0,z.autoFocus=!0,this.setState({refData:i,fwParam:r})}}})};z.timeout=setTimeout(t,900)}}))}else if(null!=e.valueRef){var Y=e.valueRef;if(!i[e.id]){var G={};G[Y.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),G[Y.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var q=i[e.id];q.data||(q.data=[],this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:Y.function,view:Y.view}),fwParam:{distinct:Y.distinct?Y.distinct:null,queryColumns:Y.value+","+Y.label+(Y.otherRefs?","+Y.otherRefs:"")+(Y.disableColumn?","+Y.disableColumn:""),selectedData:Y.useCurrentData?this.getEditedNewData():null},callback:t=>{var a,l=[],o={};(t.success&&(l=t.data,l&&l.map(e=>o[e[Y.value]]=e)),e.showColumn)&&function(){var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],i=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],o=null;if(i.length>0&&t.length==i.length)for(a=0;a<i.length;++a)l.some(e=>e[Y.value]==i[a])||(o={},o[Y.value]=i[a],o[Y.label]=t[a],l.push(o))}();q.data=l,q.dataMap=o,q.loading=!1,i[e.id]=q,this.setState({refData:i,formData:s})}}));var U=q.data.map(e=>o.default.createElement(N,{key:e[Y.value],disabled:Y.disableColumn&&e[Y.disableColumn]==Y.disableValue},e[Y.label],Y.otherRefs?Y.otherRefs.split(",").map(t=>{e[t]}):""));y=o.default.createElement(E.default,(0,g.default)({},S,{placeholder:P,showSearch:!0,mode:e.multiSelect?"multiple":null,notFoundContent:q.loading?o.default.createElement(v.default,{size:"small"}):"\u65e0\u6570\u636e",showArrow:!0,filterOption:!1,labelInValue:!0,autoFocus:q.autoFocus,defaultOpen:q.defaultOpen,onSelect:(t,a)=>this.onSelectSelect(e,t,a),onChange:(t,a)=>this.onSelectChange(e,t,a),onSearch:t=>{q.timeout&&(clearTimeout(q.timeout),q.timeout=null),q.currentValue=t;var a=()=>{q.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:Y.function,view:Y.view}),fwParam:{queryValue:t,distinct:Y.distinct?Y.distinct:null,queryColumns:Y.value+","+Y.label+(Y.otherRefs?","+Y.otherRefs:"")+(Y.disableColumn?","+Y.disableColumn:""),selectedData:Y.useCurrentData?this.getEditedNewData():null},callback:a=>{if(q.currentValue==t){var l,o=[],r={};if(a.success&&(o=a.data,o&&o.map(e=>r[e[Y.value]]=e)),e.showColumn)(function(){var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],a=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],i=null;if(a.length>0&&t.length==a.length)for(l=0;l<a.length;++l)o.some(e=>e[Y.value]==a[l])||(i={},i[Y.value]=a[l],i[Y.label]=t[l],o.push(i))})();q.data=o,q.dataMap=r,q.loading=!1,q.defaultOpen=!0,q.autoFocus=!0,this.setState({refData:i})}}})};q.timeout=setTimeout(a,500)}}),U)}else if("DatePicker"===e.ui){var B=()=>!1;B=(t=>{var a=!1;return e.min&&t&&t<this.getRealDate(e.min).startOf("day")&&(a=!0),a||e.max&&t&&t>this.getRealDate(e.max).endOf("day")&&(a=!0),a}),y=o.default.createElement(f.default,(0,g.default)({},S,{disabledDate:e=>B(e),placeholder:P}))}else if("TimePicker"===e.ui)y=o.default.createElement(c.default,S);else if("InputNumber"===e.ui)y=o.default.createElement(u.default,(0,g.default)({},S,{placeholder:L}));else if("Upload"===e.ui){var K=(0,w.default)({},this.getFwCoord(),{view:"create"}),W={openerActionId:e.id,openerFunction:this.getFwCoord()["function"],openerView:this.getFwCoord().view,oldData:{},newData:{},saveType:"checkonly"},H=this.objectToFormInputs({fwCoord:K,fwParam:W},null,null),X={name:e.id+"_importFile",action:"/fw/importData?fwCoord.project="+this.getFwCoord().project+"&",data:H,onChange(t){if(this.view.setState({loading:!0}),t.file.status,"done"===t.file.status){var a=t.file.response;this.view.setState({uploadedFile:t.file.name,uploadResult:null,loading:!1}),a.success?(r.connectFilePath=a.connectFilePath,this.view.setState({fwParam:r}),d.default.info("\u6587\u4ef6\u6821\u9a8c\u901a\u8fc7")):a.connectFilePath?this.view.setState({uploadResult:o.default.createElement("span",{dangerouslySetInnerHTML:{__html:'<font color="#ff0000"><a href="/fw/download?fileName='+a.connectFilePath+'" target="_blank">\u4e0a\u4f20\u6587\u4ef6\u6709\u8bef\uff0c\u70b9\u6b64\u4e0b\u8f7d\u660e\u7ec6</a></font>'}})}):a.errorMsg&&d.default.error(a.errorMsg,10)}else"error"===t.file.status&&(this.view.setState({loading:!1}),d.default.error(`${e.label}\u5bfc\u5165\u9519\u8bef`,10))}};X.view=this;var Z=this.state.uploadedFile?this.state.uploadedFile:this.state.uploadShowLabel[e.id]?this.state.uploadShowLabel[e.id]:null;y=o.default.createElement(n.default,(0,g.default)({},S,X,{showUploadList:!1,style:{marginLeft:10}}),o.default.createElement("a",{href:"javascript:;"},Z||"\u70b9\u51fb\u4e0a\u4f20"))}else"MAP"==e.ui?(console.info("col.ui",e.ui),y=o.default.createElement(b.default,(0,g.default)({},S,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn;return y||(y=o.default.createElement(b.default,(0,g.default)({},S,{type:e.ui?e.ui:"text",placeholder:L}))),l[e.id]=y,y}),this.getRealDate=(e=>{if(0==e.indexOf("{today")&&e.indexOf("}")==e.length-1){var t=String(e).substring(6,e.length-1);return(0,_.default)().add(parseInt(t),"days")}return"today"==e?(0,_.default)():(0,_.default)(e)}),this.clearUpload=(e=>{var t=this.state,a=t.uploadShowLabel,l=t.formData;delete a[e.id],l[e.id]&&(l[e.id].value=null,l[e.id].dirty=!0),this.setState({uploadedFile:null,uploadShowLabel:a,formData:l})}),this.normFile=(e=>{return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.file&&e.file.response?e.file.response.success?e&&e.fileList:null:e&&e.fileList}),this.objectToFormInputs=function(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>this.objectToFormInputs(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]).replace(/%/g,"%25").replace(/\&/g,"%26").replace(/\+/g,"%2B").replace(/\=/g,"%3D"):this.objectToFormInputs(e[o],i,l)}return i},this.selectPointInMap=(e=>{var t=this.state.formData,a=this.getLayout().columnMap[e],l=a.showColumn.split(",");console.info("param",l,t),this.state.map.selectPoint({id:e,lat:t[l[0]]?t[l[0]].value:36,lng:t[l[1]]?t[l[1]].value:120,name:a.label,callback:(e,a,i,o,r)=>{console.info("callback",r,r.onlineStr),t[e]||(t[e]={}),t[l[0]]||(t[l[0]]={}),t[l[1]]||(t[l[1]]={}),t[e].value=r.onlineStr,t[l[0]].value=a,t[l[1]].value=i,console.info("newParam",a,i,t),this.setState({formData:t})}})}),this.handleFormChange=(e=>{if(e){var t=this.state,a=t.fwParam,l=(t.formData,this.state.insuranceData);a.newData||(a.newData={}),Object.keys(e).map(t=>{var a=e[t],i=this.getLayout().columnMap[t],o=0,r=null,s=null;void 0==i&&(r=t.split("?"),i=this.getLayout().columnMap[r[0]],r.length>1&&(o=r[1],s=l[o]));var n=i.ui,d=null;if(a&&null!=a.value)if(this.state.formData[t]||(this.state.formData[t]={}),d=a.value,"PARENT_PROXY"!=t&&"TYPE"!=t||(Object.keys(this.state.refData).map(e=>e.indexOf("INS_TEMPLATE_ID")>=0?delete this.state.refData[e]:null),l=[{}]),"DatePicker"===n)d=a.value.format(i.pattern?i.pattern:"YYYY-MM-DD");else if("TimePicker"===n)d=a.value.format(i.pattern?i.pattern:"HH:mm:ss");else if("checkbox01"===n)d=a.value?"1":"0";else if(i.dictionary)i.ui,Array.isArray(a.value)&&(d=a.value.join(","));else if("Cascader"==i.ui)Array.isArray(a.value)&&(d=a.value.join(","),console.info("Cascader",a.value,d));else if("AutoComplete"==i.ui)d=a.value;else if(i.valueRef&&"TreeSelect"!=i.ui){if(d=Array.isArray(a.value)?a.value.filter(e=>e&&e.key).map(e=>e.key).join(","):a.value.key?a.value.key:null,i.showColumn){var u=this.getLayout().columnMap[i.showColumn.split(",")[0]];if(u){var c=Object.values(a.value).map(e=>Array.isArray(e.label)?e.label[0]:e.label).join(",");this.state.formData[u.id]||(this.state.formData[u.id]={}),this.state.formData[u.id].value=c}}}else"Upload"===i.ui?(console.info("upload",d),Array.isArray(d)&&(d=d[0].name)):"MAP"==i.ui?(d=this.state.formData[t].value,a.dirty=!0):("string"==typeof d&&(d=d.trim(!0),i.size>0&&d.length>i.size&&(d=d.substr(0,i.size))),"NUM"==i.type&&("number"!==typeof d&&(d=new String(d).split("").filter(e=>!R.isEmpty(e)).filter((e,t,a)=>0==t&&"-"==e||"."==e&&a.filter((e,a)=>a<t).every(e=>"."!=e)||R.isNumber(e)).join("")),void 0!=i.min&&null!=i.min&&(null==d||d<i.min)&&(d=i.min),void 0!=i.max&&null!=i.max?d>i.max&&(d=i.max):i.size&&d>Math.pow(10,i.size)-1&&(d=Math.pow(10,i.size)-1)));a.value=d,null!=s&&(s[i.id]=d)}),this.setState({formData:(0,w.default)({},this.state.formData,e),fwParam:a,insuranceData:l})}}),this.doOtherInputValidate=(()=>{var e={},t=this.state.insuranceData;return t.map((t,a,l)=>{a>0&&l.filter((e,t)=>t<a).some(e=>e.INS_TEMPLATE_ID==t.INS_TEMPLATE_ID)&&(e["INS_TEMPLATE_ID?"+a]="\u6bcf\u4e2a\u4fdd\u5355\u53ea\u80fd\u6dfb\u52a0\u4e00\u6761\u8bb0\u5f55")}),Object.keys(e).length>0?e:null}),this.getEditedNewData=(()=>{var e=(0,w.default)({},this.props.selectedData,this.state.fwParam.newData);return Object.keys(this.state.formData).map(t=>e[t]=this.state.formData[t].value),this.processNewData&&this.processNewData(e),e}),this.processNewData=(e=>{e.insuranceData=this.state.insuranceData}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],r=i;if(e.onFormat)r=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var s=this.getLayout().dictMap[e.dictionary][i];r=s||i}else e.showColumn&&(r=e.showColumn.split(",").map(e=>t[e]).join(" "));return o.default.createElement("span",null,r)}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,w.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return T.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.addInsurance=function(){var e=this.state.insuranceData;e.push({}),this.setState({insuranceData:e})},this.deleteInsurance=function(e){var t=this.state.insuranceData;1!=t.length&&x({title:"\u786e\u8ba4\u8981\u5220\u9664\u5417?",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk:()=>{e<t.length&&(t.splice(e,1),this.setState({insuranceData:t}))},onCancel(){console.log("Cancel")}})},this.FIX_WIDTH={},this.CustomizedForm=S.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t=(e,t)=>{if(e&&null!=e.value)if("DatePicker"===t.ui)e.value=e.value?(0,_.default)(e.value,t.pattern?t.pattern:"YYYY-MM-DD"):e.value;else if("TimePicker"===t.ui)e.value=e.value?(0,_.default)(e.value,t.pattern?t.pattern:"HH:mm:ss"):e.value;else if("checkbox01"===t.ui)e.value="1"==e.value;else if(t.dictionary)"checkbox"==t.ui?Array.isArray(e.value)||(e.value=String(e.value).split(",")):t.multiSelect?e.value?e.value=String(e.value).split(","):e.value=null:e.value=String(e.value);else if("Cascader"==t.ui)e.value=String(e.value).split(",");else if("AutoComplete"==t.ui);else if(t.valueRef&&"TreeSelect"!=t.ui){if(Array.isArray(e.value)||(e.value?e.value=String(e.value).split(",").map(e=>({key:e})):e.value=[]),Array.isArray(e.value)&&t.showColumn){var a=this.state.formData[t.showColumn.split(",")[0]];a&&a.value&&a.value.split(",").map((t,a)=>e.value.length>a?e.value[a].label=t:null)}}else"MAP"==t.ui?e.value=e.value.split("\u3001").join(""):"NUM"!=t.type||t.dictionary?e.value=String(e.value):(""===e.value&&(e.value=null),e.value);(void 0===e.value||null===e.value||""===e.value||Array.isArray(e.value)&&0==e.value.length)&&delete e.value},a={};this.getLayout().columns.filter(e=>e.visible).map(e=>{var l=(0,w.default)({},this.state.formData[e.id]);t(l,e),a[e.id]=S.default.createFormField((0,w.default)({},l))});var l=this.state.insuranceData;return this.getLayout().columns.filter(e=>e.visible&&"insurance"==e.group).map(e=>{l.map((l,i)=>{var o=(0,w.default)({},this.state.formData[e.id+"?"+i],{value:l[e.id]});t(o,e),a[e.id+"?"+i]=S.default.createFormField((0,w.default)({},o))})}),a},onValuesChange(e,t){}})(e=>{this.state.form=e.form;var t=e.form.getFieldDecorator,l=this.getLayout().columns.filter(e=>e.visible),i={_default:[]},n={};this.getLayout().columnGroups&&this.getLayout().columnGroups.map(e=>n[e.id]=e),l.map(e=>{var t="_default";e.group&&n[e.group]&&(t=e.group),i[t]||(i[t]=[]),i[t].push(e)});var d=(e,i,r)=>e?e.map(e=>{var n=[],d=this.state.formData,u=e.id;void 0!=r&&(u=u+"?"+r),["PARENT_PROXY"].some(e=>e==u)&&(e.required=d["TYPE"]&&"2"==d["TYPE"].value,e.editable=e.required,e.required||d[u]&&d[u].errors&&(delete d[u].errors,this.setState({formData:d}))),"insurance"==e.group&&(e.required=!0);var c=!1;if(e.editable&&(n.push({required:e.required,message:"\u8bf7\u8f93\u5165"+e.label}),"NUM"==e.type?e.dictionary||e.valueRef||(c=!0,e.max||e.size,e.min):e.dictionary||e.valueRef||"DatePicker"==e.ui||(c=!0,e.size)),e.onValidate&&this.getLayout().clientLogicMap[e.onValidate]){var f=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onValidate].file}`);n.push({validator:(t,a,l)=>{var i=[];a&&!f.validate(a,this.state.fwParam.newData,0,e,this)&&i.push(new Error(f.errorMsg(a,this.state.fwParam.newData,0,e,this))),l(i)}})}var h={valuePropName:"value",rules:n};return c&&(h.validateTrigger="onBlur"),"checkbox01"==e.ui?h.valuePropName="checked":"Upload"==e.ui&&(h.getValueFromEvent=this.normFile),o.default.createElement(s.default,{span:"insurance"==i?u.indexOf("INS_TEMPLATE_ID")>=0?24:8:l.length>=4||l.some(e=>"MAP"==e.ui)?12:24,key:u},o.default.createElement(M,(0,g.default)({},z,{label:e.label}),t(u,h)(this.getInputComponent(e)),this.state.insuranceData.length>1&&u.indexOf("INS_TEMPLATE_ID")>=0?o.default.createElement("a",{style:{color:"red"},onClick:()=>this.deleteInsurance(r)},"\xa0\u5220\u9664"):e.tail?" "+e.tail:null))}):[],u=[];return Object.keys(i).length>1?["_default",...this.getLayout().columnGroups.map(e=>e.id)].map(e=>{n[e]&&i[e]&&i[e].length>0&&u.push(o.default.createElement(s.default,{span:24,key:"group_"+e,style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,n[e].title),"\xa0","insurance"==e?o.default.createElement("a",{onClick:()=>this.addInsurance()},"\u6dfb\u52a0\u4fdd\u5355"):null)),"insurance"==e?this.state.insuranceData.map((t,a)=>{u=[...u,...d(i[e],e,a)]}):u=[...u,...d(i[e],e)]}):u=d(l,null),l.some(e=>"Upload"==e.ui)&&u.push(o.default.createElement(s.default,{key:"FW_uploadPrompt",span:24,style:{height:60,textAlign:"center"}},this.state.uploadResult)),o.default.createElement(S.default,null,o.default.createElement(r.default,{gutter:1},u))}),this.state=(0,w.default)({},e,{loading:!1,dialogs:{},form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{},uploadedFile:null,uploadResult:null,uploadShowLabel:{},manualValues:{},insuranceData:[{}]})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData,l=e.uploadShowLabel;t.newData=(0,w.default)({},this.props.initData),t.oldData=(0,w.default)({},this.props.initData),Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.getLayout().columns.filter(e=>"Upload"==e.ui).map(e=>l[e.id]=this.props.initData[e.id]),this.setState({fwParam:this.state.fwParam,formData:a,refData:{},uploadShowLabel:l,insuranceData:this.props.initData.insuranceData},()=>{this.getLayout().columns.filter(e=>"MAP"==e.ui).map(e=>this.selectPointInMap(e.id))})}else if(this.props.showAsDialog){var i=(0,w.default)({},this.state.fwParam,{oldData:{},newData:{},selectedData:this.props.selectedData});this.props.getEditData({fwCoord:this.getFwCoord(),fwParam:i,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData,i=e["_FW_DYNAMIC_LAYOUT"];delete e["_FW_DYNAMIC_LAYOUT"],i&&i.columns&&i.columns.map(e=>{var t=this.getLayout().columnMap[e.id];t&&Object.keys(e).map(a=>t[a]=e[a])}),a.newData=(0,w.default)({},e),a.oldData=(0,w.default)({},e),Object.keys(e).map(t=>l[t]={value:e[t]}),this.setState({fwParam:this.state.fwParam,formData:l,refData:{},insuranceData:e.insuranceData})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null)}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.CustomizedForm;return o.default.createElement("div",null,o.default.createElement(v.default,{spinning:this.props.loading||this.state.loading},o.default.createElement(e,{onChange:this.handleFormChange}),this.getLayout().columns.some(e=>e.visible&&"MAP"==e.ui)?o.default.createElement(A.Map,{height:"50vh",showQueryControl:!0,onRef:e=>this.setState({map:e})}):null),Object.values(this.state.dialogs))}})||P);t.default=q},CxPR:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=u,t.logic=c,t.handleOk=f,t.handleCancel=h;var o=i(a("q1tI"));a("Pwec");var r=i(a("CtXQ"));a("2qtc");var s=i(a("kLXV")),n=(l(a("uYVn")),i(a("wd/R")));a("XDpg"),n.default.locale("zh-cn");var d=s.default.confirm;function u(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(r.default,{type:this.action.icon}),this.action.label," "))}function c(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,d({title:"\u786e\u5b9a\u53d6\u6d88\u6b64\u6b21\u7f16\u8f91?",okText:"\u786e\u5b9a\u53d6\u6d88",okType:"danger",cancelText:"\u4e0d\u53d6\u6d88",onOk:()=>this.handleOk(),onCancel(){console.log("Cancel")}})}function f(e){this.view.props.closeMainTab&&this.view.props.closeMainTab()}function h(e){var t=this.dialog.state.dialogs;delete t[this.id],this.dialog.setState({dialogs:t})}},E6qp:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("14J3");var r=i(a("BMrR"));a("jCWc");var s=i(a("kPKH"));a("5Dmo");var n=i(a("3S7+"));a("giR+");var d=i(a("fyUT"));a("Xi6J");var u=i(a("kl6h"));a("iQDF");var c=i(a("+eQT"));a("nRaC");var f=i(a("5RzL"));a("T2oS");var h=i(a("W9HT"));a("sRBo");var m=i(a("kaz8")),p=i(a("pVnL")),v=i(a("MVZn"));a("7Kak");var g=i(a("9yH6"));a("OaEy");var w=i(a("2fM7"));a("5NDa");var y=i(a("5rEg"));a("y8nQ");var C=i(a("Vl3Y"));a("ozfa");var D,E,b=i(a("MJZm")),S=a("MuoO"),L=(i(a("QCDS")),l(a("dNXO"))),P=i(a("wd/R"));a("XDpg"),P.default.locale("zh-cn");var k=b.default.TreeNode,I=C.default.Item,R=y.default.TextArea,T=w.default.Option,A=g.default.Group,_={labelCol:{xs:{span:8},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16}}};function O(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.edit,dispatch:a,fwCoord:l,layout:i}}var M=e=>{return{getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})}}},F=(D=(0,S.connect)(O,M),D(E=class extends o.Component{constructor(e){super(e),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,v.default)({},this.state.fwParam,{openerSelectedData:(0,v.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,v.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(k,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+","+(t.valueRef.otherRefs?t.valueRef.otherRefs:""),selectedTreeNodeId:e.props.eventKey},callback:e=>{i.children=e.data,a.defaultOpen=!0,console.info(a.data),l(),this.setState({refData:this.state.refData})}}))})),this.getInputComponent=(e=>{var t=this.state,a=t.components,l=t.refData,i=t.fwParam,r=t.formData,s=null,n={disabled:!e.editable,style:{width:"90%"}};if("MEMO"===e.type&&(s=o.default.createElement(R,(0,p.default)({},n,{rows:4}))),"checkbox01"===e.ui)s=o.default.createElement(m.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictMap[e.dictionary]){var C=this.getLayout().dictMap[e.dictionary];s="radio"==e.ui?o.default.createElement(A,(0,p.default)({name:e.id},n),Object.keys(C).map(e=>o.default.createElement(g.default,{key:e,value:e},C[e]))):o.default.createElement(w.default,n,Object.keys(C).map(e=>o.default.createElement(T,{key:e,value:e},C[e])))}else if("TreeSelect"===e.ui&&e.valueRef){var D=e.valueRef;if(!l[e.id]){var E=null;D.function==this.props.fwParam.openerFunction&&D.view==this.props.fwParam.openerView&&this.props.treeData&&(E=this.props.treeData),l[e.id]={loading:!1,data:E,queryIndex:0,defaultOpen:!1}}var b=l[e.id];b.data||(console.info("before remote call"),b.data=[],this.props.getTreeData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:D.function,view:D.view}),fwParam:{distinct:D.distinct?D.distinct:null,queryColumns:D.value+","+D.label+","+(D.otherRefs?D.otherRefs:"")},callback:t=>{t.success?(b.data=t.data,console.info("result.data",b.data),b.loading=!1,l[e.id]=b,this.setState({refData:l})):b.data=null}})),console.info("before render ",b.data),s=o.default.createElement(f.default,(0,p.default)({},n,{placeholder:e.prompt?e.prompt:"\u8bf7\u9009\u62e9",notFoundContent:b.loading?o.default.createElement(h.default,{size:"small"}):null,showArrow:!0,filterOption:!1,loadData:t=>this.onTreeSelectLoadData(t,e,b),treeExpandedKeys:b.expandedKeys?b.expandedKeys:b.data.map(e=>String(e[D.value])),onTreeExpand:e=>{b.expandedKeys=e,b.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:b.defaultOpen,onSearch1:t=>{b.timeout&&(clearTimeout(b.timeout),b.timeout=null),b.currentValue=t;var a=()=>{console.info(t),b.loading=!0,this.props.getRefData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:D.function,view:D.view}),fwParam:{queryStr:t,distinct:D.distinct?D.distinct:null,queryColumns:D.value+","+D.label+","+(D.otherRefs?D.otherRefs:"")},callback:a=>{b.currentValue==t&&(b.data=a.data,b.loading=!1,b.defaultOpen=!0,r[e.id].value=t,this.setState({refData:l,fwParam:i,formData:r}))}})};b.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(b.data,D))}else if(null!=e.valueRef){var S=e.valueRef;if(!l[e.id]){console.info(i.newData);var L={};L[S.value]=r[e.id]?r[e.id].value:0,e.showColumn&&r[e.showColumn]&&(console.info("showcolumn",e.showColumn,r),L[S.label]=r[e.showColumn].value),l[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:l})}var P=l[e.id];P.data||(console.info("before remote call"),P.data=[],this.props.getRefData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:S.function,view:S.view}),fwParam:{distinct:S.distinct?S.distinct:null,queryColumns:S.value+","+S.label+","+(S.otherRefs?S.otherRefs:"")},callback:t=>{var a,i=[];(t.success&&(i=t.data),e.showColumn)&&function(){console.info("showColumn",r[e.showColumn],r[e.id]);var t=r[e.showColumn]&&r[e.showColumn].value?r[e.showColumn].value.split(","):[],l=r[e.id]&&r[e.id].value?r[e.id].value.split(","):[],o=null;if(l.length>0&&t.length==l.length)for(a=0;a<l.length;++a)i.filter(e=>e[S.value]==l[a])||(o={},o[S.value]=l[a],o[S.label]=t[a],i.push(o))}();console.info("this.state.fwParam.newData",this.state.fwParam.newData),P.data=i,P.loading=!1,l[e.id]=P,this.setState({refData:l,formData:r})}}));var k=P.data.map(e=>o.default.createElement(T,{key:e[S.value]},e[S.label],S.otherRefs?S.otherRefs.split(",").map(t=>{e[t]}):""));s=o.default.createElement(w.default,(0,p.default)({},n,{showSearch:!0,placeholder:e.prompt,mode:e.multiSelect?"multiple":null,notFoundContent:P.loading?o.default.createElement(h.default,{size:"small"}):null,showArrow:!0,filterOption:!1,labelInValue:!0,autoFocus:P.autoFocus,defaultOpen:P.defaultOpen,onBlur:()=>console.info("blur"),onSearch:t=>{P.timeout&&(clearTimeout(P.timeout),P.timeout=null),P.currentValue=t;var a=()=>{P.loading=!0,this.props.getRefData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:S.function,view:S.view}),fwParam:{queryValue:t,distinct:S.distinct?S.distinct:null,queryColumns:S.value+","+S.label+","+(S.otherRefs?S.otherRefs:"")},callback:a=>{if(P.currentValue==t){var o,s=[];if(a.success&&(s=a.data),e.showColumn)(function(){var t=r[e.showColumn]&&r[e.showColumn].value?r[e.showColumn].value.split(","):[],a=r[e.id]&&r[e.id]?String(r[e.id].value).split(","):[],l=null;if(a.length>0&&t.length==a.length)for(o=0;o<a.length;++o)s.filter(e=>e[S.value]==a[o])||(l={},l[S.value]=a[o],l[S.label]=t[o],s.push(l))})();console.info("this.state.fwParam.newData2",this.state.fwParam.newData),P.data=s,P.loading=!1,P.defaultOpen=!0,P.autoFocus=!0,this.setState({refData:l,fwParam:i})}}})};P.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange"),console.info(e)}}),k)}else{if("DatePicker"===e.ui)return o.default.createElement(c.default,n);if("TimePicker"===e.ui)return o.default.createElement(u.default,n);if("InputNumber"===e.ui)return o.default.createElement(d.default,n);"Upload"===e.ui||("MAP"==e.ui?(console.info("col.ui",e.ui),s=o.default.createElement(y.default,(0,p.default)({},n,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn)}return s||(s=o.default.createElement(y.default,(0,p.default)({},n,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u8f93\u5165"}))),a[e.id]=s,s}),this.handleFormChange=(e=>{e&&(Object.keys(e).map(t=>{var a=e[t],l=this.getLayout().columnMap[t],i=l.ui,o=null;if(a&&null!=a.value)if(this.state.formData[t]||(this.state.formData[t]={}),o=a.value,"DatePicker"===i)o=a.value.format(l.pattern?l.pattern:"YYYY-MM-DD");else if("TimePicker"===i)o=a.value.format(l.pattern?l.pattern:"HH:mm:ss");else if("checkbox01"===i)o=a.value?"1":"0";else if(l.valueRef&&"TreeSelect"!=l.ui){if(o=a.value.filter(e=>e&&e.key).map(e=>e.key).join(","),l.showColumn){var r=this.getLayout().columnMap[l.showColumn.split(",")[0]];if(r){var s=a.value.map(e=>Array.isArray(e.label)?e.label[0]:e.label).join(",");this.state.formData[r.id]||(this.state.formData[r.id]={}),this.state.formData[r.id].value=s}}}else"MAP"==l.ui&&(o=this.state.formData[t].value,a.dirty=!0);a.value=o}),this.setState({formData:(0,v.default)({},this.state.formData,e)}))}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],r=i;if(e.onFormat)r=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var s=this.getLayout().dictMap[e.dictionary][i];r=s||i}else e.showColumn&&(r=e.showColumn.split(",").map(e=>t[e]).join(" "));return r&&String(r).length>20?o.default.createElement(n.default,{title:r},String(r).substr(0,17),"..."):r}),this.getLayout=(()=>{return this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,v.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return L.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.CustomizedForm=C.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t={};return this.getLayout().columns.filter(e=>e.visible).map(e=>{var a=(0,v.default)({},this.state.formData[e.id]);if(a&&null!=a.value)if("DatePicker"===e.ui)a.value=a.value?(0,P.default)(a.value,e.pattern?e.pattern:"YYYY-MM-DD"):a.value;else if("TimePicker"===e.ui)a.value=a.value?(0,P.default)(a.value,e.pattern?e.pattern:"HH:mm:ss"):a.value;else if("checkbox01"===e.ui)a.value="1"==a.value;else if(e.valueRef&&"TreeSelect"!=e.ui){if(Array.isArray(a.value)||(a.value?a.value=String(a.value).split(",").map(e=>({key:e})):a.value=[]),e.showColumn){var l=this.state.formData[e.showColumn.split(",")[0]];l&&l.value&&l.value.split(",").map((e,t)=>a.value.length>t?a.value[t].label=e:null)}}else"MAP"==e.ui||("NUM"!=e.type||e.dictionary?a.value=String(a.value):e.decimalSize>0?a.value=parseFloat(a.value):a.value=parseInt(a.value));t[e.id]=C.default.createFormField((0,v.default)({},a))}),t},onValuesChange(e,t){}})(e=>{this.state.form=e.form;e.form.getFieldDecorator;var t=this.getLayout().columns.filter(e=>e.visible),a={_default:[]},l={};this.getLayout().columnGroups&&this.getLayout().columnGroups.map(e=>l[e.id]=e),t.map(e=>{var t="_default";e.group&&l[e.group]&&(t=e.group),a[t]||(a[t]=[]),a[t].push(e)});var i=e=>e?e.map(e=>{return o.default.createElement(s.default,{span:t.length>5?12:24,key:e.id,style:{height:24}},o.default.createElement(I,(0,p.default)({},_,{label:e.label}),this.getDisplayValue(e)," ",e.tail))}):[],n=[];return Object.keys(a).length>1?["_default",...this.getLayout().columnGroups.map(e=>e.id)].map(e=>{l[e]&&a[e]&&a[e].length>0&&n.push(o.default.createElement(s.default,{span:24,key:"group_"+e,style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,l[e].title))),n=[...n,...i(a[e])]}):n=i(t),o.default.createElement(C.default,null,o.default.createElement(r.default,{gutter:1},n))}),this.state=(0,v.default)({},e,{form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{}})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData;t.newData=(0,v.default)({},this.props.initData),t.oldData=(0,v.default)({},this.props.initData),Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.setState({fwParam:this.state.fwParam,formData:a,refData:{}})}else if(this.props.showAsDialog){var l=(0,v.default)({},this.state.fwParam,{oldData:{},newData:{},selectedData:this.props.selectedData});this.props.getEditData({fwCoord:this.getFwCoord(),fwParam:l,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData;a.newData=(0,v.default)({},e),a.oldData=(0,v.default)({},e),Object.keys(e).map(t=>l[t]={value:e[t]}),this.setState({fwParam:this.state.fwParam,formData:l,refData:{}})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null)}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.CustomizedForm;return o.default.createElement("div",null,o.default.createElement(h.default,{spinning:this.props.loading},o.default.createElement(e,{onChange:this.handleFormChange})))}})||E);t.default=F},FsLl:function(e,t,a){e.exports={"ant-advanced-search-form":"ant-advanced-search-form___zj4T5","ant-form-item":"ant-form-item___Y4ZI4","ant-form-item-control-wrapper":"ant-form-item-control-wrapper___1XNeO","ant-tree-node-content-wrapper":"ant-tree-node-content-wrapper___36P3u",queryValue:"queryValue___37LGN"}},GfkI:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=u,t.logic=c,t.handleOk=f,t.handleCancel=h;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr")),s=i(a("MVZn"));a("Pwec");var n=i(a("CtXQ")),d=l(a("uYVn"));function u(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(n.default,{type:this.action.icon}),this.action.label," "))}function c(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i;var o=this.view.state.form,n=this.view.state.formData;o.validateFieldsAndScroll((e,t)=>{if(e)console.info("error",e);else{if(this.view.doOtherInputValidate){var a=this.view.doOtherInputValidate();if(a){if(Array.isArray(a)){var l={};Object.keys(a).map(e=>{var t=n[e];l[e]=(0,s.default)({},t,{errors:[new Error(a[e])]})}),o.setFields(l)}else r.default.error(a);return}}var i=this.view.state.fwParam.newData;Object.keys(n).map(e=>i[e]=n[e].value);var u=(0,s.default)({},this.view.state.fwParam,{oldData:{},newData:i});console.info("final formData:",JSON.stringify(n)),this.view.props.saveCreateData({fwCoord:this.view.getFwCoord(),fwParam:u,callback:e=>{if(e.success)d.isEmpty(e.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(e.errorMsg,10),this.view.refresh();else{if(e.validResultMap){var a={};Object.keys(e.validResultMap).map(l=>{a[l]={value:t[l],errors:[new Error(e.validResultMap[l])]}}),o.setFields(a)}d.isEmpty(e.errorMsg)||r.default.error(e.errorMsg,10)}}})}})}function f(e){}function h(e){}},H08f:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("14J3");var r=i(a("BMrR"));a("jCWc");var s=i(a("kPKH"));a("pC0b");var n=i(a("GzdX"));a("giR+");var d=i(a("fyUT"));a("Xi6J");var u=i(a("kl6h"));a("iQDF");var c=i(a("+eQT"));a("nRaC");var f=i(a("5RzL"));a("T2oS");var h=i(a("W9HT"));a("sRBo");var m=i(a("kaz8")),p=i(a("pVnL")),v=i(a("MVZn"));a("7Kak");var g=i(a("9yH6"));a("OaEy");var w=i(a("2fM7"));a("5NDa");var y=i(a("5rEg"));a("y8nQ");var C=i(a("Vl3Y"));a("ozfa");var D=i(a("MJZm")),E=a("MuoO"),b=(i(a("QCDS")),l(a("dNXO"))),S=i(a("wd/R"));a("XDpg");var L,P,k=i(a("DQt+"));S.default.locale("zh-cn");var I=D.default.TreeNode,R=(C.default.Item,y.default.TextArea),T=w.default.Option,A=g.default.Group;function _(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.edit,dispatch:a,fwCoord:l,layout:i}}var O=e=>{return{getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})}}},M=(L=(0,E.connect)(_,O),L(P=class extends o.Component{constructor(e){super(e),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,v.default)({},this.state.fwParam,{openerSelectedData:(0,v.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,v.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(I,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+","+(t.valueRef.otherRefs?t.valueRef.otherRefs:""),selectedTreeNodeId:e.props.eventKey},callback:e=>{i.children=e.data,a.defaultOpen=!0,console.info(a.data),l(),this.setState({refData:this.state.refData})}}))})),this.getInputComponent=(e=>{var t=this.state,a=t.components,l=t.refData,i=t.fwParam,r=t.formData,s=null,n={disabled:!e.editable,style:{width:"90%"}};if("MEMO"===e.type&&(s=o.default.createElement(R,(0,p.default)({},n,{rows:4}))),"checkbox01"===e.ui)s=o.default.createElement(m.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictMap[e.dictionary]){var C=this.getLayout().dictMap[e.dictionary];s="radio"==e.ui?o.default.createElement(A,(0,p.default)({name:e.id},n),Object.keys(C).map(e=>o.default.createElement(g.default,{key:e,value:e},C[e]))):o.default.createElement(w.default,n,Object.keys(C).map(e=>o.default.createElement(T,{key:e,value:e},C[e])))}else if("TreeSelect"===e.ui&&e.valueRef){var D=e.valueRef;if(!l[e.id]){var E=null;D.function==this.props.fwParam.openerFunction&&D.view==this.props.fwParam.openerView&&this.props.treeData&&(E=this.props.treeData),l[e.id]={loading:!1,data:E,queryIndex:0,defaultOpen:!1}}var b=l[e.id];b.data||(console.info("before remote call"),b.data=[],this.props.getTreeData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:D.function,view:D.view}),fwParam:{distinct:D.distinct?D.distinct:null,queryColumns:D.value+","+D.label+","+(D.otherRefs?D.otherRefs:"")},callback:t=>{t.success?(b.data=t.data,console.info("result.data",b.data),b.loading=!1,l[e.id]=b,this.setState({refData:l})):b.data=null}})),console.info("before render ",b.data),s=o.default.createElement(f.default,(0,p.default)({},n,{placeholder:e.prompt?e.prompt:"\u8bf7\u9009\u62e9",notFoundContent:b.loading?o.default.createElement(h.default,{size:"small"}):null,showArrow:!0,filterOption:!1,loadData:t=>this.onTreeSelectLoadData(t,e,b),treeExpandedKeys:b.expandedKeys?b.expandedKeys:b.data.map(e=>String(e[D.value])),onTreeExpand:e=>{b.expandedKeys=e,b.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:b.defaultOpen,onSearch1:t=>{b.timeout&&(clearTimeout(b.timeout),b.timeout=null),b.currentValue=t;var a=()=>{console.info(t),b.loading=!0,this.props.getRefData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:D.function,view:D.view}),fwParam:{queryStr:t,distinct:D.distinct?D.distinct:null,queryColumns:D.value+","+D.label+","+(D.otherRefs?D.otherRefs:"")},callback:a=>{b.currentValue==t&&(b.data=a.data,b.loading=!1,b.defaultOpen=!0,r[e.id].value=t,this.setState({refData:l,fwParam:i,formData:r}))}})};b.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(b.data,D))}else if(null!=e.valueRef){var S=e.valueRef;if(!l[e.id]){console.info(i.newData);var L={};L[S.value]=r[e.id]?r[e.id].value:0,e.showColumn&&r[e.showColumn]&&(console.info("showcolumn",e.showColumn,r),L[S.label]=r[e.showColumn].value),l[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:l})}var P=l[e.id];P.data||(console.info("before remote call"),P.data=[],this.props.getRefData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:S.function,view:S.view}),fwParam:{distinct:S.distinct?S.distinct:null,queryColumns:S.value+","+S.label+","+(S.otherRefs?S.otherRefs:"")},callback:t=>{var a,i=[];(t.success&&(i=t.data),e.showColumn)&&function(){console.info("showColumn",r[e.showColumn],r[e.id]);var t=r[e.showColumn]&&r[e.showColumn].value?r[e.showColumn].value.split(","):[],l=r[e.id]&&r[e.id].value?r[e.id].value.split(","):[],o=null;if(l.length>0&&t.length==l.length)for(a=0;a<l.length;++a)i.filter(e=>e[S.value]==l[a])||(o={},o[S.value]=l[a],o[S.label]=t[a],i.push(o))}();console.info("this.state.fwParam.newData",this.state.fwParam.newData),P.data=i,P.loading=!1,l[e.id]=P,this.setState({refData:l,formData:r})}}));var k=P.data.map(e=>o.default.createElement(T,{key:e[S.value]},e[S.label],S.otherRefs?S.otherRefs.split(",").map(t=>{e[t]}):""));s=o.default.createElement(w.default,(0,p.default)({},n,{showSearch:!0,placeholder:e.prompt,mode:e.multiSelect?"multiple":null,notFoundContent:P.loading?o.default.createElement(h.default,{size:"small"}):null,showArrow:!0,filterOption:!1,labelInValue:!0,autoFocus:P.autoFocus,defaultOpen:P.defaultOpen,onBlur:()=>console.info("blur"),onSearch:t=>{P.timeout&&(clearTimeout(P.timeout),P.timeout=null),P.currentValue=t;var a=()=>{P.loading=!0,this.props.getRefData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:S.function,view:S.view}),fwParam:{queryValue:t,distinct:S.distinct?S.distinct:null,queryColumns:S.value+","+S.label+","+(S.otherRefs?S.otherRefs:"")},callback:a=>{if(P.currentValue==t){var o,s=[];if(a.success&&(s=a.data),e.showColumn)(function(){var t=r[e.showColumn]&&r[e.showColumn].value?r[e.showColumn].value.split(","):[],a=r[e.id]&&r[e.id]?String(r[e.id].value).split(","):[],l=null;if(a.length>0&&t.length==a.length)for(o=0;o<a.length;++o)s.filter(e=>e[S.value]==a[o])||(l={},l[S.value]=a[o],l[S.label]=t[o],s.push(l))})();console.info("this.state.fwParam.newData2",this.state.fwParam.newData),P.data=s,P.loading=!1,P.defaultOpen=!0,P.autoFocus=!0,this.setState({refData:l,fwParam:i})}}})};P.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange"),console.info(e)}}),k)}else{if("DatePicker"===e.ui)return o.default.createElement(c.default,n);if("TimePicker"===e.ui)return o.default.createElement(u.default,n);if("InputNumber"===e.ui)return o.default.createElement(d.default,n);"Upload"===e.ui||("MAP"==e.ui?(console.info("col.ui",e.ui),s=o.default.createElement(y.default,(0,p.default)({},n,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn)}return s||(s=o.default.createElement(y.default,(0,p.default)({},n,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u8f93\u5165"}))),a[e.id]=s,s}),this.handleFormChange=(e=>{}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],r=i;if("MEMBER_RANKING"==e.id)r=o.default.createElement(n.default,{value:parseInt(this.state.initData["MEMBER_RANKING"]),disabled:!0,style:{fontSize:11}});else if(e.onFormat)r=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var s=this.getLayout().dictMap[e.dictionary][i];r=s||i}else e.showColumn&&(r=e.showColumn.split(",").map(e=>t[e]).join(" "));return r}),this.getLayout=(()=>{return this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,v.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return b.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.CustomizedForm=C.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t={};return this.getLayout().columns.filter(e=>e.visible).map(e=>{var a=(0,v.default)({},this.state.formData[e.id]);if(a&&null!=a.value)if("DatePicker"===e.ui)a.value=a.value?(0,S.default)(a.value,e.pattern?e.pattern:"YYYY-MM-DD"):a.value;else if("TimePicker"===e.ui)a.value=a.value?(0,S.default)(a.value,e.pattern?e.pattern:"HH:mm:ss"):a.value;else if("checkbox01"===e.ui)a.value="1"==a.value;else if(e.valueRef&&"TreeSelect"!=e.ui){if(Array.isArray(a.value)||(a.value?a.value=String(a.value).split(",").map(e=>({key:e})):a.value=[]),e.showColumn){var l=this.state.formData[e.showColumn.split(",")[0]];l&&l.value&&l.value.split(",").map((e,t)=>a.value.length>t?a.value[t].label=e:null)}}else"MAP"==e.ui||("NUM"!=e.type||e.dictionary?a.value=String(a.value):e.decimalSize>0?a.value=parseFloat(a.value):a.value=parseInt(a.value));t[e.id]=C.default.createFormField((0,v.default)({},a))}),t},onValuesChange(e,t){}})(e=>{this.state.form=e.form;e.form.getFieldDecorator;var t=this.getLayout().columns.filter(e=>e.visible),a={_default:[]},l={};this.getLayout().columnGroups&&this.getLayout().columnGroups.map(e=>l[e.id]=e),t.map(e=>{var t="_default";e.group&&l[e.group]&&(t=e.group),a[t]||(a[t]=[]),a[t].push(e)});var i=e=>e?e.map(e=>{var t={SERVICE_TYPE:8,SERVICE_FEE:8,MILE:8,SHOP_ID:8,STAFF_ID:16,MEMO:24,MEMBER_RANKING:24,MEMBER_REMARKING:24};return o.default.createElement(s.default,{span:t[e.id],key:e.id,style:{height:24}},e.label,"\xa0:\xa0",this.getDisplayValue(e)," ",e.tail)}):[],n=[];return Object.keys(a).length>1?["_default",...this.getLayout().columnGroups.map(e=>e.id)].map(e=>{l[e]&&a[e]&&a[e].length>0&&n.push(o.default.createElement(s.default,{span:24,key:"group_"+e,style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,l[e].title))),n=[...n,...i(a[e])]}):n=i(t),o.default.createElement(C.default,null,o.default.createElement(r.default,{gutter:1},n))}),this.state=(0,v.default)({},e,{form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{},memberInfo:{},vehicleInfo:{},listData:[]})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData;t.newData=(0,v.default)({},this.props.initData),t.oldData=(0,v.default)({},this.props.initData);var l=this.props.initData,i=l.memberInfo,o=l.vehicleInfo,r=l.listData;Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.setState({fwParam:this.state.fwParam,formData:a,refData:{},memberInfo:i,vehicleInfo:o,listData:r})}else if(this.props.showAsDialog){var s=(0,v.default)({},this.state.fwParam,{oldData:{},newData:{},selectedData:this.props.selectedData});this.props.getEditData({fwCoord:this.getFwCoord(),fwParam:s,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData;a.newData=(0,v.default)({},e),a.oldData=(0,v.default)({},e),Object.keys(e).map(t=>l[t]={value:e[t]}),this.setState({fwParam:this.state.fwParam,formData:l,refData:{}})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null)}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.CustomizedForm;return o.default.createElement("div",null,o.default.createElement(h.default,{spinning:this.props.loading},o.default.createElement(r.default,{id:"memberInfo",gutter:1,style:{paddingBottom:10}},o.default.createElement(s.default,{span:4},o.default.createElement(k.default,{sex:this.state.memberInfo.SEX,memberLevel:this.state.memberInfo.LEVEL,headImage:this.state.memberInfo.WECHAT_HEADIMGURL})),o.default.createElement(s.default,{span:20},o.default.createElement(r.default,null,o.default.createElement(s.default,{span:8},o.default.createElement("span",{style:{fontSize:"16px",fontWeight:"bold"}},this.state.memberInfo.NAME),"0"===this.state.memberInfo.SEX?"\uff08\u5148\u751f\uff09":"\uff08\u5973\u58eb\uff09"),o.default.createElement(s.default,{span:16}," ")),o.default.createElement(r.default,null,o.default.createElement(s.default,{span:12},"\u624b\u673a\u53f7\uff1a",this.state.memberInfo.MOBILE_NO)),o.default.createElement(r.default,null,o.default.createElement(s.default,{span:6},"\u8f66\u724c\uff1a",this.state.vehicleInfo.VEHICLE_NUM),o.default.createElement(s.default,{span:10},"VIN\u7801\uff1a",this.state.vehicleInfo.VIN),o.default.createElement(s.default,{span:8},"\u8f66\u578b\uff1a",this.state.vehicleInfo.CAR_MODEL)))),o.default.createElement(r.default,{id:"serviceInfo"},o.default.createElement(s.default,{style:{fontSize:18,marginBottom:10,marginLeft:20}},o.default.createElement("b",null,"\u670d\u52a1\u4fe1\u606f")),o.default.createElement(s.default,{style:{marginLeft:40}},o.default.createElement(e,{onChange:this.handleFormChange})))))}})||P);t.default=M},HpKK:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=f,t.logic=h,t.handleOk=m,t.handleCancel=p;var o=i(a("q1tI"));a("2qtc");var r=i(a("kLXV"));a("+L6B");var s=i(a("2/Rp")),n=i(a("MVZn"));a("miYZ");var d=i(a("tsqr"));a("Pwec");var u=i(a("CtXQ")),c=l(a("uYVn"));function f(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],console.info("layout executed",this),o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(u.default,{type:this.action.icon}),this.action.label," "))}function h(e,t,l,i,u){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=u,null==l&&this.view.state.selectedRowKeys&&this.view.state.selectedRowKeys.length>0){var c=this.view.state.selectedRowKeys[0];this.record=this.view.state.data[c],this.recordIndex=c}if(this.record||null!=this.action.argument&&void 0!=this.action.argument.needSelectData&&null!=this.action.argument.needSelectData&&"1"!=this.action.argument.needSelectData){var f=(0,n.default)({},this.view.getFwCoord(),{view:"detail"});this.action.argument&&(this.action.argument.function&&(f["function"]=this.action.argument.function),this.action.argument.view&&(f["view"]=this.action.argument.view));var h={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{}},m=null;if(console.info("this.action",this.action),this.action.argument&&this.action.argument.antdPath){var p=this.action.argument.antdPath;m=a("RO01")(`./${p}`).default}else m=a("i307").default;var v=e=>{if(this.innerLayout=e,l){var a=this.view.state.dialogs,i=e.columns.filter(e=>e.visible),u=i.length<5?"25vw":"42vw",c=[],p=this.action.argument.INFOCONTENT,v=(0,n.default)({},this.record);v.ADDRESS&&(v.ADDRESS=v.ADDRESS.split(";")[0].split("\u3001").join("")),Object.keys(v).map(e=>{p=p.split("{"+e+"}").join(v[e])});var g=[{id:t,name:this.action.argument.NAME,lat:v[this.action.argument.LAT],lng:v[this.action.argument.LNG],icon:null,infoContent:p,buttonOpts:{}}];c.push(o.default.createElement(s.default,{key:"back",onClick:e=>this.handleCancel(e)},"\u5173\u95ed")),this.action.argument&&this.action.argument.showActions&&this.action.argument.showActions.split(",").map(e=>{var t=this.view.getLayout().actionArgs[e];this.view.getActionEntry(t.click).isValid(this.view,e,l)&&c.push(o.default.createElement(s.default,{key:e,onClick:t=>this.view.handleAction((0,n.default)({},t,{fwSourceAction:this}),e,this.record)},t.label))}),a[this.id]=o.default.createElement(r.default,{width:u,key:this.id,title:e.title,visible:!0,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4fdd\u5b58",onOk:e=>this.handleOk(e),footer:c},o.default.createElement(m,{selectedData:this.record,innerLayout:e,innerFwCoord:f,fwParam:h,showAsDialog:!0,dataManaged:!0,initData:l,points:g,onRef:e=>this.onRef(e)})),this.view.setState({dialogs:a})}else d.default.error("\u52a0\u8f7d\u6570\u636e\u9519\u8bef",10)};this.innerLayout?v(this.innerLayout):this.view.props.loadLayout({fwCoord:f,fwParam:h,callback:v})}else d.default.error("\u8bf7\u9009\u62e9\u8981\u67e5\u770b\u7684\u6570\u636e",5)}function m(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{var i=this.dialog.state.formData,o=this.dialog.state.fwParam.newData;Object.keys(i).map(e=>o[e]=i[e].value);var r=(0,n.default)({},this.dialog.state.fwParam,{newData:o});this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:r,callback:a=>{if(a.success)c.isEmpty(a.errorMsg)?d.default.success("\u4fdd\u5b58\u6210\u529f"):d.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}c.isEmpty(a.errorMsg)||d.default.error(a.errorMsg,10)}}})}})}function p(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},I0v2:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=m,t.logic=p,t.handleOk=g,t.handleCancel=w;var o=i(a("q1tI"));a("DZo9");var r=i(a("8z0m")),s=i(a("pVnL"));a("Pwec");var n=i(a("CtXQ"));a("2qtc");var d=i(a("kLXV"));a("miYZ");var u=i(a("tsqr")),c=i(a("MVZn")),f=l(a("uYVn")),h=a("QCDS");function m(e,t,a,l){this.view=e;var i=e.getLayout().actionArgs[t];this.action=i;var f=(0,c.default)({},this.view.getFwCoord(),{view:"create"}),h={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{}},m=v({fwCoord:f,fwParam:h},null,null),p={name:t+"_importFile",action:"/fw/importData?fwCoord.project="+e.getFwCoord().project+"&",data:m,onChange(t){if(console.info("upload info",t),"uploading"!==t.file.status&&console.log(t.file,t.fileList),"done"===t.file.status){var a=t.file.response;a.success?(u.default.success(`${i.label}\u6210\u529f`),e.refresh()):a.connectFilePath?d.default.error({title:"\u9519\u8bef",content:o.default.createElement("span",{dangerouslySetInnerHTML:{__html:'<a href="/fw/download?fileName='+a.connectFilePath+'" target="_blank">\u4e0a\u4f20\u6587\u4ef6\u6709\u8bef\uff0c\u70b9\u6b64\u4e0b\u8f7d\u660e\u7ec6</a>'}})}):a.errorMsg&&u.default.error(a.errorMsg,10)}else"error"===t.file.status&&u.default.error(`${i.label}\u6570\u636e\u5bfc\u5165\u9519\u8bef`,10)}};return o.default.createElement(r.default,(0,s.default)({key:t},p,{showUploadList:!1,style:{marginLeft:10}}),o.default.createElement("a",{href:"javascript:;"},o.default.createElement(n.default,{type:this.action.icon})," ",this.action.label))}function p(e,t,a,l,i){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,null==a&&this.view.state.selectedRowKeys&&this.view.state.selectedRowKeys.length>0){var o=this.view.state.selectedRowKeys[0];this.record=this.view.state.data[o],this.recordIndex=o}var r=(0,c.default)({},this.view.getFwCoord()),s={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{DATA_RANGE:0,FILE_TYPE:"xls"}},n=v({fwCoord:r,fwParam:s},null,null);n.su=(0,h.getSimulateUserId)(location.search);var d=document.createElement("form");d.style.display="display:none;",d.method="post",d.action="/fw/export",d.target="_blank",Object.keys(n).map(e=>{var t=document.createElement("input");t.type="hidden",t.name=e,t.value=n[e],d.appendChild(t)}),document.body.appendChild(d),d.submit(),document.body.removeChild(d)}function v(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>objectToFormArr(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]).replace(/%/g,"%25").replace(/\&/g,"%26").replace(/\+/g,"%2B").replace(/\=/g,"%3D"):v(e[o],i,l)}return i}function g(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{var i=(0,c.default)({},this.dialog.state.fwParam);this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:i,callback:a=>{if(a.success)f.isEmpty(a.errorMsg)?u.default.success("\u4fdd\u5b58\u6210\u529f"):u.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}f.isEmpty(a.errorMsg)||u.default.error(a.errorMsg,10)}}})}})}function w(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},I3cm:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("14J3");var r=i(a("BMrR"));a("jCWc");var s=i(a("kPKH"));a("DZo9");var n=i(a("8z0m"));a("miYZ");var d=i(a("tsqr"));a("giR+");var u=i(a("fyUT"));a("Xi6J");var c=i(a("kl6h"));a("iQDF");var f=i(a("+eQT"));a("O3gP");var h=i(a("lrIw"));a("6UJt");var m=i(a("DFOY"));a("nRaC");var p=i(a("5RzL"));a("T2oS");var v=i(a("W9HT")),g=i(a("pVnL")),w=i(a("MVZn"));a("sRBo");var y=i(a("kaz8"));a("7Kak");var C=i(a("9yH6"));a("OaEy");var D=i(a("2fM7"));a("5NDa");var E=i(a("5rEg"));a("y8nQ");var b=i(a("Vl3Y"));a("ozfa");var S,L,P=i(a("MJZm")),k=a("MuoO"),I=(i(a("QCDS")),l(a("uYVn"))),R=l(a("dNXO")),T=a("0Fy/"),A=i(a("DQt+")),_=a("iv27"),O=i(a("wd/R"));a("XDpg"),O.default.locale("zh-cn");var M=P.default.TreeNode,F=b.default.Item,N=E.default.TextArea,j=D.default.Option,V=C.default.Group,x=y.default.Group,z={labelCol:{xs:{span:8},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16}}};function Y(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.edit,dispatch:a,fwCoord:l,layout:i}}var G=e=>{return{getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})}}},q=(S=(0,k.connect)(Y,G),S(L=class extends o.Component{constructor(e){super(e),this.loadCascaderData=((e,t)=>{var a=e[e.length-1];a.loading=!0;var l=t.valueRef,i=e=>{return e?e.map(e=>{return e.value=e[l.value],e.label=e[l.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e.children&&(e.children=i(e.children)),e}):null};this.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:l.function,view:l.view}),fwParam:{distinct:l.distinct?l.distinct:null,queryColumns:l.value+","+l.label+","+(l.otherRefs?l.otherRefs:""),selectedTreeNodeId:e.map(e=>e[l.value]).join(",")},callback:e=>{a.loading=!1,a.children=i(e.data),this.setState({refData:this.state.refData})}})}),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,w.default)({},this.state.fwParam,{openerSelectedData:(0,w.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,w.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(M,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+","+(t.valueRef.otherRefs?t.valueRef.otherRefs:""),selectedTreeNodeId:e.props.eventKey},callback:e=>{i.children=e.data,a.defaultOpen=!0,console.info(a.data),l(),this.setState({refData:this.state.refData})}}))})),this.onCascaderChange=((e,t,a)=>{if(console.info("onCascaderChange",e.id,t,a),"ADDRESS_SELECT"==e.id){var l=this.state,i=l.fwParam,o=l.formData,r=l.manualValues;i.newData||(i.newData={}),i.newData[e.id]=t.join(","),o[e.id]||(o[e.id]={}),o[e.id].value=t.join(","),r[e.id]=t,this.setState({fwParam:i,manualValues:r,formData:o})}}),this.onAutoCompleteSelect=((e,t,a)=>{console.info("onAutoCompleteSelect",e.id,t,a)}),this.onSelectChange=((e,t,a)=>{console.info("onSelectChange",e.id,t,a)}),this.onSelectSelect=((e,t,a)=>{console.info("onSelectSelect",e.id,t,a)}),this.MONEY_IDS={},this.getInputComponent=((e,t)=>{var a=this.state,l=a.components,i=a.refData,r=a.fwParam,s=a.formData,b=null,S={disabled:!e.editable,style:{width:"85%"}};t&&(S.value=this.state.manualValues[e.id]);var L="",P="";if(e.editable&&(L=e.prompt?e.prompt:"\u8bf7\u8f93\u5165",P=e.prompt?e.prompt:"\u8bf7\u9009\u62e9"),"label"==e.ui)b=this.getDisplayValue(e);else if("MEMO"===e.type)b=o.default.createElement(N,(0,g.default)({},S,{rows:4}));else if("checkbox01"===e.ui)b=o.default.createElement(y.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictList[e.dictionary]){var k=this.getLayout().dictList[e.dictionary];if("radio"==e.ui)b=o.default.createElement(V,(0,g.default)({name:e.id},S),k.map(e=>o.default.createElement(C.default,{key:e.value,value:String(e.value)},e.label)));else if("checkbox"==e.ui){var I=k;b=o.default.createElement(x,(0,g.default)({name:e.id},S,{options:I}))}else b=o.default.createElement(D.default,S,k.map(e=>o.default.createElement(j,{key:e.value,value:e.value},e.label)))}else if("TreeSelect"===e.ui&&e.valueRef){var R=e.valueRef;if(!i[e.id]){var T=null;R.function==this.props.fwParam.openerFunction&&R.view==this.props.fwParam.openerView&&this.props.treeData&&(T=this.props.treeData),i[e.id]={loading:!1,data:T,queryIndex:0,defaultOpen:!1}}var A=i[e.id];A.data||(A.data=[],this.props.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:R.function,view:R.view}),fwParam:{distinct:R.distinct?R.distinct:null,queryColumns:R.value+","+R.label+","+(R.otherRefs?R.otherRefs:"")},callback:t=>{t.success?(A.data=t.data,console.info("result.data",A.data),A.loading=!1,i[e.id]=A,this.setState({refData:i})):A.data=null}})),b=o.default.createElement(p.default,(0,g.default)({},S,{placeholder:P,notFoundContent:A.loading?o.default.createElement(v.default,{size:"small"}):null,showArrow:!0,showSearch:!0,searchPlaceholder:"\u8f93\u5165\u641c\u7d22",filterTreeNode:(e,t)=>{return console.info("treeNode",t),t.props.title.indexOf(e)>=0},treeNodeFilterProp:"title",filterOption:!1,loadData:t=>this.onTreeSelectLoadData(t,e,A),treeExpandedKeys:A.expandedKeys?A.expandedKeys:A.data.map(e=>String(e[R.value])),onTreeExpand:e=>{A.expandedKeys=e,A.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:A.defaultOpen,onSearch1:t=>{A.timeout&&(clearTimeout(A.timeout),A.timeout=null),A.currentValue=t;var a=()=>{console.info(t),A.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:R.function,view:R.view}),fwParam:{queryStr:t,distinct:R.distinct?R.distinct:null,queryColumns:R.value+","+R.label+","+(R.otherRefs?R.otherRefs:"")},callback:a=>{A.currentValue==t&&(A.data=a.data,A.loading=!1,A.defaultOpen=!0,s[e.id].value=t,this.setState({refData:i,fwParam:r,formData:s}))}})};A.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(A.data,R))}else if("Cascader"==e.ui&&e.valueRef){var _=e.valueRef;if(!i[e.id]){var M={};M[_.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),M[_.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var F=i[e.id];F.data||(F.data=[],this.props.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:_.function,view:_.view}),fwParam:{distinct:_.distinct?_.distinct:null,queryColumns:_.value+","+_.label+","+(_.otherRefs?_.otherRefs:"")},callback:t=>{t.success?(F.data=t.data.map(e=>{return e.value=e[_.value],e.label=e[_.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e}),F.loading=!1,i[e.id]=F,this.setState({refData:i})):F.data=null}})),b=o.default.createElement(m.default,(0,g.default)({},S,{placeholder:P,options:F.data,loadData:t=>this.loadCascaderData(t,e),onChange:(t,a)=>this.onCascaderChange(e,t,a),showSearch:{filter:(e,t)=>{return t.some(t=>t.label.toLowerCase().indexOf(e.toLowerCase())>-1)}}}))}else if("AutoComplete"==e.ui&&e.valueRef){var z=e.valueRef;i[e.id]||(i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i}));var Y=i[e.id];b=o.default.createElement(h.default,(0,g.default)({},S,{placeholder:L,dataSource:Y.data,defaultOpen:Y.defaultOpen,onSelect:(t,a)=>this.onAutoCompleteSelect(e,t,a),onSearch:e=>{Y.timeout&&(clearTimeout(Y.timeout),Y.timeout=null),Y.currentValue=e;var t=()=>{Y.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:z.function,view:z.view}),fwParam:(0,w.default)({},this.state.fwParam,{queryValue:e,distinct:z.distinct?z.distinct:null,queryColumns:z.value+","+z.label+","+(z.otherRefs?z.otherRefs:"")}),callback:t=>{if(Y.currentValue==e){var a={};t.success&&t.data.map(e=>{a[e[z.label]]=e}),Y.dataMap=a,Y.data=Object.keys(a),Y.loading=!1,Y.defaultOpen=!0,Y.autoFocus=!0,this.setState({refData:i,fwParam:r})}}})};Y.timeout=setTimeout(t,900)}}))}else if(null!=e.valueRef){var G=e.valueRef;if(!i[e.id]){var q={};q[G.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),q[G.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var U=i[e.id];U.data||(U.data=[],this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:G.function,view:G.view}),fwParam:{distinct:G.distinct?G.distinct:null,queryColumns:G.value+","+G.label+","+(G.otherRefs?G.otherRefs:"")},callback:t=>{var a,l=[],o={};(t.success&&(l=t.data,l&&l.map(e=>o[e[G.value]]=e)),e.showColumn)&&function(){console.info("showColumn",s[e.showColumn],s[e.id]);var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],i=s[e.id]&&s[e.id].value?s[e.id].value.split(","):[],o=null;if(i.length>0&&t.length==i.length)for(a=0;a<i.length;++a)l.some(e=>e[G.value]==i[a])||(o={},o[G.value]=i[a],o[G.label]=t[a],l.push(o))}();U.data=l,U.dataMap=o,U.loading=!1,i[e.id]=U,this.setState({refData:i,formData:s})}}));var B=U.data.map(e=>o.default.createElement(j,{key:e[G.value]},e[G.label],G.otherRefs?G.otherRefs.split(",").map(t=>{e[t]}):""));b=o.default.createElement(D.default,(0,g.default)({},S,{placeholder:P,showSearch:!0,mode:e.multiSelect?"multiple":null,notFoundContent:U.loading?o.default.createElement(v.default,{size:"small"}):null,showArrow:!0,filterOption:!1,labelInValue:!0,autoFocus:U.autoFocus,defaultOpen:U.defaultOpen,onSelect:(t,a)=>this.onSelectSelect(e,t,a),onChange:(t,a)=>this.onSelectChange(e,t,a),onSearch:t=>{U.timeout&&(clearTimeout(U.timeout),U.timeout=null),U.currentValue=t;var a=()=>{U.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:G.function,view:G.view}),fwParam:{queryValue:t,distinct:G.distinct?G.distinct:null,queryColumns:G.value+","+G.label+","+(G.otherRefs?G.otherRefs:"")},callback:a=>{if(U.currentValue==t){var l,o=[],r={};if(a.success&&(o=a.data,o&&o.map(e=>r[e[G.value]]=e)),e.showColumn)(function(){var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],a=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],i=null;if(a.length>0&&t.length==a.length)for(l=0;l<a.length;++l)o.some(e=>e[G.value]==a[l])||(i={},i[G.value]=a[l],i[G.label]=t[l],o.push(i))})();U.data=o,U.dataMap=r,U.loading=!1,U.defaultOpen=!0,U.autoFocus=!0,this.setState({refData:i})}}})};U.timeout=setTimeout(a,500)}}),B)}else if("DatePicker"===e.ui){var K=()=>!1;"today"==e.min?K=(e=>e&&e<(0,O.default)().startOf("day")):"today"==e.max&&(K=(e=>e&&e>(0,O.default)().endOf("day"))),b=o.default.createElement(f.default,(0,g.default)({},S,{disabledDate:e=>K(e),placeholder:P}))}else if("TimePicker"===e.ui)b=o.default.createElement(c.default,S);else if("InputNumber"===e.ui)b=o.default.createElement(u.default,(0,g.default)({},S,{placeholder:L}));else if("Upload"===e.ui){var W=(0,w.default)({},this.getFwCoord(),{view:"create"}),H={openerActionId:e.id,openerFunction:this.getFwCoord()["function"],openerView:this.getFwCoord().view,oldData:{},newData:{},saveType:"checkonly"},X=this.objectToFormInputs({fwCoord:W,fwParam:H},null,null),Z={name:e.id+"_importFile",action:"/fw/importData?fwCoord.project="+this.getFwCoord().project+"&",data:X,onChange(t){if(this.view.setState({loading:!0}),t.file.status,"done"===t.file.status){var a=t.file.response;this.view.setState({uploadedFile:t.file.name,uploadResult:null,loading:!1}),a.success?(r.connectFilePath=a.connectFilePath,this.view.setState({fwParam:r}),d.default.info("\u6587\u4ef6\u6821\u9a8c\u901a\u8fc7")):a.connectFilePath?this.view.setState({uploadResult:o.default.createElement("span",{dangerouslySetInnerHTML:{__html:'<font color="#ff0000"><a href="/fw/download?fileName='+a.connectFilePath+'" target="_blank">\u4e0a\u4f20\u6587\u4ef6\u6709\u8bef\uff0c\u70b9\u6b64\u4e0b\u8f7d\u660e\u7ec6</a></font>'}})}):a.errorMsg&&d.default.error(a.errorMsg,10)}else"error"===t.file.status&&(this.view.setState({loading:!1}),d.default.error(`${e.label}\u5bfc\u5165\u9519\u8bef`,10))}};Z.view=this,b=o.default.createElement(n.default,(0,g.default)({},S,Z,{showUploadList:!1,style:{marginLeft:10}}),o.default.createElement("a",{href:"javascript:;"},this.state.uploadedFile?this.state.uploadedFile:"\u70b9\u6b64\u4e0a\u4f20"))}else"MAP"==e.ui?(console.info("col.ui",e.ui),b=o.default.createElement(E.default,(0,g.default)({},S,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn;return b||(b=o.default.createElement(E.default,(0,g.default)({},S,{type:e.ui?e.ui:"text",placeholder:L}))),l[e.id]=b,b}),this.normFile=(e=>{return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.file&&e.file.response?e.file.response.success?e&&e.fileList:null:e&&e.fileList}),this.objectToFormInputs=function(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>this.objectToFormInputs(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]).replace(/%/g,"%25").replace(/\&/g,"%26").replace(/\+/g,"%2B").replace(/\=/g,"%3D"):this.objectToFormInputs(e[o],i,l)}return i},this.selectPointInMap=(e=>{var t=this.state.formData,a=this.getLayout().columnMap[e],l=a.showColumn.split(",");console.info("param",l,t),this.state.map.selectPoint({id:e,lat:t[l[0]].value,lng:t[l[1]].value,name:a.label,callback:(e,a,i,o,r)=>{console.info("callback",r,r.onlineStr),t[e].value=r.onlineStr,t[l[0]].value=a,t[l[1]].value=i,console.info("newParam",a,i,t),this.setState({formData:t})}})}),this.handleFormChange=(e=>{if(e){var t=this.state,a=t.fwParam;t.formData;a.newData||(a.newData={}),Object.keys(e).map(t=>{var a=e[t],l=this.getLayout().columnMap[t],i=l.ui,o=null;if(a&&null!=a.value)if(this.state.formData[t]||(this.state.formData[t]={}),o=a.value,"DatePicker"===i)o=a.value.format(l.pattern?l.pattern:"YYYY-MM-DD");else if("TimePicker"===i)o=a.value.format(l.pattern?l.pattern:"HH:mm:ss");else if("checkbox01"===i)o=a.value?"1":"0";else if(l.dictionary)"checkbox"==l.ui&&Array.isArray(a.value)&&(o=a.value.join(","));else if("Cascader"==l.ui)Array.isArray(a.value)&&(o=a.value.join(","),console.info("Cascader",a.value,o));else if("AutoComplete"==l.ui)o=a.value;else if(l.valueRef&&"TreeSelect"!=l.ui){if(o=Array.isArray(a.value)?a.value.filter(e=>e&&e.key).map(e=>e.key).join(","):a.value.key?a.value.key:null,l.showColumn){var r=this.getLayout().columnMap[l.showColumn.split(",")[0]];if(r){var s=a.value.map(e=>Array.isArray(e.label)?e.label[0]:e.label).join(",");this.state.formData[r.id]||(this.state.formData[r.id]={}),this.state.formData[r.id].value=s}}}else"Upload"===l.ui?(console.info("upload",o),Array.isArray(o)&&(o=o[0].name)):"MAP"==l.ui?(o=this.state.formData[t].value,a.dirty=!0):("string"==typeof o&&(o=o.trim(),l.size>0&&o.length>l.size&&(o=o.substr(0,l.size))),"NUM"==l.type&&("number"!==typeof o&&(o=new String(o).split("").filter(e=>!I.isEmpty(e)).filter((e,t,a)=>0==t&&"-"==e||"."==e&&a.filter((e,a)=>a<t).every(e=>"."!=e)||I.isNumber(e)).join("")),void 0!=l.min&&null!=l.min&&(null==o||o<l.min)&&(o=l.min),void 0!=l.max&&null!=l.max?o>l.max&&(o=l.max):l.size&&o>Math.pow(10,l.size)-1&&(o=Math.pow(10,l.size)-1)));a.value=o}),this.setState({formData:(0,w.default)({},this.state.formData,e),fwParam:a})}}),this.doOtherInputValidate=(()=>{return null}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],r=i;if(e.onFormat)r=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var s=this.getLayout().dictMap[e.dictionary][i];r=s||i}else e.showColumn&&(r=e.showColumn.split(",").map(e=>t[e]).join(" "));return o.default.createElement("span",null,r)}),this.loadMemberInfo=(e=>{e.split(",");var t=this.state.fwParam;this.setState({loading:!0}),(0,_.getMemberRelationInfo)({memberIdAndCarId:e}).then(e=>{e.data.memberInfo&&e.data.memberInfo.SID?(t.newData.SID=e.data.memberInfo.SID,this.setState({fwParam:t,memberInfo:e.data.memberInfo,vehicleInfo:e.data.vehicleInfo,loading:!1})):(this.setState({loading:!1}),d.default.error("\u6ca1\u6709\u627e\u5230\u5bf9\u5e94\u4f1a\u5458\u4fe1\u606f",5))}).catch(e=>{this.setState({loading:!1}),d.default.error("\u52a0\u8f7d\u4f1a\u5458\u4fe1\u606f\u9519\u8bef",5)})}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,w.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return R.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.FIX_WIDTH={},this.CustomizedForm=b.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t={};return this.getLayout().columns.filter(e=>e.visible).map(e=>{var a=(0,w.default)({},this.state.formData[e.id]);if(a&&null!=a.value)if("DatePicker"===e.ui)a.value=a.value?(0,O.default)(a.value,e.pattern?e.pattern:"YYYY-MM-DD"):a.value;else if("TimePicker"===e.ui)a.value=a.value?(0,O.default)(a.value,e.pattern?e.pattern:"HH:mm:ss"):a.value;else if("checkbox01"===e.ui)a.value="1"==a.value;else if(e.dictionary)"checkbox"==e.ui?Array.isArray(a.value)||(a.value=String(a.value).split(",")):a.value=String(a.value);else if("Cascader"==e.ui)a.value=String(a.value).split(",");else if("AutoComplete"==e.ui);else if(e.valueRef&&"TreeSelect"!=e.ui){if(Array.isArray(a.value)||(a.value?a.value=String(a.value).split(",").map(e=>({key:e})):a.value=[]),Array.isArray(a.value)&&e.showColumn){var l=this.state.formData[e.showColumn.split(",")[0]];l&&l.value&&l.value.split(",").map((e,t)=>a.value.length>t?a.value[t].label=e:null)}}else"MAP"==e.ui?a.value=a.value.split("\u3001").join(""):"NUM"!=e.type||e.dictionary?a.value=String(a.value):(""==a.value&&(a.value=null),a.value);e.valueRef&&"TreeSelect"!=e.ui&&null==a.value&&delete a.value,t[e.id]=b.default.createFormField((0,w.default)({},a))}),t},onValuesChange(e,t){}})(e=>{this.state.form=e.form;var t=e.form.getFieldDecorator,a=this.getLayout().columns.filter(e=>e.visible),l={_default:[]},i={};this.getLayout().columnGroups&&this.getLayout().columnGroups.map(e=>i[e.id]=e),a.map(e=>{var t="_default";e.group&&i[e.group]&&(t=e.group),l[t]||(l[t]=[]),l[t].push(e)});var n=e=>e?e.map(e=>{var l=[],i=!1;e.editable&&(l.push({required:e.required,message:"\u8bf7\u8f93\u5165"+e.label}),"NUM"==e.type?e.dictionary||e.valueRef||(i=!0,e.max||e.size,e.min):e.dictionary||e.valueRef||"DatePicker"==e.ui||(i=!0,e.size));var r={valuePropName:"value",rules:l};return i&&(r.validateTrigger="onBlur"),"checkbox01"==e.ui?r.valuePropName="checked":"Upload"==e.ui&&(r.getValueFromEvent=this.normFile),o.default.createElement(s.default,{span:(a.length>5||a.some(e=>"MAP"==e.ui),12),key:e.id},o.default.createElement(F,(0,g.default)({},z,{label:e.label}),t(e.id,r)(this.getInputComponent(e)),e.tail?" "+e.tail:null))}):[],d=[];return Object.keys(l).length>1?["_default",...this.getLayout().columnGroups.map(e=>e.id)].map(e=>{i[e]&&l[e]&&l[e].length>0&&d.push(o.default.createElement(s.default,{span:24,key:"group_"+e,style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,i[e].title))),d=[...d,...n(l[e])]}):d=n(a),a.some(e=>"Upload"==e.ui)&&d.push(o.default.createElement(s.default,{key:"FW_uploadPrompt",span:24,style:{height:60,textAlign:"center"}},this.state.uploadResult)),o.default.createElement(b.default,null,o.default.createElement(r.default,{id:"memberInfo",gutter:1},o.default.createElement(s.default,{span:4},o.default.createElement(A.default,{sex:this.state.memberInfo.SEX,memberLevel:this.state.memberInfo.LEVEL,headImage:this.state.memberInfo.WECHAT_HEADIMGURL})),this.state.memberInfo&&this.state.memberInfo.NAME?o.default.createElement(s.default,{span:20},o.default.createElement(r.default,null,o.default.createElement(s.default,{span:8},o.default.createElement("span",{style:{fontSize:"16px",fontWeight:"bold"}},this.state.memberInfo.NAME),"0"===this.state.memberInfo.SEX?"\uff08\u5148\u751f\uff09":"\uff08\u5973\u58eb\uff09"),o.default.createElement(s.default,{span:8},this.state.memberInfo.MOBILE_NO),o.default.createElement(s.default,{span:8}," ")),o.default.createElement(r.default,null,o.default.createElement(s.default,{span:8},"\u4f1a\u5458\u79ef\u5206\uff1a",this.state.memberInfo.BONUS),o.default.createElement(s.default,{span:8},"\u804c\u4e1a\uff1a",this.state.memberInfo.OCCUPATION),o.default.createElement(s.default,{span:8},"\u8f66\u724c\uff1a",this.state.vehicleInfo.VEHICLE_NUM)),o.default.createElement(r.default,null,o.default.createElement(s.default,{span:8},"\u4f1a\u5458\u6765\u6e90\uff1a",2===this.state.memberInfo.MEMBER_SOURCE?"\u552e\u540e\u5f00\u62d3":"\u81ea\u5e97\u8d2d\u8f66"),o.default.createElement(s.default,{span:8},"\u5bb6\u5ead\u6536\u5165\uff1a",this.state.memberInfo.FAMILIY_INCOMING),o.default.createElement(s.default,{span:8},"\u8f66\u578b\uff1a",this.state.vehicleInfo.CAR_MODEL))):o.default.createElement(s.default,{span:20},"\u6682\u65e0\u4fe1\u606f")),o.default.createElement(r.default,null),o.default.createElement(r.default,{gutter:1},d))}),this.state=(0,w.default)({},e,{loading:!1,dialogs:{},form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{},uploadedFile:null,uploadResult:null,manualValues:{},memberInfo:{},vehicleInfo:{}})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData;t.newData=(0,w.default)({},this.props.initData),t.oldData=(0,w.default)({},this.props.initData),Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.setState({fwParam:this.state.fwParam,formData:a,refData:{}},()=>{this.getLayout().columns.filter(e=>"MAP"==e.ui).map(e=>this.selectPointInMap(e.id))})}else if(this.props.showAsDialog){var l=(0,w.default)({},this.state.fwParam,{oldData:{},newData:{},selectedData:this.props.selectedData});this.props.getEditData({fwCoord:this.getFwCoord(),fwParam:l,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData;a.newData=(0,w.default)({},e),a.oldData=(0,w.default)({},e),Object.keys(e).map(t=>l[t]={value:e[t]}),this.setState({fwParam:this.state.fwParam,formData:l,refData:{}})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null)}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.CustomizedForm;return o.default.createElement("div",null,o.default.createElement(v.default,{spinning:this.props.loading||this.state.loading},o.default.createElement(e,{onChange:this.handleFormChange}),this.getLayout().columns.some(e=>e.visible&&"MAP"==e.ui)?o.default.createElement(T.Map,{height:"50vh",showQueryControl:!0,onRef:e=>this.setState({map:e})}):null),Object.values(this.state.dialogs))}})||L);t.default=q},ITHm:function(e,t,a){"use strict";var l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=l(a("uYVn"));function o(e,t,a,l,o){return i.isEmpty(t.VEHICLE_NUM)?t.VIN:t.VEHICLE_NUM}},IrKK:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=c,t.logic=f,t.handleOk=m,t.handleCancel=p;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr")),s=i(a("MVZn"));a("Pwec");var n=i(a("CtXQ")),d=l(a("uYVn")),u=a("QCDS");function c(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],console.info("layout executed",this),o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(n.default,{type:this.action.icon}),this.action.label," "))}function f(e,t,a,l,i){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,null==a&&this.view.state.selectedRowKeys&&this.view.state.selectedRowKeys.length>0){var o=this.view.state.selectedRowKeys[0];this.record=this.view.state.data[o],this.recordIndex=o}var r=(0,s.default)({},this.view.getFwCoord(),{view:"create"});this.action.argument&&(this.action.argument.function&&(r["function"]=this.action.argument.function),this.action.argument.view&&(r["view"]=this.action.argument.view));var n={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{}},d=h({fwCoord:r,fwParam:n},null,null);d.su=(0,u.getSimulateUserId)(location.search);var c=document.createElement("form");c.style.display="display:none;",c.method="post",c.action="/fw/getImportTemplate",c.target="_blank",Object.keys(d).map(e=>{var t=document.createElement("input");t.type="hidden",t.name=e,t.value=d[e],c.appendChild(t)}),document.body.appendChild(c),c.submit(),document.body.removeChild(c)}function h(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>objectToFormArr(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]).replace(/%/g,"%25").replace(/\&/g,"%26").replace(/\+/g,"%2B").replace(/\=/g,"%3D"):h(e[o],i,l)}return i}function m(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{var i=this.dialog.state.formData,o=this.dialog.state.fwParam.newData;Object.keys(i).map(e=>o[e]=i[e].value);var n=(0,s.default)({},this.dialog.state.fwParam,{newData:o});this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:n,callback:a=>{if(a.success)d.isEmpty(a.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}d.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}})}})}function p(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},JGZg:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=c,t.logic=f,t.handleOk=h,t.handleCancel=m;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr"));a("2qtc");var s=i(a("kLXV")),n=i(a("MVZn"));a("Pwec");var d=i(a("CtXQ")),u=l(a("uYVn"));function c(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],console.info("layout executed",this),o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(d.default,{type:this.action.icon}),this.action.label," "))}function f(e,t,l,i,r){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=r;var d=(0,n.default)({},this.view.getFwCoord(),{view:"create"});this.action.argument&&(this.action.argument.function&&(d["function"]=this.action.argument.function),this.action.argument.view&&(d["view"]=this.action.argument.view));var u={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{}},c=null;if(console.info("this.action",this.action),this.action.argument&&this.action.argument.antdPath){var f=this.action.argument.antdPath;c=a("RO01")(`./${f}`).default}else c=a("Tpzm").default;var h=e=>{this.innerLayout||(this.innerLayout={}),this.innerLayout[t]=e;var a=this.view.state.dialogs,l=e.columns.filter(e=>e.visible),i=l.length<5?"25vw":"42vw";a[this.id]=o.default.createElement(s.default,{width:i,key:this.id,title:e.title,visible:!0,maskClosable:!1,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u63d0\u4ea4",onOk:e=>this.handleOk(e)},o.default.createElement(c,{selectedData:this.record,innerLayout:e,innerFwCoord:d,fwParam:u,showAsDialog:!0,onRef:e=>this.onRef(e),dataManaged:!0,initData:{}})),this.view.setState({dialogs:a})};this.innerLayout&&this.innerLayout[t]?h(this.innerLayout[t]):this.view.props.loadLayout({fwCoord:d,fwParam:u,callback:h})}function h(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("change password error",a);else{var i=this.dialog.state.formData,o=this.dialog.state.fwParam.newData;if(Object.keys(i).map(e=>o[e]=i[e].value),!o.NEW_PASSWORD||o.NEW_PASSWORD.length<6)return void r.default.error("\u65b0\u5bc6\u7801\u81f3\u5c11\u8f93\u51656\u4f4d");if(o.NEW_PASSWORD!=o.NEW_PASSWORD2)return void r.default.error("\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4");(0,n.default)({},this.dialog.state.fwParam,{newData:o});this.view.props.changePassword({fwCoord:this.view.getFwCoord(),otherParams:(0,n.default)({},o),callback:a=>{if(a.success)u.isEmpty(a.errorMsg)?r.default.success("\u4fee\u6539\u6210\u529f"):r.default.info(a.errorMsg,10),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}u.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}})}})}function m(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},JQVR:function(e,t,a){"use strict";var l=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=l(a("q1tI")),o=l(a("e/J2")),r=()=>{return i.default.createElement("div",null,"Got Framework Index",i.default.createElement(o.default,null))};t.default=r},KIuD:function(t,a,l){"use strict";var i=l("284h"),o=l("TqRt");Object.defineProperty(a,"__esModule",{value:!0}),a.layout=f,a.logic=h,a.handleOk=m,a.handleCancel=p,a.isValid=v;var r=o(l("q1tI"));l("2qtc");var s=o(l("kLXV"));l("miYZ");var n=o(l("tsqr")),d=o(l("MVZn"));l("Pwec");var u=o(l("CtXQ")),c=i(l("uYVn"));function f(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],r.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},r.default.createElement("a",{href:"javascript:;"},r.default.createElement(u.default,{type:this.action.icon}),this.action.label," "))}function h(t,a,l,i,o){if(this.view=t,this.action=t.getLayout().actionArgs[a],this.record=l,this.recordIndex=i,this.event=o,this.action.argument){var r=this.action.argument,u=r.showByColumn,f=r.setValue,h=r.showConfirm,m=r.message;if(u&&void 0!=f&&null!=f){var p={openerActionId:a,oldData:(0,d.default)({},l),newData:(0,d.default)({},l)};if(p.newData==f)n.default.info("\u72b6\u6001\u672a\u53d8\u5316");else{p.newData[u]=f;var v=()=>{this.view.props.saveEditData({fwCoord:this.view.getFwCoord(),fwParam:p,callback:t=>{if(t.success)c.isEmpty(t.errorMsg)?n.default.success("\u4fdd\u5b58\u6210\u529f"):n.default.info(t.errorMsg,10),console.info("this",this),this.view.refresh(),o.fwSourceAction?o.fwSourceAction.handleCancel(3):this.handleCancel(e);else{if(t.validResultMap){var a={};Object.keys(t.validResultMap).map(e=>{a[e]={value:values[e],errors:[new Error(t.validResultMap[e])]}}),form.setFields(a)}c.isEmpty(t.errorMsg)||n.default.error(t.errorMsg,10)}}})};if(void 0==h||null==h||"1"==h){this.view.getLayout().columnMap[u];s.default.confirm({title:"\u786e\u8ba4",content:m||`\u786e\u8ba4\u8981\u5c06${this.view.getLayout().keyword}\u8bbe\u7f6e\u4e3a${this.action.label}\u5417\uff1f`,onOk(){v()},onCancel(){console.log("Cancel")}})}else v()}}}}function m(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{a?console.info("error",a):(console.info("values",l,this.dialog.props.fwParam.oldData),this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:(0,d.default)({},this.dialog.state.fwParam),callback:a=>{if(a.success)c.isEmpty(a.errorMsg)?n.default.success("\u4fdd\u5b58\u6210\u529f"):n.default.info(a.errorMsg,10),this.dialog.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}c.isEmpty(a.errorMsg)||n.default.error(a.errorMsg,10)}}}))})}function p(e){var t=this.dialog.state.dialogs;delete t[this.id],this.dialog.setState({dialogs:t})}function v(e,t,a){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.action.argument){var l=this.action.argument,i=l.showByColumn,o=l.showValue,r=l.showByEmpty;l.setValue,l.showInColumn;if(i){var s=a[i];return!!String(o).split(",").some(e=>e==s)||!(null!=s&&void 0!=s&&""!==s||!r)}return!0}return!0}},Kuan:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("DjyN");var r=i(a("NUBc"));a("g9YV");var s=i(a("wCAj"));a("14J3");var n=i(a("BMrR"));a("jCWc");var d=i(a("kPKH"));a("+L6B");var u=i(a("2/Rp"));a("qVdP");var c=i(a("jsC+"));a("lUTK");var f=i(a("BvKs"));a("Pwec");var h=i(a("CtXQ"));a("5NDa");var m=i(a("5rEg")),p=i(a("MVZn"));a("B9cy");var v,g,w=i(a("Ol7k")),y=a("MuoO"),C=(i(a("usdK")),i(a("1jeA"))),D=i(a("wVw7")),E=l(a("dNXO")),b=(w.default.Header,w.default.Footer,w.default.Sider),S=w.default.Content;function L(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout,o=e.grid,r=o.data,s=o.fwPage;return{loading:e.loading.models.grid,dispatch:a,fwCoord:l,layout:i,fwPage:s,data:r}}var P=e=>{return{getSelectData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getSelectData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},saveSelectData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/saveSelectData",payload:{fwCoord:a,fwParam:l,callback:i}})},deleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/deleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},getGridData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getGridData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},loadLayout:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,fwParam:l,callback:i}})}}},k=(v=(0,y.connect)(L,P),v(g=class extends o.Component{constructor(e){super(e),this.getSelectData=(e=>{var t=e.fwPage,a=e.fwParam,l=e.fwCoord,i=(0,p.default)({},this.state.fwParam,a);this.props.getSelectData({fwPage:(0,p.default)({},this.state.fwPage,t),fwParam:i,fwCoord:(0,p.default)({},this.getFwCoord(),l),callback:e=>{this.setState({fwPage:e.page,data:e.data})}})}),this.getGridData=(e=>{var t=e.fwPage,a=e.fwParam,l=e.fwCoord,i=(0,p.default)({},this.state.fwParam,a);this.props.getGridData({fwPage:(0,p.default)({},this.state.fwPage,t),fwParam:i,fwCoord:(0,p.default)({},this.getFwCoord(),l),callback:e=>{this.setState({fwPage:e.page,data:e.data})}})}),this.pageChangeHandler=function(e,t){this.getGridData({fwPage:{pageNumber:e,pageSize:t}})},this.OP_COL={title:"Operation",dataIndex:"_FW_ACTIONS",render:(e,t,a)=>o.default.createElement("span",{className:D.default.operation},(this.getLayout().otherActions["inList"]?this.getLayout().otherActions["inList"]:[]).filter(e=>1==e.visible).map((e,l)=>{return e.fw_index=l,this.getActionEntry(e.click).layout(this,e.id,t,a)}))},this.onTableRowClick=function(e){null!=this.state.selectedRowKeys&&0!=this.state.selectedRowKeys.length&&this.state.selectedRowKeys[0]==e.fw_index||(this.setState({openerSelectedData:e,selectedRowKeys:[e.fw_index]}),this.props.loadLayout({fwCoord:(0,p.default)({},this.props.fwCoord,{function:"rights",view:"rightList"}),fwParam:{openerSelectedData:e},callback:e=>{e.gotResource.map((e,t)=>{e.nodes=e.children,delete e.children}),this.setState({rightListLayout:e})}}))},this.getLayout=(()=>{return this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,p.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return E.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.state=(0,p.default)({},e,{fwParam:(0,p.default)({},e.fwParam),buttonSize:e.buttonSize?e.buttonSize:"small",tableSize:e.tableSize?e.tableSize:"middle",showSelectCol:e.showSelectCol?e.showSelectCol:"radio",queryPanelExpanded:!1,dialogs:{},actionInList:[],selectedRowKeys:[],rightListLayout:{actions:[],columns:[],displayActions:[]}})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.getLayout().onQuery&&this.getActionEntry(this.getLayout().onQuery).logic(this,this.getLayout().onQuery,null,-1,null)}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.getLayout().displayActions.map(e=>{var t=[];if("searchGrp"!==e.id&&"gridSearchGrp"!==e.id&&"searchList"!==e.id||t.push(o.default.createElement(m.default,{key:e.id,size:this.state.buttonSize,className:D.default.queryValue,defaultValue:this.state.fwParam.queryValue,onPressEnter:e=>this.handleAction(e,"searchList"),onChange:e=>this.setState({fwParam:(0,p.default)({},this.state.fwParam,{queryValue:e.target.value})})})),"group"==e.tag){var a=e.children.filter(e=>e.visible);if(a.length>1){var l=o.default.createElement(f.default,{onClick:e=>this.handleAction(e)},a.filter((t,a)=>!e.showDefault||a>0).map(e=>o.default.createElement(f.default.Item,{key:e.id},o.default.createElement(h.default,{type:e.icon}),e.label)));return e.showDefault?o.default.createElement("span",{key:e.id},t,o.default.createElement(c.default.Button,{key:e.id,size:this.state.buttonSize,onClick:t=>this.handleAction(t,e.children[0].id),overlay:l},o.default.createElement(h.default,{type:e.children[0].icon}),e.children[0].label)):o.default.createElement("span",{key:e.id},t,o.default.createElement(c.default,{overlay:l},o.default.createElement(u.default,{style:{marginLeft:8},size:this.state.buttonSize},o.default.createElement(h.default,{type:e.icon}),e.label," ",o.default.createElement(h.default,{type:"down"}))))}if(1==a.length)return o.default.createElement("span",{key:a[0].id},t,o.default.createElement(u.default,{key:a[0].id,style:{marginLeft:8},size:this.state.buttonSize,onClick:e=>this.handleAction(e,a[0].id)},o.default.createElement(h.default,{type:a[0].icon}),a[0].label))}else if(e.visible)return o.default.createElement("span",{key:e.id},t,o.default.createElement(u.default,{key:e.id,style:{marginLeft:8},size:this.state.buttonSize,onClick:t=>this.handleAction(t,e.id)},o.default.createElement(h.default,{type:e.icon}),e.label))}),t=[];return this.getLayout().argument&&this.getLayout().argument.queryFields&&t.push(o.default.createElement(d.default,{key:"expanded",span:24,style:{textAlign:"right"}},o.default.createElement("a",{style:{marginLeft:8,fontSize:12},onClick:e=>this.setState({queryPanelExpanded:!this.state.queryPanelExpanded})},this.state.queryPanelExpanded?"\u5173\u95ed":"\u5c55\u5f00"," ",o.default.createElement(h.default,{type:this.state.queryPanelExpanded?"up":"down"})))),o.default.createElement("div",{className:D.default.normal,style:{height:"100%"}},o.default.createElement(w.default,{style:{height:"100%"}},o.default.createElement(b,{width:537,style:{overflow:"auto",backgroundColor:"#ffffff"}},o.default.createElement("div",{style:{width:"95%",margin:"10px"}},o.default.createElement(n.default,null,t),o.default.createElement(n.default,null,o.default.createElement(d.default,{span:24,style:{textAlign:"left"}},e))),o.default.createElement("div",{className:"search-result-list"},o.default.createElement(s.default,{loading:this.props.loading,columns:this.getLayout().columns.filter(e=>e.visible).map(e=>{return"_FW_ACTIONS"==e.id?(this.OP_COL.title=e.label,this.OP_COL):(e.title=e.label,e.dataIndex=e.id,e)}),dataSource:this.state.data,pagination:!1,rowKey:"fw_index",size:this.state.tableSize,bordered:!0,rowSelection:{type:"radio",selectedRowKeys:this.state.selectedRowKeys},onRow:e=>{return{onClick:()=>this.onTableRowClick(e),onMouseEnter:()=>{}}}}),o.default.createElement(r.default,{className:"ant-table-pagination",style:{margin:"15px"},size:"small",showTotal:(e,t)=>`\u5171\u8ba1 ${e} \u6761\u8bb0\u5f55`,showSizeChanger:!0,total:this.state.fwPage.totalRow,current:this.state.fwPage.pageNumber,pageSize:this.state.fwPage.pageSize,onChange:(e,t)=>this.pageChangeHandler(e,t),onShowSizeChange:(e,t)=>this.pageChangeHandler(e,t)}))),o.default.createElement(S,{style:{overflow:"auto",marginLeft:"20px",backgroundColor:"#ffffff"}},o.default.createElement(C.default,{innerLayout:this.state.rightListLayout,innerFwCoord:(0,p.default)({},this.props.fwCoord,{function:"rights",view:"rightList"}),openerSelectedData:this.state.openerSelectedData,style:{width:"90%"}}))),Object.values(this.state.dialogs))}})||g);t.default=k},LNo2:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("sRBo");var r=i(a("kaz8"));a("jCWc");var s=i(a("kPKH"));a("14J3");var n=i(a("BMrR")),d=i(a("MVZn"));a("B9cy");var u,c,f=i(a("Ol7k")),h=a("MuoO"),m=i(a("TzGd")),p=i(a("e/J2")),v=(i(a("usdK")),l(a("dNXO")),l(a("uYVn"))),g=i(a("wVw7"));f.default.Header,f.default.Footer,f.default.Sider,f.default.Content;function w(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout,o=e.grid,r=o.data,s=o.fwPage;return{loading:e.loading.models.grid,dispatch:a,fwCoord:l,layout:i,fwPage:s,data:r}}var y=e=>{return{getSelectData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getSelectData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},saveSelectData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/saveSelectData",payload:{fwCoord:a,fwParam:l,callback:i}})},validDeleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/validDeleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},deleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/deleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},getGridData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getGridData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},loadLayout:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,fwParam:l,callback:i}})}}},C=(u=(0,h.connect)(w,y),u(c=class extends o.Component{constructor(e){super(e),this.onSelectTreeNode=(e=>{e&&(console.info("selected tree node",e),this.setState({selectedTreeNodeId:e}))}),this.editDept=(e=>{this.state.components.tree.handleAction(e,"showEditInTree")}),this.createDept=(e=>{this.state.components.tree.handleAction(e,"showCreateChildInTree")}),this.deleteDept=(e=>{this.state.components.tree.handleAction(e,"deleteTreeNode")}),this.tempLayout=null,this.getLayout=(()=>{return this.tempLayout&&this.tempLayout!=this.props.innerLayout?this.tempLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(e=>{var t=(0,d.default)({},this.props.fwCoord,this.props.innerFwCoord);return e&&Object.keys(e).filter(t=>!!t&&!!e[t]).map(a=>t[a]=e[a]),t}),this.onFormRef=(e=>{this.props.form=e}),this.onComponentRef=((e,t)=>{this.state.components[e]=t}),this.getComponent=(e=>{return this.state.components[e]}),this.state=(0,d.default)({},e,{fwParam:(0,d.default)({},e.fwParam),buttonSize:e.buttonSize?e.buttonSize:"default",tableSize:e.tableSize?e.tableSize:"middle",showSelectCol:!!e.showSelectCol&&e.showSelectCol,dialogs:{},components:{},actionInList:[],treeFwCoord:(0,d.default)({},this.getFwCoord()),treeLayout:{isEmpty:!0,actions:[],columns:[],displayActions:[],gotResource:[]},selectedTreeNodeId:null,gridFwCoord:(0,d.default)({},this.getFwCoord()),gridLayout:{isEmpty:!0,actions:[],columns:[],displayActions:[]},gridToTreeField:null,gridOtherParams:{}});var t=(0,d.default)({},this.getFwCoord()),a=(0,d.default)({},this.getFwCoord()),l=null;this.getLayout().argument&&(this.getLayout().argument.treeFunction&&(t["function"]=this.getLayout().argument.treeFunction),this.getLayout().argument.treeView&&(t.view=this.getLayout().argument.treeView),this.getLayout().argument.gridFunction&&(a["function"]=this.getLayout().argument.gridFunction),this.getLayout().argument.gridView&&(a.view=this.getLayout().argument.gridView),l=this.getLayout().argument.gridToTreeField),this.props.loadLayout({fwCoord:t,fwParam:{},callback:e=>{this.setState({treeLayout:e,treeFwCoord:t})}}),this.props.loadLayout({fwCoord:a,fwParam:{},callback:e=>{this.setState({gridLayout:e,gridFwCoord:a,gridToTreeField:l})}})}componentWillReceiveProps(e){}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this)}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=null,t=null;return console.info("coord",this.getFwCoord()),o.default.createElement("div",{className:g.default.normal,style:{height:"100%"}},o.default.createElement("div",null,o.default.createElement(n.default,null,t),o.default.createElement(n.default,null,o.default.createElement(s.default,{span:24,style:{textAlign:"left"}},e))),o.default.createElement(n.default,{style:{height:"100%"}},o.default.createElement(s.default,{span:6,style:{height:"100%"}},o.default.createElement(n.default,{style:{height:"100%"}},o.default.createElement(s.default,{style:{padding:10,marginBottom:1,backgroundColor:"#ffffff",height:50}},o.default.createElement("b",null,"\u7ec4\u7ec7\u67b6\u6784")," \xa0\xa0\xa0",o.default.createElement("a",{href:"javascript:;",onClick:e=>this.createDept(e)},"\u65b0\u589e"),"\xa0\xa0\xa0",o.default.createElement("a",{href:"javascript:;",onClick:e=>this.editDept(e)},"\u7f16\u8f91"),"\xa0\xa0\xa0",o.default.createElement("a",{href:"javascript:;",onClick:e=>this.deleteDept(e)},"\u5220\u9664")),o.default.createElement(s.default,{style:(0,d.default)({backgroundColor:"#ffffff",overflow:"auto"},v.getFillHeight(50))},o.default.createElement(m.default,{innerLayout:this.state.treeLayout,style:{height:"100%"},innerFwCoord:this.state.treeFwCoord,fwParam:{showAsDialog:"1"},onRef:e=>this.onComponentRef("tree",e),showAsDialog:!0,openerSelectedData:this.state.selectedRecord,buttonSize:"small",tableSize:"small",showSelectCol:"checkbox",onSelectTreeNode:e=>this.onSelectTreeNode(e)})))),o.default.createElement(s.default,{span:18,style:{paddingLeft:10,paddingRight:10,height:"100%"}},o.default.createElement(n.default,{style:{backgroundColor:"#ffffff",padding:10,paddingLeft:10,marginBottom:1,height:40}},o.default.createElement(s.default,{span:4},o.default.createElement("b",null,"\u4eba\u5458\u5217\u8868")),o.default.createElement(s.default,{span:20},o.default.createElement(r.default,{checked:this.state.gridOtherParams.includeSubDepartment,onClick:()=>this.setState({gridOtherParams:(0,d.default)({},this.state.gridOtherParams,{includeSubDepartment:!this.state.gridOtherParams.includeSubDepartment})})},"\u5305\u542b\u4e0b\u7ea7\u90e8\u95e8\u4eba\u5458"))),o.default.createElement("div",{style:(0,d.default)({backgroundColor:"#ffffff"},v.getFillHeight(40))},o.default.createElement(p.default,{innerLayout:this.state.gridLayout,innerFwCoord:this.state.gridFwCoord,fwParam:{showAsDialog:"1"},onRef:e=>this.onComponentRef("grid",e),showAsDialog:!0,openerSelectedData:this.state.selectedRecord,gridToTreeField:"DEPARTMENTID",selectedTreeNodeId:this.state.selectedTreeNodeId,buttonSize:"small",tableSize:"small",showSelectCol:!1,otherParams:this.state.gridOtherParams})))),Object.values(this.state.dialogs))}})||c);t.default=C},Lpwu:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=f,t.logic=h,t.handleOk=m,t.handleCancel=p;var o=i(a("q1tI"));a("2qtc");var r=i(a("kLXV")),s=i(a("MVZn"));a("miYZ");var n=i(a("tsqr"));a("Pwec");var d=i(a("CtXQ")),u=l(a("uYVn")),c=i(a("MVSn"));function f(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],console.info("layout executed",this),o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(d.default,{type:this.action.icon}),this.action.label," "))}function h(e,t,l,i,d){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=d,null==l&&this.view.state.selectedRowKeys&&this.view.state.selectedRowKeys.length>0){var u=this.view.state.selectedRowKeys[0];this.record=this.view.state.data[u],this.recordIndex=u}if(this.record||null!=this.action.argument&&void 0!=this.action.argument.needSelectData&&null!=this.action.argument.needSelectData&&"1"!=this.action.argument.needSelectData){var f=(0,s.default)({},this.view.getFwCoord(),{view:"edit"});this.action.argument&&(this.action.argument.function&&(f["function"]=this.action.argument.function),this.action.argument.view&&(f["view"]=this.action.argument.view));var h={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{}},m=null;if(console.info("this.action",this.action),this.action.argument&&this.action.argument.antdPath){var p=this.action.argument.antdPath;m=a("RO01")(`./${p}`).default}else m=a("Tpzm").default;var v=e=>{this.innerLayout||(this.innerLayout={}),this.innerLayout[t]=e;var a=this.view.state.dialogs,l=(e.columns.filter(e=>e.visible),"50vw");a[this.id]=o.default.createElement(r.default,{width:l,key:this.id,title:o.default.createElement("span",null,e.title," \xa0\xa0 ",o.default.createElement(c.default,{selectedMember:e=>this.dialog.loadMemberInfo(e)})),visible:!0,maskClosable:!1,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u786e\u8ba4\u53d1\u5238",onOk:e=>this.handleOk(e)},o.default.createElement(m,{selectedData:this.record,innerLayout:e,innerFwCoord:f,fwParam:h,showAsDialog:!0,onRef:e=>this.onRef(e)})),this.view.setState({dialogs:a})};this.innerLayout&&this.innerLayout[t]?v(this.innerLayout[t]):this.view.props.loadLayout({fwCoord:f,fwParam:h,callback:v})}else n.default.error("\u8bf7\u9009\u62e9\u8981\u7f16\u8f91\u7684\u6570\u636e",5)}function m(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{var i=this.dialog.state.formData,o=this.dialog.state.fwParam.newData;if(!o.SID)return void n.default.error("\u8bf7\u9009\u62e9\u4f1a\u5458",5);Object.keys(i).map(e=>o[e]=i[e].value);var r=(0,s.default)({},this.dialog.state.fwParam,{newData:o});this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:r,callback:a=>{if(a.success)u.isEmpty(a.errorMsg)?n.default.success("\u4fdd\u5b58\u6210\u529f"):n.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}u.isEmpty(a.errorMsg)||n.default.error(a.errorMsg,10)}}})}})}function p(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},MZF9:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=c,t.logic=f,t.handleOk=h,t.handleCancel=m,t.isValid=p;var o=i(a("q1tI"));a("2qtc");var r=i(a("kLXV")),s=i(a("MVZn"));a("miYZ");var n=i(a("tsqr"));a("Pwec");var d=i(a("CtXQ")),u=l(a("uYVn"));function c(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(d.default,{type:this.action.icon}),this.action.label," "))}function f(e,t,l,i,d){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=d,console.info("event",d),null==l&&this.view.state.selectedRowKeys&&this.view.state.selectedRowKeys.length>0){var u=this.view.state.selectedRowKeys[0];this.record=this.view.state.data[u],this.recordIndex=u}if(this.record||null!=this.action.argument&&void 0!=this.action.argument.needSelectData&&null!=this.action.argument.needSelectData&&"1"!=this.action.argument.needSelectData){var c=(0,s.default)({},this.view.getFwCoord(),{view:"edit"});this.action.argument&&(this.action.argument.function&&(c["function"]=this.action.argument.function),this.action.argument.view&&(c["view"]=this.action.argument.view));var f={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{}},h=null;if(console.info("this.action",this.action),this.action.argument&&this.action.argument.antdPath){var m=this.action.argument.antdPath;h=a("RO01")(`./${m}`).default}else h=a("Tpzm").default;var p=e=>{this.innerLayout||(this.innerLayout={}),this.innerLayout[t]=e,this.view.props.getEditData({fwCoord:c,fwParam:(0,s.default)({},f,{selectedData:this.record}),callback:t=>{if(t||(t={}),t){var a=t["_FW_DYNAMIC_LAYOUT"];delete t["_FW_DYNAMIC_LAYOUT"],a&&a.columns&&a.columns.map(t=>{var a=e.columnMap[t.id];a&&Object.keys(t).map(e=>a[e]=t[e])});var l=this.view.state.dialogs,i=e.columns.filter(e=>e.visible),s=i.length<5?"25vw":"42vw";l[this.id]=o.default.createElement(r.default,{width:s,key:this.id,title:e.title,visible:!0,maskClosable:!1,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:this.action.argument&&this.action.argument.okLabel?this.action.argument.okLabel:"\u4fdd\u5b58",onOk:e=>this.handleOk(e)},o.default.createElement(h,{selectedData:this.record,innerLayout:e,innerFwCoord:c,fwParam:f,showAsDialog:!0,dataManaged:!0,initData:t,onRef:e=>this.onRef(e)})),this.view.setState({dialogs:l})}else n.default.error("\u52a0\u8f7d\u6570\u636e\u9519\u8bef",10)}})};this.innerLayout&&this.innerLayout[t]?p(this.innerLayout[t]):this.view.props.loadLayout({fwCoord:c,fwParam:f,callback:p})}else n.default.error("\u8bf7\u9009\u62e9\u8981\u7f16\u8f91\u7684\u6570\u636e",5)}function h(e){var t=this.dialog.state.form,a=this.dialog.state.formData;t.validateFieldsAndScroll((l,i)=>{if(l)console.info("edit error",l);else{if(this.dialog.doOtherInputValidate){var o=this.dialog.doOtherInputValidate();if(o){if("object"==typeof o){var r={};Object.keys(o).map(e=>{var t=a[e];r[e]=(0,s.default)({},t,{errors:[new Error(o[e])]})}),t.setFields(r)}else n.default.error(o);return}}var d={};d=this.dialog.state.fwParam.newData,Object.keys(a).map(e=>d[e]=a[e].value),this.dialog.processNewData&&this.dialog.processNewData(d);var c=(0,s.default)({},this.dialog.state.fwParam,{newData:d});this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:c,callback:a=>{if(this.dialog.processEditSaveResult&&this.dialog.processEditSaveResult(a),a.success)u.isEmpty(a.errorMsg)?n.default.success("\u4fdd\u5b58\u6210\u529f"):n.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e),this.event.fwSourceAction&&this.event.fwSourceAction.handleCancel&&this.event.fwSourceAction.handleCancel(3);else{if(a.validResultMap){var l={};Object.keys(a.validResultMap).map(e=>{l[e]={value:i[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(l)}u.isEmpty(a.errorMsg)||n.default.error(a.errorMsg,10)}}})}})}function m(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}function p(e,t,a){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.action.argument){var l=this.action.argument,i=l.showByColumn,o=l.showValue,r=l.showByEmpty;l.setValue,l.showInColumn;if(i){var s=a[i];return!!String(o).split(",").some(e=>e==s)||!(null!=s&&void 0!=s&&""!==s||!r)}return!0}return!0}},MwAd:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=u,t.logic=c,t.handleOk=f,t.handleCancel=h;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr")),s=i(a("MVZn"));a("Pwec");var n=i(a("CtXQ")),d=l(a("uYVn"));function u(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(n.default,{type:this.action.icon}),this.action.label," "))}function c(e,t,a,l,i,o){console.info("saverightlist",e),this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i;var n=e.getLayout(),u=n.ROLE_ID_KEY,c=n[u],f=(0,s.default)({},this.view.state.fwParam,{openerSelectedData:this.view.props.openerSelectedData});f.newData={},f.newData[u]=c,f.newListData=[];var h={},m={};f.newListData.push(h);var p=e.state.selectedResource;if(console.info("selectedResource",p),null!=p){var v=t=>{t&&t.map(t=>{(void 0==t.HAVE_PRIVILEGE||null==t.HAVE_PRIVILEGE||"1"==t.HAVE_PRIVILEGE&&!p[t.PKEY]||"1"!=t.HAVE_PRIVILEGE&&p[t.PKEY])&&(m[t.PKEY]=t,h[t.PKEY]={HAVE_PRIVILEGE:p[t.PKEY]?"1":"0",DATA_LEVEL:e.getDataLevel(t)?Object.keys(e.getDataLevel(t)).filter(a=>"1"==e.getDataLevel(t)[a]).join(","):""}),v(t.nodes)})};v(e.getLayout().gotResource)}else Object.values(e.state.changedResource).map(t=>h[t.PKEY]={HAVE_PRIVILEGE:e.isResourceChecked(t),DATA_LEVEL:e.getDataLevel(t)?Object.keys(e.getDataLevel(t)).filter(a=>"1"==e.getDataLevel(t)[a]).join(","):""});var g=e=>{if(e.success&&Object.keys(h).map(e=>m[e].HAVE_PRIVILEGE=h[e].HAVE_PRIVILEGE),o)o(e);else if(e.success)d.isEmpty(e.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(e.errorMsg,10);else{if(e.validResultMap){var t={};Object.keys(e.validResultMap).map(a=>{t[a]={value:values[a],errors:[new Error(e.validResultMap[a])]}}),form.setFields(t)}d.isEmpty(e.errorMsg)||r.default.error(e.errorMsg,10)}};this.view.props.saveSelectData({fwCoord:this.view.getFwCoord(),fwParam:f,callback:g})}function f(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{a?console.info("error",a):(console.info("values",l,this.dialog.props.fwParam.oldData),this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:(0,s.default)({},this.dialog.state.fwParam),callback:a=>{if(a.success)d.isEmpty(a.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(a.errorMsg,10),this.dialog.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}d.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}}))})}function h(e){var t=this.dialog.state.dialogs;delete t[this.id],this.dialog.setState({dialogs:t})}},OKjh:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=s,t.logic=n,t.handleOk=d,t.handleCancel=u;var o=i(a("q1tI"));a("Pwec");var r=i(a("CtXQ"));l(a("uYVn"));function s(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(r.default,{type:this.action.icon}),this.action.label," "))}function n(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i}function d(e){}function u(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},RO01:function(e,t,a){var l={"./doc_in_wechat.ejs":"iPio","./doc_with_map.ejs":"dMwA","./document.ejs":"nAcz","./fw":"JQVR","./fw/":"JQVR","./fw/create/create":"Yn9z","./fw/create/create.js":"Yn9z","./fw/detail/detail":"E6qp","./fw/detail/detail.js":"E6qp","./fw/edit/edit":"Tpzm","./fw/edit/edit.js":"Tpzm","./fw/grid/grid":"e/J2","./fw/grid/grid.css":"wVw7","./fw/grid/grid.js":"e/J2","./fw/index":"JQVR","./fw/index.js":"JQVR","./fw/login/login":"tXEN","./fw/login/login.css":"X05j","./fw/login/login.js":"tXEN","./fw/main/_layout_no_use":"lV+C","./fw/main/_layout_no_use.js":"lV+C","./fw/main/main":"kw1y","./fw/main/main.js":"kw1y","./fw/map/mapPage":"i307","./fw/map/mapPage.js":"i307","./fw/role_right/right_list":"1jeA","./fw/role_right/right_list.js":"1jeA","./fw/role_right/role_right":"Kuan","./fw/role_right/role_right.js":"Kuan","./fw/tree/tree":"TzGd","./fw/tree/tree.css":"FsLl","./fw/tree/tree.js":"TzGd","./projects/zd4s/afterServicePlatfrom":"jqXu","./projects/zd4s/afterServicePlatfrom.js":"jqXu","./projects/zd4s/afterServicePlatfrom.less":"oRBY","./projects/zd4s/biActiveMember":"vDnF","./projects/zd4s/biActiveMember.js":"vDnF","./projects/zd4s/biActiveMember.less":"yQIY","./projects/zd4s/biBack":"tQfK","./projects/zd4s/biBack.js":"tQfK","./projects/zd4s/biBack.less":"cSmS","./projects/zd4s/biInsurance":"73Di","./projects/zd4s/biInsurance.js":"73Di","./projects/zd4s/biInsurance.less":"gG1N","./projects/zd4s/biMainBoard":"VMik","./projects/zd4s/biMainBoard.js":"VMik","./projects/zd4s/biMainBoard.less":"auUU","./projects/zd4s/biNewMember":"LrAz","./projects/zd4s/biNewMember.js":"LrAz","./projects/zd4s/biNewMember.less":"uEfT","./projects/zd4s/create_customer":"84t4","./projects/zd4s/create_customer.js":"84t4","./projects/zd4s/create_member":"SgG7","./projects/zd4s/create_member.js":"SgG7","./projects/zd4s/demo_page":"CRJk","./projects/zd4s/demo_page.js":"CRJk","./projects/zd4s/detail_remind":"Rdxd","./projects/zd4s/detail_remind.js":"Rdxd","./projects/zd4s/detail_service":"H08f","./projects/zd4s/detail_service.js":"H08f","./projects/zd4s/edit_4s_setting":"g4V7","./projects/zd4s/edit_4s_setting.js":"g4V7","./projects/zd4s/edit_customer":"Cl18","./projects/zd4s/edit_customer.js":"Cl18","./projects/zd4s/edit_member":"3ICH","./projects/zd4s/edit_member.js":"3ICH","./projects/zd4s/edit_out_store":"r0dD","./projects/zd4s/edit_out_store.js":"r0dD","./projects/zd4s/edit_wash_car_ticket_single":"I3cm","./projects/zd4s/edit_wash_car_ticket_single.js":"I3cm","./projects/zd4s/grid_member_distribute":"+Se9","./projects/zd4s/grid_member_distribute.js":"+Se9","./projects/zd4s/grid_role":"qx2S","./projects/zd4s/grid_role.js":"qx2S","./projects/zd4s/insuranceWorkbench":"kklg","./projects/zd4s/insuranceWorkbench.js":"kklg","./projects/zd4s/insuranceWorkbench.less":"cc/Q","./projects/zd4s/mainPage":"U5mO","./projects/zd4s/mainPage.js":"U5mO","./projects/zd4s/mainPage.less":"vT1B","./projects/zd4s/memberCarPrice":"hErz","./projects/zd4s/memberCarPrice.js":"hErz","./projects/zd4s/memberDetail":"yOrV","./projects/zd4s/memberDetail.js":"yOrV","./projects/zd4s/memberIncreaseTrend":"fCJL","./projects/zd4s/memberIncreaseTrend.js":"fCJL","./projects/zd4s/memberInput":"1Zpd","./projects/zd4s/memberInput.js":"1Zpd","./projects/zd4s/memberInput.less":"YEhg","./projects/zd4s/memberSource":"j8Rg","./projects/zd4s/memberSource.js":"j8Rg","./projects/zd4s/memberToShopDistance":"3JxF","./projects/zd4s/memberToShopDistance.js":"3JxF","./projects/zd4s/serviceWorkbench":"2Mcj","./projects/zd4s/serviceWorkbench.js":"2Mcj","./projects/zd4s/serviceWorkbench.less":"Ez7f","./projects/zd4s/tree_right":"+B/R","./projects/zd4s/tree_right.js":"+B/R","./projects/zd4s/treegrid_back_user":"LNo2","./projects/zd4s/treegrid_back_user.js":"LNo2","./projects/zd4s/treegrid_front_user":"n5aT","./projects/zd4s/treegrid_front_user.js":"n5aT","./projects/zd4s/wechat_bind":"tfIL","./projects/zd4s/wechat_bind.js":"tfIL","./projects/zd4s/wechat_device_location":"qZBF","./projects/zd4s/wechat_device_location.js":"qZBF","./projects/zd4s/wechat_member_center":"aZJG","./projects/zd4s/wechat_member_center.js":"aZJG","./projects/zd4s/wechat_member_location":"Ar0Q","./projects/zd4s/wechat_member_location.js":"Ar0Q","./projects/zd4s/wechat_member_track":"f6O1","./projects/zd4s/wechat_member_track.js":"f6O1","./projects/zd4s/wechat_one_key_rescue":"7uls","./projects/zd4s/wechat_one_key_rescue.js":"7uls","./projects/zd4s/wechat_service_bill":"pZDi","./projects/zd4s/wechat_service_bill.js":"pZDi","./projects/zd4s/wechat_wash_car":"Wwp8","./projects/zd4s/wechat_wash_car.js":"Wwp8","./projects/zd4s/wechat_wash_car.less":"oHED","./testForm":"jb5L","./testForm.js":"jb5L","./testForm1":"ooYG","./testForm1.js":"ooYG","./testMap":"Pc0k","./testMap.js":"Pc0k","./testMobile":"2zm6","./testMobile.js":"2zm6","./testModal":"t+RK","./testModal.js":"t+RK","./testTree":"UHqf","./testTree.js":"UHqf"};function i(e){var t=o(e);return a(t)}function o(e){var t=l[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}i.keys=function(){return Object.keys(l)},i.resolve=o,e.exports=i,i.id="RO01"},Rdxd:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("g9YV");var r=i(a("wCAj"));a("14J3");var s=i(a("BMrR"));a("jCWc");var n=i(a("kPKH"));a("giR+");var d=i(a("fyUT"));a("Xi6J");var u=i(a("kl6h"));a("iQDF");var c=i(a("+eQT"));a("nRaC");var f=i(a("5RzL"));a("T2oS");var h=i(a("W9HT"));a("sRBo");var m=i(a("kaz8")),p=i(a("pVnL")),v=i(a("MVZn"));a("7Kak");var g=i(a("9yH6"));a("OaEy");var w=i(a("2fM7"));a("5NDa");var y=i(a("5rEg"));a("y8nQ");var C=i(a("Vl3Y"));a("ozfa");var D=i(a("MJZm")),E=a("MuoO"),b=(i(a("QCDS")),l(a("dNXO"))),S=i(a("wd/R"));a("XDpg");var L,P,k=i(a("DQt+"));S.default.locale("zh-cn");var I=D.default.TreeNode,R=C.default.Item,T=y.default.TextArea,A=w.default.Option,_=g.default.Group,O={labelCol:{xs:{span:8},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16}}};function M(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.edit,dispatch:a,fwCoord:l,layout:i}}var F=e=>{return{getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})}}},N=(L=(0,E.connect)(M,F),L(P=class extends o.Component{constructor(e){super(e),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,v.default)({},this.state.fwParam,{openerSelectedData:(0,v.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,v.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(I,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+","+(t.valueRef.otherRefs?t.valueRef.otherRefs:""),selectedTreeNodeId:e.props.eventKey},callback:e=>{i.children=e.data,a.defaultOpen=!0,console.info(a.data),l(),this.setState({refData:this.state.refData})}}))})),this.getInputComponent=(e=>{var t=this.state,a=t.components,l=t.refData,i=t.fwParam,r=t.formData,s=null,n={disabled:!e.editable,style:{width:"90%"}};if("MEMO"===e.type&&(s=o.default.createElement(T,(0,p.default)({},n,{rows:4}))),"checkbox01"===e.ui)s=o.default.createElement(m.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictMap[e.dictionary]){var C=this.getLayout().dictMap[e.dictionary];s="radio"==e.ui?o.default.createElement(_,(0,p.default)({name:e.id},n),Object.keys(C).map(e=>o.default.createElement(g.default,{key:e,value:e},C[e]))):o.default.createElement(w.default,n,Object.keys(C).map(e=>o.default.createElement(A,{key:e,value:e},C[e])))}else if("TreeSelect"===e.ui&&e.valueRef){var D=e.valueRef;if(!l[e.id]){var E=null;D.function==this.props.fwParam.openerFunction&&D.view==this.props.fwParam.openerView&&this.props.treeData&&(E=this.props.treeData),l[e.id]={loading:!1,data:E,queryIndex:0,defaultOpen:!1}}var b=l[e.id];b.data||(console.info("before remote call"),b.data=[],this.props.getTreeData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:D.function,view:D.view}),fwParam:{distinct:D.distinct?D.distinct:null,queryColumns:D.value+","+D.label+","+(D.otherRefs?D.otherRefs:"")},callback:t=>{t.success?(b.data=t.data,console.info("result.data",b.data),b.loading=!1,l[e.id]=b,this.setState({refData:l})):b.data=null}})),console.info("before render ",b.data),s=o.default.createElement(f.default,(0,p.default)({},n,{placeholder:e.prompt?e.prompt:"\u8bf7\u9009\u62e9",notFoundContent:b.loading?o.default.createElement(h.default,{size:"small"}):null,showArrow:!0,filterOption:!1,loadData:t=>this.onTreeSelectLoadData(t,e,b),treeExpandedKeys:b.expandedKeys?b.expandedKeys:b.data.map(e=>String(e[D.value])),onTreeExpand:e=>{b.expandedKeys=e,b.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:b.defaultOpen,onSearch1:t=>{b.timeout&&(clearTimeout(b.timeout),b.timeout=null),b.currentValue=t;var a=()=>{console.info(t),b.loading=!0,this.props.getRefData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:D.function,view:D.view}),fwParam:{queryStr:t,distinct:D.distinct?D.distinct:null,queryColumns:D.value+","+D.label+","+(D.otherRefs?D.otherRefs:"")},callback:a=>{b.currentValue==t&&(b.data=a.data,b.loading=!1,b.defaultOpen=!0,r[e.id].value=t,this.setState({refData:l,fwParam:i,formData:r}))}})};b.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(b.data,D))}else if(null!=e.valueRef){var S=e.valueRef;if(!l[e.id]){console.info(i.newData);var L={};L[S.value]=r[e.id]?r[e.id].value:0,e.showColumn&&r[e.showColumn]&&(console.info("showcolumn",e.showColumn,r),L[S.label]=r[e.showColumn].value),l[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:l})}var P=l[e.id];P.data||(console.info("before remote call"),P.data=[],this.props.getRefData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:S.function,view:S.view}),fwParam:{distinct:S.distinct?S.distinct:null,queryColumns:S.value+","+S.label+","+(S.otherRefs?S.otherRefs:"")},callback:t=>{var a,i=[];(t.success&&(i=t.data),e.showColumn)&&function(){console.info("showColumn",r[e.showColumn],r[e.id]);var t=r[e.showColumn]&&r[e.showColumn].value?r[e.showColumn].value.split(","):[],l=r[e.id]&&r[e.id].value?r[e.id].value.split(","):[],o=null;if(l.length>0&&t.length==l.length)for(a=0;a<l.length;++a)i.filter(e=>e[S.value]==l[a])||(o={},o[S.value]=l[a],o[S.label]=t[a],i.push(o))}();console.info("this.state.fwParam.newData",this.state.fwParam.newData),P.data=i,P.loading=!1,l[e.id]=P,this.setState({refData:l,formData:r})}}));var k=P.data.map(e=>o.default.createElement(A,{key:e[S.value]},e[S.label],S.otherRefs?S.otherRefs.split(",").map(t=>{e[t]}):""));s=o.default.createElement(w.default,(0,p.default)({},n,{showSearch:!0,placeholder:e.prompt,mode:e.multiSelect?"multiple":null,notFoundContent:P.loading?o.default.createElement(h.default,{size:"small"}):null,showArrow:!0,filterOption:!1,labelInValue:!0,autoFocus:P.autoFocus,defaultOpen:P.defaultOpen,onBlur:()=>console.info("blur"),onSearch:t=>{P.timeout&&(clearTimeout(P.timeout),P.timeout=null),P.currentValue=t;var a=()=>{P.loading=!0,this.props.getRefData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:S.function,view:S.view}),fwParam:{queryValue:t,distinct:S.distinct?S.distinct:null,queryColumns:S.value+","+S.label+","+(S.otherRefs?S.otherRefs:"")},callback:a=>{if(P.currentValue==t){var o,s=[];if(a.success&&(s=a.data),e.showColumn)(function(){var t=r[e.showColumn]&&r[e.showColumn].value?r[e.showColumn].value.split(","):[],a=r[e.id]&&r[e.id]?String(r[e.id].value).split(","):[],l=null;if(a.length>0&&t.length==a.length)for(o=0;o<a.length;++o)s.filter(e=>e[S.value]==a[o])||(l={},l[S.value]=a[o],l[S.label]=t[o],s.push(l))})();console.info("this.state.fwParam.newData2",this.state.fwParam.newData),P.data=s,P.loading=!1,P.defaultOpen=!0,P.autoFocus=!0,this.setState({refData:l,fwParam:i})}}})};P.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange"),console.info(e)}}),k)}else{if("DatePicker"===e.ui)return o.default.createElement(c.default,n);if("TimePicker"===e.ui)return o.default.createElement(u.default,n);if("InputNumber"===e.ui)return o.default.createElement(d.default,n);"Upload"===e.ui||("MAP"==e.ui?(console.info("col.ui",e.ui),s=o.default.createElement(y.default,(0,p.default)({},n,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn)}return s||(s=o.default.createElement(y.default,(0,p.default)({},n,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u8f93\u5165"}))),a[e.id]=s,s}),this.handleFormChange=(e=>{e&&(Object.keys(e).map(t=>{var a=e[t],l=this.getLayout().columnMap[t],i=l.ui,o=null;if(a&&null!=a.value)if(this.state.formData[t]||(this.state.formData[t]={}),o=a.value,"DatePicker"===i)o=a.value.format(l.pattern?l.pattern:"YYYY-MM-DD");else if("TimePicker"===i)o=a.value.format(l.pattern?l.pattern:"HH:mm:ss");else if("checkbox01"===i)o=a.value?"1":"0";else if(l.valueRef&&"TreeSelect"!=l.ui){if(o=a.value.filter(e=>e&&e.key).map(e=>e.key).join(","),l.showColumn){var r=this.getLayout().columnMap[l.showColumn.split(",")[0]];if(r){var s=a.value.map(e=>Array.isArray(e.label)?e.label[0]:e.label).join(",");this.state.formData[r.id]||(this.state.formData[r.id]={}),this.state.formData[r.id].value=s}}}else"MAP"==l.ui&&(o=this.state.formData[t].value,a.dirty=!0);a.value=o}),this.setState({formData:(0,v.default)({},this.state.formData,e)}))}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],o=i;if(e.onFormat)o=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var r=this.getLayout().dictMap[e.dictionary][i];o=r||i}else e.showColumn&&(o=e.showColumn.split(",").map(e=>t[e]).join(" "));return o}),this.getLayout=(()=>{return this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,v.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return b.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.CustomizedForm=C.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t={};return this.getLayout().columns.filter(e=>e.visible).map(e=>{var a=(0,v.default)({},this.state.formData[e.id]);if(a&&null!=a.value)if("DatePicker"===e.ui)a.value=a.value?(0,S.default)(a.value,e.pattern?e.pattern:"YYYY-MM-DD"):a.value;else if("TimePicker"===e.ui)a.value=a.value?(0,S.default)(a.value,e.pattern?e.pattern:"HH:mm:ss"):a.value;else if("checkbox01"===e.ui)a.value="1"==a.value;else if(e.valueRef&&"TreeSelect"!=e.ui){if(Array.isArray(a.value)||(a.value?a.value=String(a.value).split(",").map(e=>({key:e})):a.value=[]),e.showColumn){var l=this.state.formData[e.showColumn.split(",")[0]];l&&l.value&&l.value.split(",").map((e,t)=>a.value.length>t?a.value[t].label=e:null)}}else"MAP"==e.ui||("NUM"!=e.type||e.dictionary?a.value=String(a.value):e.decimalSize>0?a.value=parseFloat(a.value):a.value=parseInt(a.value));t[e.id]=C.default.createFormField((0,v.default)({},a))}),t},onValuesChange(e,t){}})(e=>{this.state.form=e.form;e.form.getFieldDecorator;var t=this.getLayout().columns.filter(e=>e.visible),a={_default:[]},l={};this.getLayout().columnGroups&&this.getLayout().columnGroups.map(e=>l[e.id]=e),t.map(e=>{var t="_default";e.group&&l[e.group]&&(t=e.group),a[t]||(a[t]=[]),a[t].push(e)});var i=e=>e?e.map(e=>{return o.default.createElement(n.default,{span:t.length>5?12:24,key:e.id,style:{height:24}},o.default.createElement(R,(0,p.default)({},O,{label:e.label}),this.getDisplayValue(e)," ",e.tail))}):[],r=[];return Object.keys(a).length>1?["_default",...this.getLayout().columnGroups.map(e=>e.id)].map(e=>{l[e]&&a[e]&&a[e].length>0&&r.push(o.default.createElement(n.default,{span:24,key:"group_"+e,style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,l[e].title))),r=[...r,...i(a[e])]}):r=i(t),o.default.createElement(C.default,null,o.default.createElement(s.default,{gutter:1},r))}),this.state=(0,v.default)({},e,{form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{},memberInfo:{},vehicleInfo:{},listData:[]})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData;t.newData=(0,v.default)({},this.props.initData),t.oldData=(0,v.default)({},this.props.initData);var l=this.props.initData,i=l.memberInfo,o=l.vehicleInfo,r=l.listData;Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.setState({fwParam:this.state.fwParam,formData:a,refData:{},memberInfo:i,vehicleInfo:o,listData:r})}else if(this.props.showAsDialog){var s=(0,v.default)({},this.state.fwParam,{oldData:{},newData:{},selectedData:this.props.selectedData});this.props.getEditData({fwCoord:this.getFwCoord(),fwParam:s,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData;a.newData=(0,v.default)({},e),a.oldData=(0,v.default)({},e),Object.keys(e).map(t=>l[t]={value:e[t]}),this.setState({fwParam:this.state.fwParam,formData:l,refData:{}})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null)}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){this.CustomizedForm;return o.default.createElement("div",null,o.default.createElement(h.default,{spinning:this.props.loading},o.default.createElement(s.default,{id:"memberInfo",gutter:1,style:{paddingBottom:10}},o.default.createElement(n.default,{span:4},o.default.createElement(k.default,{sex:this.state.memberInfo.SEX,memberLevel:this.state.memberInfo.LEVEL,headImage:this.state.memberInfo.WECHAT_HEADIMGURL})),o.default.createElement(n.default,{span:20},o.default.createElement(s.default,null,o.default.createElement(n.default,{span:5},o.default.createElement("span",{style:{fontSize:"16px",fontWeight:"bold"}},this.state.memberInfo.NAME),"0"===this.state.memberInfo.SEX?"\uff08\u5148\u751f\uff09":"\uff08\u5973\u58eb\uff09"),o.default.createElement(n.default,{span:14}," ")),o.default.createElement(s.default,null,o.default.createElement(n.default,{span:6},"\u624b\u673a\u53f7\uff1a",this.state.memberInfo.MOBILE_NO),o.default.createElement(n.default,{span:6},"\u8f66\u724c\uff1a",this.state.vehicleInfo.VEHICLE_NUM),o.default.createElement(n.default,{span:6},"VIN\u7801\uff1a",this.state.vehicleInfo.VIN),o.default.createElement(n.default,{span:6},"\u8f66\u578b\uff1a",this.state.vehicleInfo.CAR_MODEL)))),o.default.createElement(s.default,{id:"followInfo"},o.default.createElement(r.default,{loading:this.props.loading,columns:this.getLayout().columns.filter(e=>e.visible).map(e=>{return"_FW_ACTIONS"==e.id?(this.OP_COL.title=e.label,this.OP_COL):(e.title=e.label,e.dataIndex=e.id,e.onFormat?e.render=((t,l,i)=>a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(t,l,i,e,this)):e.dictionary?e.render=((t,a,l)=>{var i=this.getLayout().dictMap[e.dictionary][t];return i||t}):e.showColumn&&(e.render=((t,a,l)=>e.showColumn.split(",").map(e=>a[e]).join(" "))),e)}),dataSource:this.state.listData,pagination:!1,rowKey:"fw_index",size:this.state.tableSize,bordered:!0,rowSelection:this.state.showSelectCol?{type:this.state.showSelectCol,selectedRowKeys:this.state.data.filter(e=>e.selected||void 0==e.selected&&e.FW_SELECTED).map(e=>e.fw_index),onSelect:(e,t,a,l)=>{e.selected=t,this.setState({data:this.state.data})},onSelectAll:(e,t,a)=>{this.state.data.map(t=>t.selected=e),this.setState({data:this.state.data})}}:null}))))}})||P);t.default=N},SFtx:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=c,t.logic=f,t.handleOk=h,t.handleCancel=m;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr"));a("2qtc");var s=i(a("kLXV")),n=i(a("MVZn"));a("Pwec");var d=i(a("CtXQ")),u=l(a("uYVn"));function c(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],console.info("layout executed",this),o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(d.default,{type:this.action.icon}),this.action.label," "))}function f(e,t,l,i,r){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=r;var d=this.view.getLayout().argument.treeIdField,u=this.view.getLayout().argument.treeParentIdField;if(null==this.record){var c=null;this.view.state.selectedKeys&&this.view.state.selectedKeys.length>0&&(c=this.view.state.selectedKeys[0]);var f=null;c&&(f=this.view.findNode(c)),this.record=f}null==this.record||e.getLayout().argument.treeCanAddRoot,this.record=(0,n.default)({},this.record,{children:null});var h=(0,n.default)({},this.view.getFwCoord(),{view:"create"});this.view.getLayout().argument&&this.view.getLayout().argument.treeFunction&&(h["function"]=this.view.getLayout().argument.treeFunction);var m={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{},selectedTreeNodeId:this.record?this.record[d]:null},p=null;if(this.action.argument&&this.action.argument.antdPath){var v=this.action.argument.antdPath;p=a("RO01")(`./${v}`).default}else p=a("Yn9z").default;var g=e=>{e.columns.filter(e=>e.id==u).map(e=>e.editable=null!=this.record),this.innerLayout||(this.innerLayout={}),this.innerLayout[t]=e;var a=this.view.state.dialogs,l={};console.info("this.record",this.record),l[u]=this.record&&this.record.GOT_PID?this.record.GOT_PID:this.view.state.treeData[0][d];var i=e.columns.filter(e=>e.visible),r=i.length>=5||i.some(e=>"MAP"==e.ui)?"42vw":"25vw";a[this.id]=o.default.createElement(s.default,{width:r,key:this.id,title:e.title,visible:!0,confirmLoading:this.view.props.createLoading,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4fdd\u5b58",onOk:e=>this.handleOk(e)},o.default.createElement(p,{selectedData:{},innerLayout:e,innerFwCoord:h,fwParam:m,clientNewData:l,showAsDialog:!0,onRef:e=>this.onRef(e),treeData:this.view.state.treeData})),this.view.setState({dialogs:a})};this.innerLayout&&this.innerLayout[t]?g(this.innerLayout[t]):this.view.props.loadLayout({fwCoord:h,fwParam:m,callback:g})}function h(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{var i=this.dialog.state.formData,o=this.dialog.state.fwParam.newData;Object.keys(i).map(e=>o[e]=i[e].value);var s=(0,n.default)({},this.dialog.state.fwParam,{newData:o,selectedData:this.record});this.dialog.props.saveCreateData({fwCoord:this.dialog.getFwCoord(),fwParam:s,callback:a=>{if(a.success){u.isEmpty(a.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(a.errorMsg,10);var i=a.resultData,o=i[this.view.getLayout().argument.treeParentIdField],s=this.view.state.treeData;if(o){var n=this.view.findNode(o);console.info("parentNode",n),n&&(n.children?n.children.push(i):n.GOT_SUBCOUNT?n.GOT_SUBCOUNT+=1:n.GOT_SUBCOUNT=1)}else s.push(i);this.view.setState({treeData:s}),this.handleCancel(e)}else{if(a.validResultMap){var d={};Object.keys(a.validResultMap).map(e=>{d[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(d)}u.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}})}})}function m(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},SgG7:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("IzEo");var r=i(a("bx4M"));a("14J3");var s=i(a("BMrR"));a("jCWc");var n=i(a("kPKH"));a("5Dmo");var d=i(a("3S7+")),u=i(a("2mBW"));a("miYZ");var c=i(a("tsqr"));a("giR+");var f=i(a("fyUT"));a("Xi6J");var h=i(a("kl6h"));a("iQDF");var m=i(a("+eQT"));a("O3gP");var p=i(a("lrIw"));a("6UJt");var v=i(a("DFOY"));a("nRaC");var g=i(a("5RzL"));a("T2oS");var w=i(a("W9HT")),y=i(a("pVnL")),C=i(a("MVZn"));a("sRBo");var D=i(a("kaz8"));a("7Kak");var E=i(a("9yH6"));a("OaEy");var b=i(a("2fM7"));a("5NDa");var S=i(a("5rEg"));a("y8nQ");var L=i(a("Vl3Y"));a("ozfa");var P=i(a("MJZm"));a("B9cy");var k,I,R=i(a("Ol7k")),T=a("MuoO"),A=(i(a("QCDS")),i(a("YEhg"))),_=l(a("uYVn")),O=l(a("dNXO")),M=i(a("wd/R"));a("XDpg"),M.default.locale("zh-cn");R.default.Header,R.default.Footer,R.default.Sider,R.default.Content;var F=P.default.TreeNode,N=L.default.Item,j=S.default.TextArea,V=b.default.Option,x=E.default.Group,z=D.default.Group,Y={labelCol:{span:6},wrapperCol:{span:18}},G={labelCol:{span:10},wrapperCol:{span:14}},q={labelCol:{span:4},wrapperCol:{span:20}};function U(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.create,dispatch:a,fwCoord:l,layout:i}}var B=e=>{return{getCreateData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"create/getCreateData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveCreateData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"create/saveCreateData",payload:{fwCoord:a,fwParam:l,callback:i}})},loadLayout:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,fwParam:l,callback:i}})}}},K=(k=(0,T.connect)(U,B),k(I=class extends o.Component{constructor(e){super(e),this.loadCascaderData=((e,t)=>{var a=e[e.length-1];a.loading=!0;var l=t.valueRef,i=e=>{return e?e.map(e=>{return e.value=e[l.value],e.label=e[l.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e.children&&(e.children=i(e.children)),e}):null};this.getTreeData({fwCoord:(0,C.default)({},this.getFwCoord(),{function:l.function,view:l.view}),fwParam:{distinct:l.distinct?l.distinct:null,queryColumns:l.value+","+l.label+","+(l.otherRefs?l.otherRefs:""),selectedTreeNodeId:e.map(e=>e[l.value]).join(",")},callback:e=>{a.loading=!1,a.children=i(e.data),this.setState({refData:this.state.refData})}})}),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,C.default)({},this.state.fwParam,{openerSelectedData:(0,C.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,C.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(F,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,C.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+","+(t.valueRef.otherRefs?t.valueRef.otherRefs:""),selectedTreeNodeId:e.props.eventKey},callback:e=>{i.children=e.data,a.defaultOpen=!0,console.info(a.data),l(),this.setState({refData:this.state.refData})}}))})),this.onCascaderChange=((e,t,a)=>{if(console.info("onCascaderChange",e.id,t,a),"ADDRESS_SELECT"==e.id){var l=this.state,i=l.fwParam,o=l.formData,r=l.manualValues;i.newData||(i.newData={}),i.newData[e.id]=t.join(","),o[e.id]||(o[e.id]={}),o[e.id].value=t.join(","),r[e.id]=t,this.setState({fwParam:i,manualValues:r,formData:o})}}),this.onAutoCompleteSelect=((e,t,a)=>{console.info("onAutoCompleteSelect",e.id,t,a)}),this.onSelectChange=((e,t,a)=>{console.info("onSelectChange",e.id,t,a)}),this.onSelectSelect=((e,t,a)=>{console.info("onSelectSelect",e.id,t,a)}),this.MONEY_IDS={BIZ_INS_DUE:150,FORCE_INS_DUE:150,BIZ_INS_DAMEGE:80,BIZ_INS_THIRD:80,BIZ_INS_OTHER:80,FORCE_INS_AMOUNT:80,STEAL_INS_AMOUNT:80,GPS_DEVICE_NO:"78%",ADDRESS_SELECT:"40%",ADDRESS:"50%"},this.getInputComponent=((e,t)=>{var a=this.state,l=a.components,i=a.refData,r=a.fwParam,s=a.formData,n=null,d={disabled:!e.editable,style:{width:this.MONEY_IDS[e.id]?this.MONEY_IDS[e.id]:"90%"}};t&&(d.value=this.state.manualValues[e.id]);var u="",L="";if(e.editable&&(u=e.prompt?e.prompt:"\u8bf7\u8f93\u5165",L=e.prompt?e.prompt:"\u8bf7\u9009\u62e9"),"label"==e.ui)n=this.getDisplayValue(e);else if("MEMO"===e.type)n=o.default.createElement(j,(0,y.default)({},d,{rows:4}));else if("checkbox01"===e.ui)n=o.default.createElement(D.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictList[e.dictionary]){var P=this.getLayout().dictList[e.dictionary];if("radio"==e.ui)n=o.default.createElement(x,(0,y.default)({name:e.id},d),P.map(e=>o.default.createElement(E.default,{key:e.value,value:String(e.value)},e.label)));else if("checkbox"==e.ui){var k=P;n=o.default.createElement(z,(0,y.default)({name:e.id},d,{options:k}))}else n=o.default.createElement(b.default,d,P.map(e=>o.default.createElement(V,{key:e.value,value:e.value},e.label)))}else if("TreeSelect"===e.ui&&e.valueRef){var I=e.valueRef;if(!i[e.id]){var R=null;I.function==this.props.fwParam.openerFunction&&I.view==this.props.fwParam.openerView&&this.props.treeData&&(R=this.props.treeData),i[e.id]={loading:!1,data:R,queryIndex:0,defaultOpen:!1}}var T=i[e.id];T.data||(T.data=[],this.props.getTreeData({fwCoord:(0,C.default)({},this.getFwCoord(),{function:I.function,view:I.view}),fwParam:{distinct:I.distinct?I.distinct:null,queryColumns:I.value+","+I.label+","+(I.otherRefs?I.otherRefs:"")},callback:t=>{t.success?(T.data=t.data,console.info("result.data",T.data),T.loading=!1,i[e.id]=T,this.setState({refData:i})):T.data=null}})),n=o.default.createElement(g.default,(0,y.default)({},d,{placeholder:L,notFoundContent:T.loading?o.default.createElement(w.default,{size:"small"}):null,showArrow:!0,showSearch:!0,searchPlaceholder:"\u8f93\u5165\u641c\u7d22",filterTreeNode:(e,t)=>{return console.info("treeNode",t),t.props.title.indexOf(e)>=0},treeNodeFilterProp:"title",filterOption:!1,loadData:t=>this.onTreeSelectLoadData(t,e,T),treeExpandedKeys:T.expandedKeys?T.expandedKeys:T.data.map(e=>String(e[I.value])),onTreeExpand:e=>{T.expandedKeys=e,T.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:T.defaultOpen,onSearch1:t=>{T.timeout&&(clearTimeout(T.timeout),T.timeout=null),T.currentValue=t;var a=()=>{console.info(t),T.loading=!0,this.props.getRefData({fwCoord:(0,C.default)({},this.getFwCoord(),{function:I.function,view:I.view}),fwParam:{queryStr:t,distinct:I.distinct?I.distinct:null,queryColumns:I.value+","+I.label+","+(I.otherRefs?I.otherRefs:"")},callback:a=>{T.currentValue==t&&(T.data=a.data,T.loading=!1,T.defaultOpen=!0,s[e.id].value=t,this.setState({refData:i,fwParam:r,formData:s}))}})};T.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(T.data,I))}else if("Cascader"==e.ui&&e.valueRef){var A=e.valueRef;if(!i[e.id]){var _={};_[A.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),_[A.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var O=i[e.id];O.data||(O.data=[],this.props.getTreeData({fwCoord:(0,C.default)({},this.getFwCoord(),{function:A.function,view:A.view}),fwParam:{distinct:A.distinct?A.distinct:null,queryColumns:A.value+","+A.label+","+(A.otherRefs?A.otherRefs:"")},callback:t=>{t.success?(O.data=t.data.map(e=>{return e.value=e[A.value],e.label=e[A.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e}),O.loading=!1,i[e.id]=O,this.setState({refData:i})):O.data=null}})),n=o.default.createElement(v.default,(0,y.default)({},d,{placeholder:L,options:O.data,loadData:t=>this.loadCascaderData(t,e),onChange:(t,a)=>this.onCascaderChange(e,t,a),showSearch:{filter:(e,t)=>{return t.some(t=>t.label.toLowerCase().indexOf(e.toLowerCase())>-1)}}}))}else if("AutoComplete"==e.ui&&e.valueRef){var F=e.valueRef;i[e.id]||(i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i}));var N=i[e.id];n=o.default.createElement(p.default,(0,y.default)({},d,{placeholder:u,dataSource:N.data,defaultOpen:N.defaultOpen,onSelect:(t,a)=>this.onAutoCompleteSelect(e,t,a),onSearch:e=>{N.timeout&&(clearTimeout(N.timeout),N.timeout=null),N.currentValue=e;var t=()=>{N.loading=!0,this.props.getRefData({fwCoord:(0,C.default)({},this.getFwCoord(),{function:F.function,view:F.view}),fwParam:(0,C.default)({},this.state.fwParam,{queryValue:e,distinct:F.distinct?F.distinct:null,queryColumns:F.value+","+F.label+","+(F.otherRefs?F.otherRefs:"")}),callback:t=>{if(N.currentValue==e){var a={};t.success&&t.data.map(e=>{a[e[F.label]]=e}),N.dataMap=a,N.data=Object.keys(a),N.loading=!1,N.defaultOpen=!0,N.autoFocus=!0,this.setState({refData:i,fwParam:r})}}})};N.timeout=setTimeout(t,900)}}))}else if(null!=e.valueRef){var Y=e.valueRef;if(!i[e.id]){var G={};G[Y.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),G[Y.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var q=i[e.id];q.data||(q.data=[],this.props.getRefData({fwCoord:(0,C.default)({},this.getFwCoord(),{function:Y.function,view:Y.view}),fwParam:{distinct:Y.distinct?Y.distinct:null,queryColumns:Y.value+","+Y.label+","+(Y.otherRefs?Y.otherRefs:"")},callback:t=>{var a,l=[],o={};(t.success&&(l=t.data,l&&l.map(e=>o[e[Y.value]]=e)),e.showColumn)&&function(){console.info("showColumn",s[e.showColumn],s[e.id]);var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],i=s[e.id]&&s[e.id].value?s[e.id].value.split(","):[],o=null;if(i.length>0&&t.length==i.length)for(a=0;a<i.length;++a)l.some(e=>e[Y.value]==i[a])||(o={},o[Y.value]=i[a],o[Y.label]=t[a],l.push(o))}();q.data=l,q.dataMap=o,q.loading=!1,i[e.id]=q,this.setState({refData:i,formData:s})}}));var U=q.data.map(e=>o.default.createElement(V,{key:e[Y.value]},e[Y.label],Y.otherRefs?Y.otherRefs.split(",").map(t=>{e[t]}):""));n=o.default.createElement(b.default,(0,y.default)({},d,{placeholder:L,showSearch:!0,mode:e.multiSelect?"multiple":null,notFoundContent:q.loading?o.default.createElement(w.default,{size:"small"}):null,showArrow:!0,filterOption:!1,labelInValue:!0,autoFocus:q.autoFocus,defaultOpen:q.defaultOpen,onSelect:(t,a)=>this.onSelectSelect(e,t,a),onChange:(t,a)=>this.onSelectChange(e,t,a),onSearch:t=>{q.timeout&&(clearTimeout(q.timeout),q.timeout=null),q.currentValue=t;var a=()=>{q.loading=!0,this.props.getRefData({fwCoord:(0,C.default)({},this.getFwCoord(),{function:Y.function,view:Y.view}),fwParam:{queryValue:t,distinct:Y.distinct?Y.distinct:null,queryColumns:Y.value+","+Y.label+","+(Y.otherRefs?Y.otherRefs:"")},callback:a=>{if(q.currentValue==t){var l,o=[],r={};if(a.success&&(o=a.data,o&&o.map(e=>r[e[Y.value]]=e)),e.showColumn)(function(){var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],a=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],i=null;if(a.length>0&&t.length==a.length)for(l=0;l<a.length;++l)o.some(e=>e[Y.value]==a[l])||(i={},i[Y.value]=a[l],i[Y.label]=t[l],o.push(i))})();q.data=o,q.dataMap=r,q.loading=!1,q.defaultOpen=!0,q.autoFocus=!0,this.setState({refData:i})}}})};q.timeout=setTimeout(a,500)}}),U)}else if("DatePicker"===e.ui){var B=()=>!1;"today"==e.min?B=(e=>e&&e<(0,M.default)().startOf("day")):"today"==e.max&&(B=(e=>e&&e>(0,M.default)().endOf("day"))),n=o.default.createElement(m.default,(0,y.default)({},d,{disabledDate:e=>B(e),placeholder:L}))}else if("TimePicker"===e.ui)n=o.default.createElement(h.default,d);else if("InputNumber"===e.ui)n=o.default.createElement(f.default,(0,y.default)({},d,{placeholder:u}));else if("Upload"===e.ui){var K=(0,C.default)({},this.getFwCoord(),{view:"create"}),W={openerActionId:e.id,openerFunction:this.getFwCoord()["function"],openerView:this.getFwCoord().view,oldData:{},newData:{},saveType:"checkonly"},H=this.objectToFormInputs({fwCoord:K,fwParam:W},null,null),X={name:e.id+"_importFile",action:"/fw/importData?fwCoord.project="+this.getFwCoord().project+"&",data:H,onChange(t){if(this.view.setState({loading:!0}),t.file.status,"done"===t.file.status){var a=t.file.response;this.view.setState({uploadedFile:t.file.name,uploadResult:null,loading:!1}),a.success?(r.connectFilePath=a.connectFilePath,this.view.setState({fwParam:r}),c.default.info("\u6587\u4ef6\u6821\u9a8c\u901a\u8fc7")):a.connectFilePath?this.view.setState({uploadResult:o.default.createElement("span",{dangerouslySetInnerHTML:{__html:'<font color="#ff0000"><a href="/fw/download?fileName='+a.connectFilePath+'" target="_blank">\u4e0a\u4f20\u6587\u4ef6\u6709\u8bef\uff0c\u70b9\u6b64\u4e0b\u8f7d\u660e\u7ec6</a></font>'}})}):a.errorMsg&&c.default.error(a.errorMsg,10)}else"error"===t.file.status&&(this.view.setState({loading:!1}),c.default.error(`${e.label}\u5bfc\u5165\u9519\u8bef`,10))}};X.view=this,n=o.default.createElement(Upload,(0,y.default)({},d,X,{showUploadList:!1,style:{marginLeft:10}}),o.default.createElement("a",{href:"javascript:;"},this.state.uploadedFile?this.state.uploadedFile:"\u70b9\u6b64\u4e0a\u4f20"))}else"MAP"==e.ui?(console.info("col.ui",e.ui),n=o.default.createElement(S.default,(0,y.default)({},d,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn;return n||(n=o.default.createElement(S.default,(0,y.default)({},d,{type:e.ui?e.ui:"text",placeholder:u}))),l[e.id]=n,n}),this.normFile=(e=>{return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.file&&e.file.response?e.file.response.success?e&&e.fileList:null:e&&e.fileList}),this.objectToFormInputs=function(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>this.objectToFormInputs(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]).replace(/%/g,"%25").replace(/\&/g,"%26").replace(/\+/g,"%2B").replace(/\=/g,"%3D"):this.objectToFormInputs(e[o],i,l)}return i},this.handleFormChange=(e=>{if(e){var t=this.state,a=t.fwParam,l=t.formData;a.newData||(a.newData={}),Object.keys(e).map(t=>{var i=e[t],o=this.getLayout().columnMap[t],r=o.ui,s=null;if(i&&null!=i.value)if(this.state.formData[t]||(this.state.formData[t]={}),s=i.value,"DatePicker"===r)s=i.value.format(o.pattern?o.pattern:"YYYY-MM-DD");else if("TimePicker"===r)s=i.value.format(o.pattern?o.pattern:"HH:mm:ss");else if("checkbox01"===r)s=i.value?"1":"0";else if(o.dictionary)"checkbox"==o.ui&&Array.isArray(i.value)&&(s=i.value.join(","));else if("Cascader"==o.ui)Array.isArray(i.value)&&(s=i.value.join(","),console.info("Cascader",i.value,s));else if("AutoComplete"==o.ui){if(s=i.value,"ADDRESS"==o.id){s.length>50&&(s=s.substr(0,50));var n=this.state,d=n.manualValues,c=n.refData,f=c[o.id];if(f&&f.dataMap){var h=f.dataMap[s];if(console.info("colRefData",h),h){a.newData["LAT"]=h.lat,a.newData["LNG"]=h.lng;var m=[h.province,h.city,h.district],p=c["ADDRESS_SELECT"];p||((0,u.default)("addressSelectRefData"),p={},c["ADDRESS_SELECT"]=p),p.data||(p.data=[]);var v=p.data.filter(e=>e.value==h.province);if(console.info("provinceNode",v),v&&v.length>0){var g=v[0].children;g||(g=[],v[0].children=g);var w=g.filter(e=>e.value==h.city);if(console.info("cityNode",w),w&&w.length>0){var y=w[0].children;y||(y=[],w[0].children=y);var C=y.filter(e=>e.value==h.district);console.info("districtNode",C),C&&C.length>0||y.push({value:h.district,label:h.district,isLeaf:!0})}else g.push({value:h.city,label:h.city,isLeaf:!1,children:[{value:h.district,label:h.district,isLeaf:!0}]})}else p.data.push({value:h.province,label:h.province,isLeaf:!1,children:[{value:h.city,label:h.city,isLeaf:!1,children:[{value:h.district,label:h.district,isLeaf:!0}]}]});d["ADDRESS_SELECT"]=m,console.info("set manual address",d["ADDRESS_SELECT"]),a.newData["ADDRESS_SELECT"]=m.join(","),l["ADDRESS_SELECT"]||(l["ADDRESS_SELECT"]={}),l["ADDRESS_SELECT"].value=m.join(","),s=h.name}else console.info(o.id,"inputed",a.newData["LAT"],a.newData["LNG"],s,i.value),a.newData["LAT"]=null,a.newData["LNG"]=null;this.setState({manualValues:d,refData:c})}}}else if(o.valueRef&&"TreeSelect"!=o.ui){if(s=Array.isArray(i.value)?i.value.filter(e=>e&&e.key).map(e=>e.key).join(","):i.value.key?i.value.key:null,o.showColumn){var D=this.getLayout().columnMap[o.showColumn.split(",")[0]];if(D){var E=i.value.map(e=>Array.isArray(e.label)?e.label[0]:e.label).join(",");this.state.formData[D.id]||(this.state.formData[D.id]={}),this.state.formData[D.id].value=E}}}else"Upload"===o.ui?(console.info("upload",s),Array.isArray(s)&&(s=s[0].name)):"MAP"==o.ui?(s=this.state.formData[t].value,i.dirty=!0):("string"==typeof s&&(s=s.trim(!0),o.size>0&&s.length>o.size&&(s=s.substr(0,o.size))),"NUM"==o.type&&("number"!==typeof s&&(s=new String(s).split("").filter(e=>!_.isEmpty(e)).filter((e,t,a)=>0==t&&"-"==e||"."==e&&a.filter((e,a)=>a<t).every(e=>"."!=e)||_.isNumber(e)).join("")),void 0!=o.min&&null!=o.min&&(null==s||s<o.min)&&(s=o.min),void 0!=o.max&&null!=o.max?s>o.max&&(s=o.max):o.size&&s>Math.pow(10,o.size)-1&&(s=Math.pow(10,o.size)-1)));if("GPS_DEVICE_NO"==o.id)console.info(o.id,i.value,s);else if("PRICE"==o.id){var b=parseInt(s);b>6e5&&(l["STEAL_INS"]&&(l["STEAL_INS"].value="0",a.newData["STEAL_INS"]="0"),l["STEAL_INS_AMOUNT"]&&(l["STEAL_INS_AMOUNT"]=0,a.newData["STEAL_INS_AMOUNT"]=0),l["FIRST_BENEFIT"]&&(l["FIRST_BENEFIT"]="",a.newData["FIRST_BENEFIT"]=""))}else"VIN"==o.id&&s&&(s=s.toUpperCase());i.value=s}),this.setState({formData:(0,C.default)({},this.state.formData,e),fwParam:a})}}),this.doOtherInputValidate=(()=>{var e=this.state,t=e.formData,a=e.fwParam;return"1"!=t["BIZ_INS"].value||t["BIZ_INS_DAMEGE"]&&t["BIZ_INS_DAMEGE"].value||t["BIZ_INS_THIRD"]&&t["BIZ_INS_THIRD"].value||t["BIZ_INS_OTHER"]&&t["BIZ_INS_OTHER"].value?a.newData["LAT"]&&a.newData["LNG"]?void 0:"\u8bf7\u9009\u62e9\u4f1a\u5458\u5730\u5740":"\u8bf7\u8f93\u5165\u5546\u4e1a\u9669\u6295\u4fdd\u91d1\u989d"}),this.afterSetCreateData=(()=>{var e=this.state,t=e.fwParam,a=e.formData,l=e.refData;l.INSURANCE_TEMPLATE&&l.INSURANCE_TEMPLATE.data&&l.INSURANCE_TEMPLATE.data.length>0&&(t.newData.INSURANCE_TEMPLATE=l.INSURANCE_TEMPLATE.data[0].ID,a.INSURANCE_TEMPLATE=(0,C.default)({},a.INSURANCE_TEMPLATE,{value:t.newData.INSURANCE_TEMPLATE}),this.setState({fwParam:t,formData:a}))}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],r=i;if(e.onFormat)r=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var s=this.getLayout().dictMap[e.dictionary][i];r=s||i}else e.showColumn&&(r=e.showColumn.split(",").map(e=>t[e]).join(" "));return o.default.createElement("span",null,r)}),this.showDeviceOnMap=(()=>{var e=this.state,t=e.formData,a=e.refData;if(t["GPS_DEVICE_NO"]&&t["GPS_DEVICE_NO"].value){var l=a["GPS_DEVICE_NO"];if(l&&l.dataMap){var i=t["GPS_DEVICE_NO"].value,o=l.dataMap[i];if(o)if(o.LAT2&&o.LNG2){console.info("deviceData",o);var r=this.getActionEntry("showMapWithoutQuery");console.info(r),this.getActionEntry("showMapWithoutQuery").logic(this,"showPosition",o,0,null)}else c.default.info("\u8bbe\u5907\u672a\u5b9a\u4f4d");else c.default.info("\u8bf7\u8f93\u5165\u6b63\u786e\u8bbe\u5907\u53f7!")}else c.default.info("\u8bf7\u8f93\u5165\u6b63\u786e\u8bbe\u5907\u53f7.")}else c.default.info("\u8bf7\u8f93\u5165\u6b63\u786e\u8bbe\u5907\u53f7")}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,C.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return O.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.FIX_WIDTH={},this.CustomizedForm=L.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t={};return this.getLayout().columns.filter(e=>e.visible).map(e=>{var a=(0,C.default)({},this.state.formData[e.id]);if(a&&null!=a.value)if("DatePicker"===e.ui)a.value=a.value?(0,M.default)(a.value,e.pattern?e.pattern:"YYYY-MM-DD"):a.value;else if("TimePicker"===e.ui)a.value=a.value?(0,M.default)(a.value,e.pattern?e.pattern:"HH:mm:ss"):a.value;else if("checkbox01"===e.ui)a.value="1"==a.value;else if(e.dictionary)"checkbox"==e.ui?Array.isArray(a.value)||(a.value=String(a.value).split(",")):a.value=String(a.value);else if("Cascader"==e.ui)a.value=String(a.value).split(",");else if("AutoComplete"==e.ui);else if(e.valueRef&&"TreeSelect"!=e.ui){if(Array.isArray(a.value)||(a.value?a.value=String(a.value).split(",").map(e=>({key:e})):a.value=[]),Array.isArray(a.value)&&e.showColumn){var l=this.state.formData[e.showColumn.split(",")[0]];l&&l.value&&l.value.split(",").map((e,t)=>a.value.length>t?a.value[t].label=e:null)}}else"MAP"==e.ui||("NUM"!=e.type||e.dictionary?a.value=String(a.value):(""==a.value&&(a.value=null),a.value));e.valueRef&&"TreeSelect"!=e.ui&&null==a.value&&delete a.value,t[e.id]=L.default.createFormField((0,C.default)({},a))}),t},onValuesChange(e,t){}})(e=>{this.state.form=e.form;var t=e.form.getFieldDecorator,a=this.getLayout().columns.filter(e=>e.visible),l={_default:[]},i={};this.getLayout().columnGroups&&this.getLayout().columnGroups.map(e=>i[e.id]=e),a.map(e=>{var t="_default";e.group&&i[e.group]&&(t=e.group),l[t]||(l[t]=[]),l[t].push(e)});var u=(e,l)=>e?e.map((e,i)=>{var r=[],s=this.state.formData;["CURRENT_MILE","NEXT_MAINTAIN_MILE","NEXT_MAINTAIN_DATE"].some(t=>t==e.id)?(e.editable=!s["MEMBER_SOURCE"]||"1"!=s["MEMBER_SOURCE"].value,e.tooltip=e.editable?null:"\u4f1a\u5458\u6765\u6e90\u662f\u81ea\u5e97\u8d2d\u8f66\u65f6\u4e0d\u9700\u8981\u8f93\u5165"):["BIZ_INS_DAMEGE","BIZ_INS_THIRD","BIZ_INS_OTHER"].some(t=>t==e.id)?(e.editable=s["BIZ_INS"]&&"1"==s["BIZ_INS"].value,e.tooltip=e.editable?null:"\u6f5c\u5ba2\u767b\u8bb0\u65f6\u4e0d\u9700\u8981\u8f93\u5165"):["FORCE_INS_AMOUNT"].some(t=>t==e.id)?(e.editable=s["FORCE_INS"]&&"1"==s["FORCE_INS"].value,e.tooltip=e.editable?null:"\u6f5c\u5ba2\u767b\u8bb0\u65f6\u4e0d\u9700\u8981\u8f93\u5165"):["STEAL_INS_AMOUNT","FIRST_BENEFIT","INSURANCE_TEMPLATE"].some(t=>t==e.id)?(e.editable=s["STEAL_INS"]&&"1"==s["STEAL_INS"].value&&(!s["PRICE"]||!s["PRICE"].value||s["PRICE"].value<=6e5),e.tooltip=e.editable?null:"\u4e0d\u6295\u4fdd\u65f6\u4e0d\u9700\u8981\u8f93\u5165"):["STEAL_INS"].some(t=>t==e.id)&&(e.editable=!s["PRICE"]||!s["PRICE"].value||s["PRICE"].value<=6e5,e.tooltip=e.editable?null:"\u8f66\u4ef7\u9ad8\u4e8e60\u4e07\u65f6\u4e0d\u80fd\u6295\u4fdd"),["GPS_DEVICE_NO"].some(t=>t==e.id)&&(e.required=s["STEAL_INS"]&&"1"==s["STEAL_INS"].value,e.tooltip=e.required?"\u6295\u4fdd\u76d7\u62a2\u9669\u65f6\u5fc5\u987b\u8f93\u5165":null,e.required||s[e.id]&&s[e.id].errors&&(delete s[e.id].errors,this.setState({formData:s})));var u=!1;e.editable?(r.push({required:e.required,message:"\u8bf7\u8f93\u5165"+e.label}),"NUM"==e.type?e.dictionary||e.valueRef||(u=!0,e.max||e.size,e.min):e.dictionary||e.valueRef||"DatePicker"==e.ui||(u=!0,e.size)):s[e.id]&&s[e.id].errors&&(delete s[e.id].errors,this.setState({formData:s})),"ID_NO"==e.id&&r.push({validator(e,t,a){var l=[];t&&!_.validIdentityCodeValid(t)&&l.push(new Error("\u8bf7\u8f93\u5165\u6b63\u786e\u8eab\u4efd\u8bc1\u53f7")),a(l)}}),"MOBILE_NO"==e.id&&r.push({validator(e,t,a){var l=[];t&&!_.validMobileNo(t)&&l.push(new Error("\u8bf7\u8f93\u5165\u6b63\u786e\u624b\u673a\u53f7")),a(l)}}),"VIN"==e.id&&r.push({validator(e,t,a){var l=[];t&&!_.validateVIN(t)&&l.push(new Error("\u8bf7\u8f93\u5165\u6b63\u786eVIN\u7801")),a(l)}});var c={valuePropName:"value",rules:r};u&&(c.validateTrigger="onBlur"),"checkbox01"==e.ui?c.valuePropName="checked":"Upload"==e.ui&&(c.getValueFromEvent=this.normFile);var f=this.FIX_WIDTH[e.id]?this.FIX_WIDTH[e.id]:a.length>5&&(!l||0!=i)?12:24,h=o.default.createElement(d.default,{title:e.tooltip},t(e.id,c)(this.getInputComponent(e)));return o.default.createElement(n.default,{span:f,key:e.id},o.default.createElement(N,(0,y.default)({},l?0==i?q:G:Y,{label:l&&0==i?o.default.createElement("b",null,e.label):e.label}),"ADDRESS"==e.id?this.getInputComponent(this.getLayout().columnMap.ADDRESS_SELECT,!0):null,h,e.tail?" "+e.tail:null,"GPS_DEVICE_NO"==e.id?o.default.createElement("a",{href:"javascript:;",onClick:()=>this.showDeviceOnMap()},"\xa0\u67e5\u770b\u5b9a\u4f4d"):null))}):[],c=[];Object.keys(l).length>1?["basic","vehicle"].map(e=>{i[e]&&l[e]&&l[e].length>0&&c.push(o.default.createElement(n.default,{span:24,key:"group_"+e,style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,i[e].title))),c=[...c,...u(l[e])]}):c=u(a),a.some(e=>"Upload"==e.ui)&&c.push(o.default.createElement(n.default,{key:"FW_uploadPrompt",span:24,style:{height:60,textAlign:"center"}},this.state.uploadResult)),c.push(o.default.createElement(n.default,{span:24,key:"group_insurance",style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,"\u4fdd\u9669\u4fe1\u606f")));var f=O.buildDetailMenus(this);return o.default.createElement(L.default,{style:{height:"100%"}},o.default.createElement("div",{style:{overflow:"auto",height:"90%",left:0,padding:10,paddingBottom:20,backgroundColor:"#ffffff"}},o.default.createElement(s.default,null,c),o.default.createElement(s.default,null,o.default.createElement(n.default,{span:11,offset:1},o.default.createElement(r.default,{className:A.default.insuranceInfo},u(l["bizIns"],!0))),o.default.createElement(n.default,{span:11,offset:1},o.default.createElement(r.default,{className:A.default.insuranceInfo},u(l["forceIns"],!0)))),o.default.createElement(s.default,null,o.default.createElement(n.default,{span:11,offset:1},o.default.createElement(r.default,{className:A.default.insuranceInfo},u(l["stealIns"],!0))))),o.default.createElement("div",{style:{padding:10,marginTop:10,marginBottom:10,backgroundColor:"#ffffff",textAlign:"right"}},f))}),this.state=(0,C.default)({},e,{loading:!1,dialogs:{},form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{},uploadedFile:null,uploadResult:null,manualValues:{}})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData;t.newData=(0,C.default)({},this.props.initData),t.oldData={},Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.setState({fwParam:this.state.fwParam,formData:a,refData:{}})}else if(this.props.showAsDialog){console.info("2",this.props.clientNewData);var l=(0,C.default)({},this.state.fwParam,{oldData:{},newData:this.props.clientNewData});this.props.getCreateData({fwCoord:this.getFwCoord(),fwParam:l,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData;a.newData=(0,C.default)({},e),a.oldData={},Object.keys(e).map(t=>l[t]={value:e[t]}),this.setState({fwParam:this.state.fwParam,formData:l,refData:{}})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null);this.props.refreshMemberList&&this.props.refreshMemberList()}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.CustomizedForm;return o.default.createElement("div",{style:{height:"100%"}},o.default.createElement(w.default,{style:{height:"100%"},spinning:this.props.loading||this.state.loading},o.default.createElement(e,{onChange:this.handleFormChange})),Object.values(this.state.dialogs))}})||I);t.default=K},TTD2:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=u,t.logic=c,t.handleOk=f,t.handleCancel=h;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr"));a("2qtc");var s=i(a("kLXV")),n=i(a("MVZn")),d=l(a("uYVn"));function u(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],console.info("layout executed",this),o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(Icon,{type:this.action.icon}),this.action.label," "))}function c(e,t,l,i,r){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=r;var d=this.view.getLayout().argument.treeIdField,u=this.view.getLayout().argument.treeParentIdField;if(!this.record){var c=null;this.view.state.selectedKeys&&this.view.state.selectedKeys.length>0&&(c=this.view.state.selectedKeys[0]);var f=null;c&&(f=this.view.findNode(c)),this.record=f}null==this.record||e.getLayout().argument.treeCanAddRoot,this.record=(0,n.default)({},this.record,{children:null});var h=(0,n.default)({},this.view.getFwCoord(),{view:"create"});this.view.getLayout().argument&&this.view.getLayout().argument.treeFunction&&(h["function"]=this.view.getLayout().argument.treeFunction);var m={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{},selectedTreeNodeId:this.record?this.record[d]:null},p=null;if(console.info("this.action",this.action),this.action.argument&&this.action.argument.antdPath){var v=this.action.argument.antdPath;p=a("RO01")(`./${v}`).default}else p=a("Yn9z").default;var g=e=>{e.columns.filter(e=>e.id==u).map(e=>e.editable=null!=this.record),this.innerLayout=e;var t=this.view.state.dialogs,a={};console.info("selectedNode",this.record),a[u]=this.record?this.record[d]:this.view.state.treeData[0][d];var l=e.columns.filter(e=>e.visible),i=l.length>=5||l.some(e=>"MAP"==e.ui)?"42vw":"25vw";t[this.id]=o.default.createElement(s.default,{width:i,key:this.id,title:e.title,visible:!0,maskClosable:!1,confirmLoading:this.view.props.createLoading,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4fdd\u5b58",onOk:e=>this.handleOk(e)},o.default.createElement(p,{selectedData:{},innerLayout:e,innerFwCoord:h,fwParam:m,clientNewData:a,showAsDialog:!0,onRef:e=>this.onRef(e),treeData:this.view.state.treeData})),this.view.setState({dialogs:t})};this.innerLayout?g(this.innerLayout):this.view.props.loadLayout({fwCoord:h,fwParam:m,callback:g})}function f(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{var i=this.dialog.state.formData,o=this.dialog.state.fwParam.newData;Object.keys(i).map(e=>o[e]=i[e].value);var s=(0,n.default)({},this.dialog.state.fwParam,{newData:o,selectedData:this.record});this.dialog.props.saveCreateData({fwCoord:this.dialog.getFwCoord(),fwParam:s,callback:a=>{if(a.success){d.isEmpty(a.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(a.errorMsg,10);var i=a.resultData,o=i[this.view.getLayout().argument.treeParentIdField];i.GOT_PID=o;var s=this.view.state.treeData;if(o){var n=this.view.findNode(o);console.info("parentNode",n),n&&(n.children?n.children.push(i):n.GOT_SUBCOUNT?n.GOT_SUBCOUNT+=1:n.GOT_SUBCOUNT=1)}else s.push(i);this.view.setState({treeData:s}),this.handleCancel(e)}else{if(a.validResultMap){var u={};Object.keys(a.validResultMap).map(e=>{u[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(u)}d.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}})}})}function h(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},Tpzm:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("14J3");var r=i(a("BMrR"));a("jCWc");var s=i(a("kPKH"));a("+L6B");var n=i(a("2/Rp"));a("DZo9");var d=i(a("8z0m"));a("miYZ");var u=i(a("tsqr"));a("giR+");var c=i(a("fyUT"));a("Xi6J");var f=i(a("kl6h"));a("iQDF");var h=i(a("+eQT"));a("O3gP");var m=i(a("lrIw"));a("6UJt");var p=i(a("DFOY"));a("nRaC");var v=i(a("5RzL"));a("T2oS");var g=i(a("W9HT")),w=i(a("pVnL")),y=i(a("MVZn"));a("sRBo");var C=i(a("kaz8"));a("7Kak");var D=i(a("9yH6"));a("OaEy");var E=i(a("2fM7"));a("5NDa");var b=i(a("5rEg"));a("y8nQ");var S=i(a("Vl3Y"));a("ozfa");var L,P,k=i(a("MJZm")),I=a("MuoO"),R=(i(a("QCDS")),l(a("uYVn"))),T=l(a("dNXO")),A=a("0Fy/"),_=i(a("wd/R"));a("XDpg"),_.default.locale("zh-cn");var O=k.default.TreeNode,M=S.default.Item,F=b.default.TextArea,N=E.default.Option,j=D.default.Group,V=C.default.Group,x={labelCol:{xs:{span:8},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16}}};function z(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.edit,dispatch:a,fwCoord:l,layout:i}}var Y=e=>{return{getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})}}},G=(L=(0,I.connect)(z,Y),L(P=class extends o.Component{constructor(e){super(e),this.convertToCascadeData=((e,t)=>{return e?e.map(e=>{return e.value=e[t.value],e.label=e[t.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e.children&&(e.children=this.convertToCascadeData(e.children,t)),e}):null}),this.loadCascaderData=((e,t)=>{var a=e[e.length-1];a.loading=!0;var l=t.valueRef;this.getTreeData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:l.function,view:l.view}),fwParam:{distinct:l.distinct?l.distinct:null,queryColumns:l.value+","+l.label+(l.otherRefs?","+l.otherRefs:"")+(l.disableColumn?","+l.disableColumn:""),selectedTreeNodeId:e.map(e=>e[l.value]).join(","),selectedData:l.useCurrentData?this.getEditedNewData():null},callback:e=>{a.loading=!1,a.children=this.convertToCascadeData(e.data,l),this.setState({refData:this.state.refData})}})}),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,y.default)({},this.state.fwParam,{openerSelectedData:(0,y.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,y.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(O,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+(t.valueRef.otherRefs?","+t.valueRef.otherRefs:"")+(t.valueRef.disableColumn?","+t.valueRef.disableColumn:""),selectedTreeNodeId:e.props.eventKey,selectedData:t.valueRef.useCurrentData?this.getEditedNewData():null},callback:e=>{i.children=e.data,a.defaultOpen=!0,console.info(a.data),l(),this.setState({refData:this.state.refData})}}))})),this.onCascaderChange=((e,t,a)=>{if(console.info("onCascaderChange",e.id,t,a),"ADDRESS_SELECT"==e.id){var l=this.state,i=l.fwParam,o=l.formData,r=l.manualValues;i.newData||(i.newData={}),i.newData[e.id]=t.join(","),o[e.id]||(o[e.id]={}),o[e.id].value=t.join(","),r[e.id]=t,this.setState({fwParam:i,manualValues:r,formData:o})}}),this.onAutoCompleteSelect=((e,t,a)=>{console.info("onAutoCompleteSelect",e.id,t,a)}),this.onSelectChange=((e,t,a)=>{console.info("onSelectChange",e.id,t,a)}),this.onSelectSelect=((e,t,a)=>{console.info("onSelectSelect",e.id,t,a)}),this.MONEY_IDS={},this.getInputComponent=((e,t)=>{var a=this.state,l=a.components,i=a.refData,r=a.fwParam,s=a.formData,n=null,S={disabled:!e.editable,style:{width:"85%"}};t&&(S.value=this.state.manualValues[e.id]);var L="",P="";if(e.editable&&(L=e.prompt?e.prompt:"\u8bf7\u8f93\u5165",P=e.prompt?e.prompt:"\u8bf7\u9009\u62e9"),"label"==e.ui)n=this.getDisplayValue(e);else if("MEMO"===e.type)n=o.default.createElement(F,(0,w.default)({},S,{rows:4}));else if("checkbox01"===e.ui)n=o.default.createElement(C.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictList[e.dictionary]){var k=this.getLayout().dictList[e.dictionary];if("radio"==e.ui)n=o.default.createElement(j,(0,w.default)({name:e.id},S),k.map(e=>o.default.createElement(D.default,{key:e.value,value:String(e.value)},e.label)));else if("checkbox"==e.ui){var I=k;n=o.default.createElement(V,(0,w.default)({name:e.id},S,{options:I}))}else n=o.default.createElement(E.default,(0,w.default)({},S,{placeholder:P,showSearch:!0,mode:e.multiSelect?"multiple":null,optionFilterProp:"children",filterOption:(e,t)=>t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}),k.map(e=>o.default.createElement(N,{key:e.value,value:e.value},e.label)))}else if("TreeSelect"===e.ui&&e.valueRef){var R=e.valueRef;if(!i[e.id]){var T=null;R.function==this.props.fwParam.openerFunction&&R.view==this.props.fwParam.openerView&&this.props.treeData&&(T=this.props.treeData),i[e.id]={loading:!1,data:T,queryIndex:0,defaultOpen:!1}}var A=i[e.id];A.data||(A.data=[],this.props.getTreeData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:R.function,view:R.view}),fwParam:{distinct:R.distinct?R.distinct:null,queryColumns:R.value+","+R.label+(R.otherRefs?","+R.otherRefs:"")+(R.disableColumn?","+R.disableColumn:""),selectedId:r&&r.newData&&r.newData[e.id]?r.newData[e.id]:null},callback:t=>{t.success?(A.data=t.data,A.loading=!1,i[e.id]=A,this.setState({refData:i})):A.data=null}})),n=o.default.createElement(v.default,(0,w.default)({},S,{placeholder:P,notFoundContent:A.loading?o.default.createElement(g.default,{size:"small"}):"\u65e0\u6570\u636e",showArrow:!0,showSearch:!0,searchPlaceholder:"\u8f93\u5165\u641c\u7d22",filterTreeNode:(e,t)=>{return console.info("treeNode",t),t.props.title.indexOf(e)>=0},treeNodeFilterProp:"title",filterOption:!1,loadData:t=>this.onTreeSelectLoadData(t,e,A),treeExpandedKeys:A.expandedKeys?A.expandedKeys:A.data.map(e=>String(e[R.value])),onTreeExpand:e=>{A.expandedKeys=e,A.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:A.defaultOpen,onSearch1:t=>{A.timeout&&(clearTimeout(A.timeout),A.timeout=null),A.currentValue=t;var a=()=>{console.info(t),A.loading=!0,this.props.getRefData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:R.function,view:R.view}),fwParam:{queryStr:t,distinct:R.distinct?R.distinct:null,queryColumns:R.value+","+R.label+(R.otherRefs?","+R.otherRefs:"")+(R.disableColumn?","+R.disableColumn:"")},callback:a=>{A.currentValue==t&&(A.data=a.data,A.loading=!1,A.defaultOpen=!0,s[e.id].value=t,this.setState({refData:i,fwParam:r,formData:s}))}})};A.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(A.data,R))}else if("Cascader"==e.ui&&e.valueRef){var _=e.valueRef;if(!i[e.id]){var O={};O[_.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),O[_.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var M=i[e.id];M.data||(M.data=[],this.props.getTreeData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:_.function,view:_.view}),fwParam:{distinct:_.distinct?_.distinct:null,queryColumns:_.value+","+_.label+(_.otherRefs?","+_.otherRefs:"")+(_.disableColumn?","+_.disableColumn:""),selectedData:_.useCurrentData?this.getEditedNewData():null},callback:t=>{t.success?(M.data=this.convertToCascadeData(t.data,_),M.loading=!1,i[e.id]=M,this.setState({refData:i})):M.data=null}})),n=o.default.createElement(p.default,(0,w.default)({},S,{placeholder:P,options:M.data,loadData:t=>this.loadCascaderData(t,e),onChange:(t,a)=>this.onCascaderChange(e,t,a),showSearch:{filter:(e,t)=>{return t.some(t=>t.label.toLowerCase().indexOf(e.toLowerCase())>-1)}}}))}else if("AutoComplete"==e.ui&&e.valueRef){var x=e.valueRef;i[e.id]||(i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i}));var z=i[e.id];n=o.default.createElement(m.default,(0,w.default)({},S,{placeholder:L,dataSource:z.data,defaultOpen:z.defaultOpen,onSelect:(t,a)=>this.onAutoCompleteSelect(e,t,a),onSearch:e=>{z.timeout&&(clearTimeout(z.timeout),z.timeout=null),z.currentValue=e;var t=()=>{z.loading=!0,this.props.getRefData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:x.function,view:x.view}),fwParam:(0,y.default)({},this.state.fwParam,{queryValue:e,distinct:x.distinct?x.distinct:null,queryColumns:x.value+","+x.label+(x.otherRefs?","+x.otherRefs:"")+(x.disableColumn?","+x.disableColumn:""),selectedData:x.useCurrentData?this.getEditedNewData():null}),callback:t=>{if(z.currentValue==e){var a={};t.success&&t.data.map(e=>{a[e[x.label]]=e}),z.dataMap=a,z.data=Object.keys(a),z.loading=!1,z.defaultOpen=!0,z.autoFocus=!0,this.setState({refData:i,fwParam:r})}}})};z.timeout=setTimeout(t,900)}}))}else if(null!=e.valueRef){var Y=e.valueRef;if(!i[e.id]){var G={};G[Y.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),G[Y.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var q=i[e.id];q.data||(q.data=[],this.props.getRefData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:Y.function,view:Y.view}),fwParam:{distinct:Y.distinct?Y.distinct:null,queryColumns:Y.value+","+Y.label+(Y.otherRefs?","+Y.otherRefs:"")+(Y.disableColumn?","+Y.disableColumn:""),selectedData:Y.useCurrentData?this.getEditedNewData():null},callback:t=>{var a,l=[],o={};(t.success&&(l=t.data,l&&l.map(e=>o[e[Y.value]]=e)),e.showColumn)&&function(){console.info("showColumn",s[e.showColumn],s[e.id]);var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],i=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],o=null;if(i.length>0&&t.length==i.length)for(a=0;a<i.length;++a)l.some(e=>e[Y.value]==i[a])||(o={},o[Y.value]=i[a],o[Y.label]=t[a],l.push(o))}();q.data=l,q.dataMap=o,q.loading=!1,i[e.id]=q,this.setState({refData:i,formData:s})}}));var U=q.data.map(e=>o.default.createElement(N,{key:e[Y.value],disabled:Y.disableColumn&&e[Y.disableColumn]==Y.disableValue},e[Y.label],Y.otherRefs?Y.otherRefs.split(",").map(t=>{e[t]}):""));n=o.default.createElement(E.default,(0,w.default)({},S,{placeholder:P,showSearch:!0,mode:e.multiSelect?"multiple":null,notFoundContent:q.loading?o.default.createElement(g.default,{size:"small"}):"\u65e0\u6570\u636e",showArrow:!0,filterOption:!1,labelInValue:!0,allowClear:!e.required,autoFocus:q.autoFocus,defaultOpen:q.defaultOpen,onSelect:(t,a)=>this.onSelectSelect(e,t,a),onChange:(t,a)=>this.onSelectChange(e,t,a),onSearch:t=>{q.timeout&&(clearTimeout(q.timeout),q.timeout=null),q.currentValue=t;var a=()=>{q.loading=!0,this.props.getRefData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:Y.function,view:Y.view}),fwParam:{queryValue:t,distinct:Y.distinct?Y.distinct:null,queryColumns:Y.value+","+Y.label+(Y.otherRefs?","+Y.otherRefs:"")+(Y.disableColumn?","+Y.disableColumn:""),selectedData:Y.useCurrentData?this.getEditedNewData():null},callback:a=>{if(q.currentValue==t){var l,o=[],r={};if(a.success&&(o=a.data,o&&o.map(e=>r[e[Y.value]]=e)),e.showColumn)(function(){var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],a=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],i=null;if(a.length>0&&t.length==a.length)for(l=0;l<a.length;++l)o.some(e=>e[Y.value]==a[l])||(i={},i[Y.value]=a[l],i[Y.label]=t[l],o.push(i))})();q.data=o,q.dataMap=r,q.loading=!1,q.defaultOpen=!0,q.autoFocus=!0,this.setState({refData:i})}}})};q.timeout=setTimeout(a,500)}}),U)}else if("DatePicker"===e.ui){var B=()=>!1;B=(t=>{var a=!1;return e.min&&t&&t<this.getRealDate(e.min).startOf("day")&&(a=!0),a||e.max&&t&&t>this.getRealDate(e.max).endOf("day")&&(a=!0),a}),n=o.default.createElement(h.default,(0,w.default)({},S,{disabledDate:e=>B(e),placeholder:P}))}else if("TimePicker"===e.ui)n=o.default.createElement(f.default,S);else if("InputNumber"===e.ui)n=o.default.createElement(c.default,(0,w.default)({},S,{placeholder:L}));else if("Upload"===e.ui){var K=(0,y.default)({},this.getFwCoord(),{view:"create"}),W={openerActionId:e.id,openerFunction:this.getFwCoord()["function"],openerView:this.getFwCoord().view,oldData:{},newData:{},saveType:"checkonly"},H=this.objectToFormInputs({fwCoord:K,fwParam:W},null,null),X={name:e.id+"_importFile",action:"/fw/importData?fwCoord.project="+this.getFwCoord().project+"&",data:H,onChange(t){if(this.view.setState({loading:!0}),t.file.status,"done"===t.file.status){var a=t.file.response;this.view.setState({uploadedFile:t.file.name,uploadResult:null,loading:!1}),a.success?(r.connectFilePath=a.connectFilePath,this.view.setState({fwParam:r}),u.default.info("\u6587\u4ef6\u6821\u9a8c\u901a\u8fc7")):a.connectFilePath?this.view.setState({uploadResult:o.default.createElement("span",{dangerouslySetInnerHTML:{__html:'<font color="#ff0000"><a href="/fw/download?fileName='+a.connectFilePath+'" target="_blank">\u4e0a\u4f20\u6587\u4ef6\u6709\u8bef\uff0c\u70b9\u6b64\u4e0b\u8f7d\u660e\u7ec6</a></font>'}})}):a.errorMsg&&u.default.error(a.errorMsg,10)}else"error"===t.file.status&&(this.view.setState({loading:!1}),u.default.error(`${e.label}\u5bfc\u5165\u9519\u8bef`,10))}};X.view=this;var Z=this.state.uploadedFile?this.state.uploadedFile:this.state.uploadShowLabel[e.id]?this.state.uploadShowLabel[e.id]:null;n=o.default.createElement(d.default,(0,w.default)({},S,X,{showUploadList:!1,style:{marginLeft:10}}),o.default.createElement("a",{href:"javascript:;"},Z||"\u70b9\u51fb\u4e0a\u4f20"))}else"MAP"==e.ui?(console.info("col.ui",e.ui),n=o.default.createElement(b.default,(0,w.default)({},S,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn;return n||(n=o.default.createElement(b.default,(0,w.default)({},S,{type:e.ui?e.ui:"text",placeholder:L}))),l[e.id]=n,n}),this.getRealDate=(e=>{if(0==e.indexOf("{today")&&e.indexOf("}")==e.length-1){var t=String(e).substring(6,e.length-1);return(0,_.default)().add(parseInt(t),"days")}return"today"==e?(0,_.default)():(0,_.default)(e)}),this.clearUpload=(e=>{var t=this.state,a=t.uploadShowLabel,l=t.formData;delete a[e.id],l[e.id]&&(l[e.id].value=null,l[e.id].dirty=!0),this.setState({uploadedFile:null,uploadShowLabel:a,formData:l})}),this.normFile=(e=>{return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.file&&e.file.response?e.file.response.success?e&&e.fileList:null:e&&e.fileList}),this.objectToFormInputs=function(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>this.objectToFormInputs(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]).replace(/%/g,"%25").replace(/\&/g,"%26").replace(/\+/g,"%2B").replace(/\=/g,"%3D"):this.objectToFormInputs(e[o],i,l)}return i},this.selectPointInMap=(e=>{var t=this.state.formData,a=this.getLayout().columnMap[e],l=a.showColumn.split(",");console.info("param",l,t),this.state.map.selectPoint({id:e,lat:t[l[0]]?t[l[0]].value:36,lng:t[l[1]]?t[l[1]].value:120,name:a.label,callback:(e,a,i,o,r)=>{console.info("callback",r,r.onlineStr),t[e]||(t[e]={}),t[l[0]]||(t[l[0]]={}),t[l[1]]||(t[l[1]]={}),t[e].value=r.onlineStr,t[l[0]].value=a,t[l[1]].value=i,console.info("newParam",a,i,t),this.setState({formData:t})}})}),this.handleFormChange=(e=>{if(e){var t=this.state,a=t.fwParam;t.formData;a.newData||(a.newData={}),Object.keys(e).map(t=>{var a=e[t],l=this.getLayout().columnMap[t],i=l.ui,o=null;if(a&&null!=a.value)if(this.state.formData[t]||(this.state.formData[t]={}),o=a.value,"DatePicker"===i)o=a.value.format(l.pattern?l.pattern:"YYYY-MM-DD");else if("TimePicker"===i)o=a.value.format(l.pattern?l.pattern:"HH:mm:ss");else if("checkbox01"===i)o=a.value?"1":"0";else if(l.dictionary)l.ui,Array.isArray(a.value)&&(o=a.value.join(","));else if("Cascader"==l.ui)Array.isArray(a.value)&&(o=a.value.join(","),console.info("Cascader",a.value,o));else if("AutoComplete"==l.ui)o=a.value;else if(l.valueRef&&"TreeSelect"!=l.ui){if(o=Array.isArray(a.value)?a.value.filter(e=>e&&e.key).map(e=>e.key).join(","):a.value.key?a.value.key:null,l.showColumn){var r=this.getLayout().columnMap[l.showColumn.split(",")[0]];if(r){var s=a.value.map(e=>Array.isArray(e.label)?e.label[0]:e.label).join(",");this.state.formData[r.id]||(this.state.formData[r.id]={}),this.state.formData[r.id].value=s}}}else"Upload"===l.ui?(console.info("upload",o),Array.isArray(o)&&(o=o[0].name)):"MAP"==l.ui?(o=this.state.formData[t].value,a.dirty=!0):("string"==typeof o&&(o=o.trim(!0),l.size>0&&o.length>l.size&&(o=o.substr(0,l.size))),"NUM"==l.type&&("number"!==typeof o&&(o=new String(o).split("").filter(e=>!R.isEmpty(e)).filter((e,t,a)=>0==t&&"-"==e||"."==e&&a.filter((e,a)=>a<t).every(e=>"."!=e)||R.isNumber(e)).join("")),void 0!=l.min&&null!=l.min&&(null==o||o<l.min)&&(o=l.min),void 0!=l.max&&null!=l.max?o>l.max&&(o=l.max):l.size&&o>Math.pow(10,l.size)-1&&(o=Math.pow(10,l.size)-1)));a.value=o}),this.setState({formData:(0,y.default)({},this.state.formData,e),fwParam:a})}}),this.doOtherInputValidate=(()=>{return null}),this.getEditedNewData=(()=>{var e=(0,y.default)({},this.props.selectedData,this.state.fwParam.newData);return Object.keys(this.state.formData).map(t=>e[t]=this.state.formData[t].value),this.processNewData&&this.processNewData(e),e}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],r=i;if(e.onFormat)r=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var s=this.getLayout().dictMap[e.dictionary][i];r=s||i}else e.showColumn&&(r=e.showColumn.split(",").map(e=>t[e]).join(" "));return o.default.createElement("span",null,r)}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,y.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return T.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.FIX_WIDTH={},this.CustomizedForm=S.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t={};return this.getLayout().columns.filter(e=>e.visible).map(e=>{var a=(0,y.default)({},this.state.formData[e.id]);if(a&&null!=a.value)if("DatePicker"===e.ui)a.value=a.value?(0,_.default)(a.value,e.pattern?e.pattern:"YYYY-MM-DD"):a.value;else if("TimePicker"===e.ui)a.value=a.value?(0,_.default)(a.value,e.pattern?e.pattern:"HH:mm:ss"):a.value;else if("checkbox01"===e.ui)a.value="1"==a.value;else if(e.dictionary)"checkbox"==e.ui?Array.isArray(a.value)||(a.value=String(a.value).split(",")):e.multiSelect?a.value?a.value=String(a.value).split(","):a.value=null:a.value=String(a.value);else if("Cascader"==e.ui)a.value=String(a.value).split(",");else if("AutoComplete"==e.ui);else if(e.valueRef&&"TreeSelect"!=e.ui){if(Array.isArray(a.value)||(a.value?a.value=String(a.value).split(",").map(e=>({key:e})):a.value=[]),Array.isArray(a.value)&&e.showColumn){var l=this.state.formData[e.showColumn.split(",")[0]];l&&l.value&&l.value.split(",").map((e,t)=>a.value.length>t?a.value[t].label=e:null)}}else"MAP"==e.ui?a.value=a.value.split("\u3001").join(""):"NUM"!=e.type||e.dictionary?a.value=String(a.value):(""===a.value&&(a.value=null),a.value);(void 0===a.value||null===a.value||""===a.value||Array.isArray(a.value)&&0==a.value.length)&&delete a.value,t[e.id]=S.default.createFormField((0,y.default)({},a))}),t},onValuesChange(e,t){}})(e=>{this.state.form=e.form;var t=e.form.getFieldDecorator,l=this.getLayout().columns.filter(e=>e.visible),i={_default:[]},d={};this.getLayout().columnGroups&&this.getLayout().columnGroups.map(e=>d[e.id]=e),l.map(e=>{var t="_default";e.group&&d[e.group]&&(t=e.group),i[t]||(i[t]=[]),i[t].push(e)});var u=e=>e?e.map(e=>{var i=[],r=!1;if(e.editable&&(i.push({required:e.required,message:"\u8bf7\u8f93\u5165"+e.label}),"NUM"==e.type?e.dictionary||e.valueRef||(r=!0,e.max||e.size,e.min):e.dictionary||e.valueRef||"DatePicker"==e.ui||(r=!0,e.size)),e.onValidate&&this.getLayout().clientLogicMap[e.onValidate]){var d=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onValidate].file}`);i.push({validator:(t,a,l)=>{var i=[];a&&!d.validate(a,this.state.fwParam.newData,0,e,this)&&i.push(new Error(d.errorMsg(a,this.state.fwParam.newData,0,e,this))),l(i)}})}var u={valuePropName:"value",rules:i};return r&&(u.validateTrigger="onBlur"),"checkbox01"==e.ui?u.valuePropName="checked":"Upload"==e.ui&&(u.getValueFromEvent=this.normFile),o.default.createElement(s.default,{span:l.length>5||l.some(e=>"MAP"==e.ui)?12:24,key:e.id},o.default.createElement(M,(0,w.default)({},x,{label:e.label}),t(e.id,u)(this.getInputComponent(e)),"Upload"==e.ui&&(this.state.uploadedFile||this.state.uploadShowLabel[e.id])?o.default.createElement(n.default,{icon:"close",shape:"circle",style:{marginLeft:10,width:20,height:20,fontSize:8},onClick:()=>this.clearUpload(e)}):null,e.tail?" "+e.tail:null))}):[],c=[];return Object.keys(i).length>1?["_default",...this.getLayout().columnGroups.map(e=>e.id)].map(e=>{d[e]&&i[e]&&i[e].length>0&&c.push(o.default.createElement(s.default,{span:24,key:"group_"+e,style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,d[e].title))),c=[...c,...u(i[e])]}):c=u(l),l.some(e=>"Upload"==e.ui)&&c.push(o.default.createElement(s.default,{key:"FW_uploadPrompt",span:24,style:{height:60,textAlign:"center"}},this.state.uploadResult)),o.default.createElement(S.default,null,o.default.createElement(r.default,{gutter:1},c))}),this.state=(0,y.default)({},e,{loading:!1,dialogs:{},form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{},uploadedFile:null,uploadResult:null,uploadShowLabel:{},manualValues:{}})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData,l=e.uploadShowLabel;t.newData=(0,y.default)({},this.props.initData),t.oldData=(0,y.default)({},this.props.initData),Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.getLayout().columns.filter(e=>"Upload"==e.ui).map(e=>l[e.id]=this.props.initData[e.id]),this.setState({fwParam:this.state.fwParam,formData:a,refData:{},uploadShowLabel:l},()=>{this.getLayout().columns.filter(e=>"MAP"==e.ui).map(e=>this.selectPointInMap(e.id))})}else if(this.props.showAsDialog){var i=(0,y.default)({},this.state.fwParam,{oldData:{},newData:{},selectedData:this.props.selectedData});this.props.getEditData({fwCoord:this.getFwCoord(),fwParam:i,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData,i=e["_FW_DYNAMIC_LAYOUT"];delete e["_FW_DYNAMIC_LAYOUT"],i&&i.columns&&i.columns.map(e=>{var t=this.getLayout().columnMap[e.id];t&&Object.keys(e).map(a=>t[a]=e[a])}),a.newData=(0,y.default)({},e),a.oldData=(0,y.default)({},e),Object.keys(e).map(t=>l[t]={value:e[t]}),this.setState({fwParam:this.state.fwParam,formData:l,refData:{}})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null)}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.CustomizedForm;return o.default.createElement("div",null,o.default.createElement(g.default,{spinning:this.props.loading||this.state.loading},o.default.createElement(e,{onChange:this.handleFormChange}),this.getLayout().columns.some(e=>e.visible&&"MAP"==e.ui)?o.default.createElement(A.Map,{height:"50vh",showQueryControl:!0,onRef:e=>this.setState({map:e})}):null),Object.values(this.state.dialogs))}})||P);t.default=G},TzGd:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("jCWc");var r=i(a("kPKH"));a("14J3");var s=i(a("BMrR")),n=i(a("MVZn"));a("B9cy");var d=i(a("Ol7k"));a("ozfa");var u,c,f=i(a("MJZm")),h=a("MuoO"),m=(i(a("usdK")),l(a("dNXO"))),p=i(a("FsLl")),v=f.default.TreeNode;d.default.Header,d.default.Footer,d.default.Sider,d.default.Content;function g(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout,o=e.tree.treeData;return{loading:e.loading.models.tree,dispatch:a,fwCoord:l,layout:i,treeData:o}}var w=e=>{return{getTreeData:t=>{var a=t.fwParam,l=t.fwCoord,i=t.callback;e({type:"tree/getTreeData",payload:{fwParam:a,fwCoord:l,callback:i}})},validDeleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/validDeleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},deleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/deleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},loadLayout:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,fwParam:l,callback:i}})}}},y=(u=(0,h.connect)(g,w),u(c=class extends o.Component{constructor(e){super(e),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,n.default)({},this.state.fwParam,{openerSelectedData:(0,n.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,n.default)({},this.getFwCoord(),a),callback:l||(e=>{var t=e.data.length>0?e.data.filter((e,t)=>0==t).map(e=>String(e[this.getLayout().argument.treeIdField]))[0]:null;this.setState({treeData:e.data,loadedKeys:{},selectedKeys:t?[t]:[],expandedKeys:t?[t]:[]}),this.onTreeNodeSelected(t?[t]:[],{})})})}),this.onTreeNodeSelected=((e,t)=>{var a=t.selected,l=t.selectedNodes,i=t.node;t.event;console.info("onTreeNodeSelected",e,a,i,l),this.props.onSelectTreeNode&&(e&&e.length>0?this.props.onSelectTreeNode(e[0],this.findNode(e[0])):this.props.onSelectTreeNode(null));var o=null;a?(i||(i=this.findNode(e[0])),i&&(o=i.props&&i.props.dataRef?i.props.dataRef:i)):i&&(o=i.props&&i.props.dataRef?i.props.dataRef:i,e.push(String(o[this.getLayout().argument.treeIdField]))),this.setState({selectedKeys:e,selectedRecord:o})}),this.onTreeNodeChecked=((e,t)=>{var a={};e&&e.map(e=>{a[e]=!0}),this.setState({newCheckedKeys:a})}),this.renderTreeNodes=(e=>e?e.map(e=>o.default.createElement(v,{title:e[this.getLayout().argument.treeLabelField],key:String(e[this.getLayout().argument.treeIdField]),isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children))):null),this.onTreeLoadData=(e=>new Promise(t=>{if(console.info(e.props),e.props.dataRef.children)return this.state.loadedKeys[e.props.eventKey]=!0,t(),void this.setState({loadedKeys:this.state.loadedKeys});this.getTreeData({fwParam:{selectedTreeNodeId:e.props.eventKey},callback:a=>{e.props.dataRef.children=a.data,this.state.loadedKeys[e.props.eventKey]=!0,t(),this.setState({treeData:this.state.treeData,loadedKeys:this.state.loadedKeys})}})})),this.findNode=((e,t)=>{var a=t;if(void 0==a)a=this.state.treeData;else if(null==t||t.length<1)return null;var l=a.filter(t=>t[this.getLayout().argument.treeIdField]==e);if(l.length>0)return l[0];var i=a.filter(e=>e.children&&e.children.length>0).map(t=>this.findNode(e,t.children)).filter(e=>!!e);return i.length>0?i[0]:null}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,n.default)({},this.props.fwCoord,this.props.innerFwCoord,this.state.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.onComponentRef=((e,t)=>{this.state.components[e]=t}),this.getComponent=(e=>{return this.state.components[e]}),this.getActionEntry=function(e){return m.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,this.state.selectedRecord,-1,l)},this.state=(0,n.default)({},e,{dialogs:{},components:{},actionInList:[],fwParam:(0,n.default)({},e.fwParam),buttonSize:e.buttonSize?e.buttonSize:"small",selectedKeys:[],selectedRecord:null,showCheckBox:!!e.showCheckBox&&e.showCheckBox,checkStrictly:!1,checkedKeys:{},expandedAllNodes:!1,expandedKeys:[],loadedKeys:{}})}componentWillReceiveProps(e){if((e.openerSelectedData||e.innerLayout||e.innerFwCoord)&&(e.openerSelectedData!=this.props.openerSelectedData||e.innerLayout!=this.props.innerLayout||e.innerFwCoord!=this.props.innerFwCoord)){console.info("tree receive props2",e);var t=e.innerLayout?e.innerLayout:this.getLayout();this.state.innerLayout=t,this.state.innerFwCoord=e.innerFwCoord,this.refresh()}}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){this.getLayout().onQuery&&this.getActionEntry(this.getLayout().onQuery).logic(this,this.getLayout().onQuery,null,-1,null)}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=m.buildGridMenus(this,p.default),t=m.buildGridQueryArea(this);return o.default.createElement("div",{className:p.default.normal,style:{padding:"10px"}},o.default.createElement("div",{style:{paddingBottom:10}},o.default.createElement(s.default,null,t),o.default.createElement(s.default,null,o.default.createElement(r.default,{span:24,style:{textAlign:"left"}},e))),o.default.createElement("div",{className:"search-result-list"},o.default.createElement(f.default,{checkable:this.state.showCheckBox,checkStrictly:this.state.checkStrictly,autoExpandParent:this.state.expandedAllNodes,selectedKeys:this.state.selectedKeys,onSelect:(e,t)=>this.onTreeNodeSelected(e,t),defaultCheckedKeys:Object.keys(this.state.checkedKeys),checkedKeys:Object.keys(this.state.checkedKeys),onCheck:(e,t)=>this.onTreeNodeChecked(e,t),expandedKeys:this.state.expandedKeys,onExpand:(e,t)=>{t.expanded,t.node;return this.setState({expandedKeys:e})},loadData:e=>this.onTreeLoadData(e),loadedKeys:Object.keys(this.state.loadedKeys)},this.renderTreeNodes(this.state.treeData))),Object.values(this.state.dialogs))}})||c);t.default=y},VJei:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=c,t.logic=f,t.handleOk=h,t.handleCancel=m;var o=i(a("q1tI"));a("2qtc");var r=i(a("kLXV"));a("+L6B");var s=i(a("2/Rp")),n=i(a("MVZn"));a("miYZ");var d=i(a("tsqr"));a("Pwec");var u=i(a("CtXQ"));l(a("uYVn"));function c(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],console.info("layout executed",this),o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(u.default,{type:this.action.icon}),this.action.label," "))}function f(e,t,l,i,u){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=u,null==l&&this.view.state.selectedRowKeys&&this.view.state.selectedRowKeys.length>0){var c=this.view.state.selectedRowKeys[0];this.record=this.view.state.data[c],this.recordIndex=c}if(this.record||null!=this.action.argument&&void 0!=this.action.argument.needSelectData&&null!=this.action.argument.needSelectData&&"1"!=this.action.argument.needSelectData){var f=(0,n.default)({},this.view.getFwCoord(),{view:"detail"});this.action.argument&&(this.action.argument.function&&(f["function"]=this.action.argument.function),this.action.argument.view&&(f["view"]=this.action.argument.view));var h={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{}},m=null;if(console.info("this.action",this.action),this.action.argument&&this.action.argument.antdPath){var p=this.action.argument.antdPath;m=a("RO01")(`./${p}`).default}else m=a("i307").default;var v=e=>{if(this.innerLayout=e,l){var t=this.view.state.dialogs,i=e.columns.filter(e=>e.visible),u=i.length<5?"25vw":"42vw",c=[],p=(0,n.default)({},this.record);p.ADDRESS&&(p.ADDRESS=p.ADDRESS.split(";")[0].split("\u3001").join("")),p.MEMBER_ADDRESS&&(p.MEMBER_ADDRESS=p.MEMBER_ADDRESS.split(";")[0].split("\u3001").join(""));var v='GPS\u8bbe\u5907\u4f4d\u7f6e:<br>{LOC_TIME}<br>{ADDRESS}(<a href=\'javascript:{window.copy("{ADDRESS}");window.message.info("\u590d\u5236\u6210\u529f")}\'>\u590d\u5236</a>)';Object.keys(p).map(e=>{v=v.split("{"+e+"}").join(p[e])});var g=[{id:"device_location",name:"GPS\u4f4d\u7f6e",lat:p.LAT,lng:p.LNG,icon:a("wBPp"),infoContent:v,buttonOpts:{offset:{x:20,y:100}}}];p.MEMBER_LAT&&p.MEMBER_LNG&&(v='\u8f66\u4e3b\u624b\u673a\u5b9a\u4f4d\u4f4d\u7f6e:<br>{MEMBER_LOC_TIME}<br>{MEMBER_ADDRESS}(<a href=\'javascript:{window.copy("{MEMBER_ADDRESS}");window.message.info("\u590d\u5236\u6210\u529f")}\'>\u590d\u5236</a>)',Object.keys(p).map(e=>{v=v.split("{"+e+"}").join(p[e])}),g.push({id:"member_location",name:"\u624b\u673a\u4f4d\u7f6e",lat:p.MEMBER_LAT,lng:p.MEMBER_LNG,icon:a("bOKo"),infoContent:v,buttonOpts:{offset:{x:20,y:60}}})),c.push(o.default.createElement(s.default,{key:"back",onClick:e=>this.handleCancel(e)},"\u5173\u95ed")),this.action.argument&&this.action.argument.showActions&&this.action.argument.showActions.split(",").map(e=>{var t=this.view.getLayout().actionArgs[e];this.view.getActionEntry(t.click).isValid(this.view,e,l)&&c.push(o.default.createElement(s.default,{key:e,onClick:t=>this.view.handleAction((0,n.default)({},t,{fwSourceAction:this}),e,this.record)},t.label))}),t[this.id]=o.default.createElement(r.default,{width:u,key:this.id,title:e.title,visible:!0,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4fdd\u5b58",onOk:e=>this.handleOk(e),footer:c},o.default.createElement(m,{selectedData:this.record,innerLayout:e,innerFwCoord:f,fwParam:h,showAsDialog:!0,dataManaged:!0,initData:l,points:g,mapOptions:{showNavigationControl:{type:3}},onRef:e=>this.onRef(e)})),this.view.setState({dialogs:t})}else d.default.error("\u52a0\u8f7d\u6570\u636e\u9519\u8bef",10)};this.innerLayout?v(this.innerLayout):this.view.props.loadLayout({fwCoord:f,fwParam:h,callback:v})}else d.default.error("\u8bf7\u9009\u62e9\u8981\u67e5\u770b\u7684\u6570\u636e",5)}function h(e){}function m(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},VeyQ:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=h,t.logic=m,t.handleOk=p,t.handleCancel=v;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr")),s=i(a("MVZn"));a("Pwec");var n=i(a("CtXQ"));a("2qtc");var d=i(a("kLXV")),u=l(a("uYVn")),c=i(a("wd/R"));a("XDpg"),c.default.locale("zh-cn");var f=d.default.confirm;function h(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(n.default,{type:this.action.icon}),this.action.label," "))}function m(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,console.info("event",i.ctrlKey),f({title:"\u786e\u8ba4\u6e05\u7a7a?",okText:"\u786e\u8ba4\u8bf7\u7a7a",okType:"danger",cancelText:"\u4e0d\u6e05\u7a7a",onOk:()=>this.view.refresh(),onCancel(){console.log("Cancel")}})}function p(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{a?console.info("error",a):(console.info("values",l,this.dialog.props.fwParam.oldData),this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:(0,s.default)({},this.dialog.state.fwParam),callback:a=>{if(a.success)u.isEmpty(a.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(a.errorMsg,10),this.dialog.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}u.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}}))})}function v(e){var t=this.dialog.state.dialogs;delete t[this.id],this.dialog.setState({dialogs:t})}},WSuX:function(e,t,a){var l={"./fw/default/_default":"OKjh","./fw/default/_default.js":"OKjh","./fw/default/clear_create":"VeyQ","./fw/default/clear_create.js":"VeyQ","./fw/default/delete_single":"7nvx","./fw/default/delete_single.js":"7nvx","./fw/default/delete_single_in_tree":"XgPo","./fw/default/delete_single_in_tree.js":"XgPo","./fw/default/direct_edit_and_save":"KIuD","./fw/default/direct_edit_and_save.js":"KIuD","./fw/default/export":"fc8R","./fw/default/export.js":"fc8R","./fw/default/formatter/date_formatter":"WhAu","./fw/default/formatter/date_formatter.js":"WhAu","./fw/default/formatter/datetime_formatter":"a29C","./fw/default/formatter/datetime_formatter.js":"a29C","./fw/default/get_import_template":"IrKK","./fw/default/get_import_template.js":"IrKK","./fw/default/import":"I0v2","./fw/default/import.js":"I0v2","./fw/default/init_create":"CSog","./fw/default/init_create.js":"CSog","./fw/default/init_edit":"yXd3","./fw/default/init_edit.js":"yXd3","./fw/default/init_list":"pM3X","./fw/default/init_list.js":"pM3X","./fw/default/init_select":"lRx8","./fw/default/init_select.js":"lRx8","./fw/default/init_tree":"dc/6","./fw/default/init_tree.js":"dc/6","./fw/default/query_grid":"xdQr","./fw/default/query_grid.js":"xdQr","./fw/default/save_create":"GfkI","./fw/default/save_create.js":"GfkI","./fw/default/save_edit":"tMO9","./fw/default/save_edit.js":"tMO9","./fw/default/save_rightList":"MwAd","./fw/default/save_rightList.js":"MwAd","./fw/default/save_select":"8zqI","./fw/default/save_select.js":"8zqI","./fw/default/show_change_password":"JGZg","./fw/default/show_change_password.js":"JGZg","./fw/default/show_create":"sbYD","./fw/default/show_create.js":"sbYD","./fw/default/show_create_child_in_tree":"TTD2","./fw/default/show_create_child_in_tree.js":"TTD2","./fw/default/show_create_sibling_in_tree":"SFtx","./fw/default/show_create_sibling_in_tree.js":"SFtx","./fw/default/show_detail":"0TFb","./fw/default/show_detail.js":"0TFb","./fw/default/show_edit":"MZF9","./fw/default/show_edit.js":"MZF9","./fw/default/show_edit_in_tree":"Yjr6","./fw/default/show_edit_in_tree.js":"Yjr6","./fw/default/show_map":"eCda","./fw/default/show_map.js":"eCda","./fw/default/show_map_without_query":"HpKK","./fw/default/show_map_without_query.js":"HpKK","./fw/default/show_select":"7IhZ","./fw/default/show_select.js":"7IhZ","./fw/default/validator/mobile_no_validator":"CD6Z","./fw/default/validator/mobile_no_validator.js":"CD6Z","./got":"uYVn","./got.js":"uYVn","./logic":"cVhF","./logic.js":"cVhF","./projects/zd4s/cancel_and_close_edit":"CxPR","./projects/zd4s/cancel_and_close_edit.js":"CxPR","./projects/zd4s/export_steal_insurance_pdf":"c+ja","./projects/zd4s/export_steal_insurance_pdf.js":"c+ja","./projects/zd4s/formatter/insurance_status_formatter":"vvwl","./projects/zd4s/formatter/insurance_status_formatter.js":"vvwl","./projects/zd4s/formatter/message_address_formatter":"4fPC","./projects/zd4s/formatter/message_address_formatter.js":"4fPC","./projects/zd4s/formatter/vehicle_number_vin_formatter":"ITHm","./projects/zd4s/formatter/vehicle_number_vin_formatter.js":"ITHm","./projects/zd4s/show_create_shop":"ApSM","./projects/zd4s/show_create_shop.js":"ApSM","./projects/zd4s/show_create_wash_ticket":"bfXB","./projects/zd4s/show_create_wash_ticket.js":"bfXB","./projects/zd4s/show_edit_member":"fs94","./projects/zd4s/show_edit_member.js":"fs94","./projects/zd4s/show_edit_vehicle":"8vKD","./projects/zd4s/show_edit_vehicle.js":"8vKD","./projects/zd4s/show_edit_wash_car_ticket_single":"Lpwu","./projects/zd4s/show_edit_wash_car_ticket_single.js":"Lpwu","./projects/zd4s/show_member_detail":"Xu3f","./projects/zd4s/show_member_detail.js":"Xu3f","./projects/zd4s/show_message_map":"VJei","./projects/zd4s/show_message_map.js":"VJei","./projects/zd4s/show_vehicle_location":"+p4c","./projects/zd4s/show_vehicle_location.js":"+p4c","./projects/zd4s/simulate_login":"rq8y","./projects/zd4s/simulate_login.js":"rq8y","./projects/zd4s/validator/vin_validator":"CYmM","./projects/zd4s/validator/vin_validator.js":"CYmM","./render":"VEnL","./render.js":"VEnL"};function i(e){var t=o(e);return a(t)}function o(e){var t=l[e];if(!(t+1)){var a=new Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}return t}i.keys=function(){return Object.keys(l)},i.resolve=o,e.exports=i,i.id="WSuX"},WhAu:function(e,t,a){"use strict";var l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=l(a("uYVn"));function o(e,t,a,l,o){if(e){var r=i.toDate(e);if(null!=r)return r.format?r.format("yyyy-MM-dd"):r}return""}},XgPo:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=h,t.logic=m;var o=i(a("q1tI"));a("P2fV");var r=i(a("NJEC"));a("Pwec");var s=i(a("CtXQ"));a("miYZ");var n=i(a("tsqr")),d=i(a("MVZn"));a("2qtc");var u=i(a("kLXV")),c=l(a("uYVn")),f=u.default.confirm;function h(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement(r.default,{key:this.action.fw_index,title:"\u786e\u8ba4\u8981\u5220\u9664\u5417?",visible:!!this.view.state.deleteConfirmVisible&&this.view.state.deleteConfirmVisible[l],onVisibleChange:e=>{var t=(0,d.default)({},this.view.state.deleteConfirmVisible);t[l]=e,e?this.view.props.validDeleteData({fwCoord:this.view.getFwCoord(),fwParam:(0,d.default)({},this.view.state.fwParam,{newListData:[a]}),callback:e=>{e.success?this.view.setState({deleteConfirmVisible:t}):c.isEmpty(e.errorMsg)||n.default.error(e.errorMsg,10)}}):this.view.setState({deleteConfirmVisible:t})},onConfirm:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(s.default,{type:this.action.icon}),this.action.label," "))}function m(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i;this.view.getLayout().argument.treeIdField,this.view.getLayout().argument.treeParentIdField;if(!this.record){var o=null;this.view.state.selectedKeys&&this.view.state.selectedKeys.length>0&&(o=this.view.state.selectedKeys[0]);var r=null;o&&(r=this.view.findNode(o)),this.record=r}if(null!=this.record)if(this.record.GOT_PID){var s=!0;this.record=(0,d.default)({},this.record,{children:null});var u=(0,d.default)({},this.view.state.fwParam,{newListData:[this.record]}),h=()=>{this.view.props.deleteData({fwCoord:this.view.getFwCoord(),fwParam:u,callback:e=>{if(e.success){c.isEmpty(e.errorMsg)?n.default.success("\u5220\u9664\u6210\u529f"):n.default.info(e.errorMsg,10);try{var t=this.view.getLayout().argument.treeIdField,a=(this.view.getLayout().argument.treeParentIdField,this.view.findNode(this.record.GOT_PID));a&&(a.children=a.children.filter(e=>e[t]!=this.record[t]),0==a.children.length&&(a.GOT_SUBCOUNT=0)),this.view.onTreeNodeSelected([this.record.GOT_PID],{selected:!0,node:a}),this.view.setState({treeData:this.view.state.treeData})}catch(e){console.error(e)}}else c.isEmpty(e.errorMsg)||n.default.error(e.errorMsg,10)}})};s?this.view.props.validDeleteData({fwCoord:this.view.getFwCoord(),fwParam:u,callback:e=>{e.success?f({title:"\u786e\u8ba4\u8981\u5220\u9664"+this.record[this.view.getLayout().argument.treeLabelField]+"\u5417?",okText:"\u786e\u8ba4",okType:"danger",cancelText:"\u53d6\u6d88",onOk(){h()},onCancel(){console.log("Cancel")}}):c.isEmpty(e.errorMsg)||n.default.error(e.errorMsg,10)}}):h()}else n.default.info(this.action.argument&&this.action.argument.canNotDeleteRootPrompt?this.action.argument.canNotDeleteRootPrompt:"\u4e0d\u80fd\u5220\u9664\u6839\u8282\u70b9",10);else n.default.info("\u8bf7\u9009\u62e9\u8981\u5220\u9664\u7684\u8282\u70b9",5)}},Xu3f:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=u,t.logic=c,t.handleOk=f,t.handleCancel=h;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr")),s=i(a("MVZn"));a("Pwec");var n=i(a("CtXQ")),d=l(a("uYVn"));function u(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(n.default,{type:this.action.icon}),this.action.label," "))}function c(e,t,a,l,i,o){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,e.props.openMainTab("memberDetail","\u4f1a\u5458\u8d44\u6599","projects/zd4s/memberDetail",{memberIdAndCarId:a.SID+","+a.VEHICLE_ID,prePath:e.props.mainPagePath})}function f(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("create error",a);else{var i=this.dialog.state.formData,o=this.dialog.state.fwParam.newData;Object.keys(i).map(e=>o[e]=i[e].value);var n=(0,s.default)({},this.dialog.state.fwParam,{newData:o,processType:"secondStep"});this.dialog.props.saveCreateData({fwCoord:this.dialog.getFwCoord(),fwParam:n,callback:a=>{if(a.success)d.isEmpty(a.errorMsg)?r.default.success("\u53d1\u5238\u6210\u529f"):r.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}d.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}})}})}function h(e){var t=this.view.state.dialogs;delete t[this.id],delete t[this.id+"2"],this.view.setState({dialogs:t})}},Yjr6:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=c,t.logic=f,t.handleOk=h,t.handleCancel=m;var o=i(a("q1tI"));a("2qtc");var r=i(a("kLXV")),s=i(a("MVZn"));a("miYZ");var n=i(a("tsqr"));a("Pwec");var d=i(a("CtXQ")),u=l(a("uYVn"));function c(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(d.default,{type:this.action.icon}),this.action.label," "))}function f(e,t,l,i,d){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=d;var u=this.view.getLayout().argument.treeIdField,c=this.view.getLayout().argument.treeParentIdField;if(!this.record){var f=null;this.view.state.selectedKeys&&this.view.state.selectedKeys.length>0&&(f=this.view.state.selectedKeys[0]);var h=null;f&&(h=this.view.findNode(f)),this.record=h}if(null!=this.record){e.getLayout().argument.treeCanAddRoot,this.record=(0,s.default)({},this.record,{children:null});var m=(0,s.default)({},this.view.getFwCoord(),{view:"edit"});this.view.getLayout().argument&&this.view.getLayout().argument.treeFunction&&(m["function"]=this.view.getLayout().argument.treeFunction);var p={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{},selectedTreeNodeId:this.record?this.record[u]:null},v=null;if(console.info("this.action",this.action),this.action.argument&&this.action.argument.antdPath){var g=this.action.argument.antdPath;v=a("RO01")(`./${g}`).default}else v=a("Tpzm").default;var w=(e,t)=>{if(e){var a=e.filter(e=>e[u]!=t).map(e=>(0,s.default)({},e));return a.map(e=>{e.children&&(e.children=w(e.children,t))}),a}return null},y=e=>{e.columns.filter(e=>e.id==c).map(e=>e.editable=!!this.record.GOT_PID),this.innerLayout||(this.innerLayout={}),this.innerLayout[t]=e,this.view.props.getEditData({fwCoord:m,fwParam:(0,s.default)({},p,{selectedData:this.record}),callback:t=>{if(t){var a=w(this.view.state.treeData,t[u]),l=this.view.state.dialogs,i=e.columns.filter(e=>e.visible),s=i.length>=5||i.some(e=>"MAP"==e.ui)?"42vw":"25vw";l[this.id]=o.default.createElement(r.default,{width:s,key:this.id,title:e.title,visible:!0,maskClosable:!1,confirmLoading:this.view.props.editLoading,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4fdd\u5b58",onOk:e=>this.handleOk(e)},o.default.createElement(v,{selectedData:this.record,innerLayout:e,innerFwCoord:m,fwParam:p,showAsDialog:!0,dataManaged:!0,initData:t,onRef:e=>this.onRef(e),treeData:a})),this.view.setState({dialogs:l})}else n.default.error("\u52a0\u8f7d\u6570\u636e\u9519\u8bef",10)}})};this.innerLayout&&this.innerLayout[t]?y(this.innerLayout[t]):this.view.props.loadLayout({fwCoord:m,fwParam:p,callback:y})}else n.default.info("\u8bf7\u9009\u62e9\u8981\u7f16\u8f91\u7684\u8282\u70b9",5)}function h(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{var i=this.dialog.state.formData,o=this.dialog.state.fwParam.newData;Object.keys(i).map(e=>o[e]=i[e].value);var r=(0,s.default)({},this.dialog.state.fwParam,{newData:o});this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:r,callback:a=>{if(a.success){u.isEmpty(a.errorMsg)?n.default.success("\u4fdd\u5b58\u6210\u529f"):n.default.info(a.errorMsg,10);try{var i=r.oldData,o=r.newData,s=this.view.getLayout().argument.treeIdField,d=this.view.getLayout().argument.treeParentIdField,c=this.view.findNode(o[s]);if(c&&Object.keys(o).map(e=>c[e]=o[e]),i[d]!=o[d]){var f=this.view.findNode(i[d]);f&&(f.children=f.children.filter(e=>e[s]!=i[s]),0==f.children.length&&(f.GOT_SUBCOUNT=0));var h=this.view.findNode(o[d]);h&&(h.children?h.children.push(c):h.GOT_SUBCOUNT?h.GOT_SUBCOUNT+=1:h.GOT_SUBCOUNT=1)}this.view.setState({treeData:this.view.state.treeData}),this.handleCancel(e)}catch(e){console.error(e)}}else{if(a.validResultMap){var m={};Object.keys(a.validResultMap).map(e=>{m[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(m)}u.isEmpty(a.errorMsg)||n.default.error(a.errorMsg,10)}}})}})}function m(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},Yn9z:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("14J3");var r=i(a("BMrR"));a("jCWc");var s=i(a("kPKH"));a("+L6B");var n=i(a("2/Rp"));a("DZo9");var d=i(a("8z0m"));a("miYZ");var u=i(a("tsqr"));a("giR+");var c=i(a("fyUT"));a("Xi6J");var f=i(a("kl6h"));a("iQDF");var h=i(a("+eQT"));a("O3gP");var m=i(a("lrIw"));a("6UJt");var p=i(a("DFOY"));a("nRaC");var v=i(a("5RzL"));a("T2oS");var g=i(a("W9HT")),w=i(a("pVnL")),y=i(a("MVZn"));a("sRBo");var C=i(a("kaz8"));a("7Kak");var D=i(a("9yH6"));a("OaEy");var E=i(a("2fM7"));a("5NDa");var b=i(a("5rEg"));a("y8nQ");var S=i(a("Vl3Y"));a("ozfa");var L,P,k=i(a("MJZm")),I=a("MuoO"),R=(i(a("QCDS")),l(a("uYVn"))),T=l(a("dNXO")),A=a("0Fy/"),_=i(a("wd/R"));a("XDpg"),_.default.locale("zh-cn");var O=k.default.TreeNode,M=S.default.Item,F=b.default.TextArea,N=E.default.Option,j=D.default.Group,V=C.default.Group,x={labelCol:{xs:{span:8},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16}}};function z(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.create,dispatch:a,fwCoord:l,layout:i}}var Y=e=>{return{getCreateData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"create/getCreateData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveCreateData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"create/saveCreateData",payload:{fwCoord:a,fwParam:l,callback:i}})}}},G=(L=(0,I.connect)(z,Y),L(P=class extends o.Component{constructor(e){super(e),this.convertToCascadeData=((e,t)=>{return e?e.map(e=>{return e.value=e[t.value],e.label=e[t.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e.children&&(e.children=this.convertToCascadeData(e.children,t)),e}):null}),this.loadCascaderData=((e,t)=>{var a=e[e.length-1];a.loading=!0;var l=t.valueRef;this.getTreeData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:l.function,view:l.view}),fwParam:{distinct:l.distinct?l.distinct:null,queryColumns:l.value+","+l.label+(l.otherRefs?","+l.otherRefs:"")+(l.disableColumn?","+l.disableColumn:""),selectedTreeNodeId:e.map(e=>e[l.value]).join(","),selectedData:l.useCurrentData?this.getEditedNewData():null},callback:e=>{a.loading=!1,a.children=this.convertToCascadeData(e.data,l),this.setState({refData:this.state.refData})}})}),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,y.default)({},this.state.fwParam,{openerSelectedData:(0,y.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,y.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(O,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+(t.valueRef.otherRefs?","+t.valueRef.otherRefs:"")+(t.valueRef.disableColumn?","+t.valueRef.disableColumn:""),selectedTreeNodeId:e.props.eventKey,selectedData:t.valueRef.useCurrentData?this.getEditedNewData():null},callback:e=>{i.children=e.data,a.defaultOpen=!0,console.info(a.data),l(),this.setState({refData:this.state.refData})}}))})),this.onCascaderChange=((e,t,a)=>{if(console.info("onCascaderChange",e.id,t,a),"ADDRESS_SELECT"==e.id){var l=this.state,i=l.fwParam,o=l.formData,r=l.manualValues;i.newData||(i.newData={}),i.newData[e.id]=t.join(","),o[e.id]||(o[e.id]={}),o[e.id].value=t.join(","),r[e.id]=t,this.setState({fwParam:i,manualValues:r,formData:o})}}),this.onAutoCompleteSelect=((e,t,a)=>{console.info("onAutoCompleteSelect",e.id,t,a)}),this.onSelectChange=((e,t,a)=>{console.info("onSelectChange",e.id,t,a)}),this.onSelectSelect=((e,t,a)=>{console.info("onSelectSelect",e.id,t,a)}),this.MONEY_IDS={},this.getInputComponent=((e,t)=>{var a=this.state,l=a.components,i=a.refData,r=a.fwParam,s=a.formData,n=null,S={disabled:!e.editable,style:{width:"85%"}};t&&(S.value=this.state.manualValues[e.id]);var L="",P="";if(e.editable&&(L=e.prompt?e.prompt:"\u8bf7\u8f93\u5165",P=e.prompt?e.prompt:"\u8bf7\u9009\u62e9"),"label"==e.ui)n=this.getDisplayValue(e);else if("MEMO"===e.type)n=o.default.createElement(F,(0,w.default)({},S,{rows:4}));else if("checkbox01"===e.ui)n=o.default.createElement(C.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictList[e.dictionary]){var k=this.getLayout().dictList[e.dictionary];if("radio"==e.ui)n=o.default.createElement(j,(0,w.default)({name:e.id},S),k.map(e=>o.default.createElement(D.default,{key:e.value,value:String(e.value)},e.label)));else if("checkbox"==e.ui){var I=k;n=o.default.createElement(V,(0,w.default)({name:e.id},S,{options:I}))}else n=o.default.createElement(E.default,(0,w.default)({},S,{placeholder:P,showSearch:!0,mode:e.multiSelect?"multiple":null,optionFilterProp:"children",filterOption:(e,t)=>t.props.children.toLowerCase().indexOf(e.toLowerCase())>=0}),k.map(e=>o.default.createElement(N,{key:e.value,value:e.value},e.label)))}else if("TreeSelect"===e.ui&&e.valueRef){var R=e.valueRef;if(!i[e.id]){var T=null;R.function==this.props.fwParam.openerFunction&&R.view==this.props.fwParam.openerView&&this.props.treeData&&(T=this.props.treeData),i[e.id]={loading:!1,data:T,queryIndex:0,defaultOpen:!1}}var A=i[e.id];A.data||(A.data=[],this.props.getTreeData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:R.function,view:R.view}),fwParam:{distinct:R.distinct?R.distinct:null,queryColumns:R.value+","+R.label+(R.otherRefs?","+R.otherRefs:"")+(R.disableColumn?","+R.disableColumn:""),selectedId:r&&r.newData&&r.newData[e.id]?r.newData[e.id]:null},callback:t=>{t.success?(A.data=t.data,A.loading=!1,i[e.id]=A,this.setState({refData:i})):A.data=null}})),n=o.default.createElement(v.default,(0,w.default)({},S,{placeholder:P,notFoundContent:A.loading?o.default.createElement(g.default,{size:"small"}):"\u65e0\u6570\u636e",showArrow:!0,showSearch:!0,searchPlaceholder:"\u8f93\u5165\u641c\u7d22",filterTreeNode:(e,t)=>{return console.info("treeNode",t),t.props.title.indexOf(e)>=0},treeNodeFilterProp:"title",filterOption:!1,loadData:t=>this.onTreeSelectLoadData(t,e,A),treeExpandedKeys:A.expandedKeys?A.expandedKeys:A.data.map(e=>String(e[R.value])),onTreeExpand:e=>{A.expandedKeys=e,A.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:A.defaultOpen,onSearch1:t=>{A.timeout&&(clearTimeout(A.timeout),A.timeout=null),A.currentValue=t;var a=()=>{console.info(t),A.loading=!0,this.props.getRefData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:R.function,view:R.view}),fwParam:{queryStr:t,distinct:R.distinct?R.distinct:null,queryColumns:R.value+","+R.label+(R.otherRefs?","+R.otherRefs:"")+(R.disableColumn?","+R.disableColumn:"")},callback:a=>{A.currentValue==t&&(A.data=a.data,A.loading=!1,A.defaultOpen=!0,s[e.id].value=t,this.setState({refData:i,fwParam:r,formData:s}))}})};A.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(A.data,R))}else if("Cascader"==e.ui&&e.valueRef){var _=e.valueRef;if(!i[e.id]){var O={};O[_.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),O[_.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var M=i[e.id];M.data||(M.data=[],this.props.getTreeData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:_.function,view:_.view}),fwParam:{distinct:_.distinct?_.distinct:null,queryColumns:_.value+","+_.label+(_.otherRefs?","+_.otherRefs:"")+(_.disableColumn?","+_.disableColumn:""),selectedData:_.useCurrentData?this.getEditedNewData():null},callback:t=>{t.success?(M.data=this.convertToCascadeData(t.data,_),M.loading=!1,i[e.id]=M,this.setState({refData:i})):M.data=null}})),n=o.default.createElement(p.default,(0,w.default)({},S,{placeholder:P,options:M.data,loadData:t=>this.loadCascaderData(t,e),onChange:(t,a)=>this.onCascaderChange(e,t,a),showSearch:{filter:(e,t)=>{return t.some(t=>t.label.toLowerCase().indexOf(e.toLowerCase())>-1)}}}))}else if("AutoComplete"==e.ui&&e.valueRef){var x=e.valueRef;i[e.id]||(i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i}));var z=i[e.id];n=o.default.createElement(m.default,(0,w.default)({},S,{placeholder:L,dataSource:z.data,defaultOpen:z.defaultOpen,onSelect:(t,a)=>this.onAutoCompleteSelect(e,t,a),onSearch:e=>{z.timeout&&(clearTimeout(z.timeout),z.timeout=null),z.currentValue=e;var t=()=>{z.loading=!0,this.props.getRefData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:x.function,view:x.view}),fwParam:(0,y.default)({},this.state.fwParam,{queryValue:e,distinct:x.distinct?x.distinct:null,queryColumns:x.value+","+x.label+(x.otherRefs?","+x.otherRefs:"")+(x.disableColumn?","+x.disableColumn:""),selectedData:x.useCurrentData?this.getEditedNewData():null}),callback:t=>{if(z.currentValue==e){var a={};t.success&&t.data.map(e=>{a[e[x.label]]=e}),z.dataMap=a,z.data=Object.keys(a),z.loading=!1,z.defaultOpen=!0,z.autoFocus=!0,this.setState({refData:i,fwParam:r})}}})};z.timeout=setTimeout(t,900)}}))}else if(null!=e.valueRef){var Y=e.valueRef;if(!i[e.id]){var G={};G[Y.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),G[Y.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var q=i[e.id];q.data||(q.data=[],this.props.getRefData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:Y.function,view:Y.view}),fwParam:{distinct:Y.distinct?Y.distinct:null,queryColumns:Y.value+","+Y.label+(Y.otherRefs?","+Y.otherRefs:"")+(Y.disableColumn?","+Y.disableColumn:""),selectedData:Y.useCurrentData?this.getEditedNewData():null},callback:t=>{var a,l=[],o={};(t.success&&(l=t.data,l&&l.map(e=>o[e[Y.value]]=e)),e.showColumn)&&function(){console.info("showColumn",s[e.showColumn],s[e.id]);var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],i=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],o=null;if(i.length>0&&t.length==i.length)for(a=0;a<i.length;++a)l.some(e=>e[Y.value]==i[a])||(o={},o[Y.value]=i[a],o[Y.label]=t[a],l.push(o))}();q.data=l,q.dataMap=o,q.loading=!1,i[e.id]=q,this.setState({refData:i,formData:s})}}));var U=q.data.map(e=>o.default.createElement(N,{key:e[Y.value],disabled:Y.disableColumn&&e[Y.disableColumn]==Y.disableValue},e[Y.label],Y.otherRefs?Y.otherRefs.split(",").map(t=>{e[t]}):""));n=o.default.createElement(E.default,(0,w.default)({},S,{placeholder:P,showSearch:!0,mode:e.multiSelect?"multiple":null,notFoundContent:q.loading?o.default.createElement(g.default,{size:"small"}):"\u65e0\u6570\u636e",showArrow:!0,filterOption:!1,labelInValue:!0,autoFocus:q.autoFocus,defaultOpen:q.defaultOpen,onSelect:(t,a)=>this.onSelectSelect(e,t,a),onChange:(t,a)=>this.onSelectChange(e,t,a),onSearch:t=>{q.timeout&&(clearTimeout(q.timeout),q.timeout=null),q.currentValue=t;var a=()=>{q.loading=!0,this.props.getRefData({fwCoord:(0,y.default)({},this.getFwCoord(),{function:Y.function,view:Y.view}),fwParam:{queryValue:t,distinct:Y.distinct?Y.distinct:null,queryColumns:Y.value+","+Y.label+(Y.otherRefs?","+Y.otherRefs:"")+(Y.disableColumn?","+Y.disableColumn:""),selectedData:Y.useCurrentData?this.getEditedNewData():null},callback:a=>{if(q.currentValue==t){var l,o=[],r={};if(a.success&&(o=a.data,o&&o.map(e=>r[e[Y.value]]=e)),e.showColumn)(function(){var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],a=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],i=null;if(a.length>0&&t.length==a.length)for(l=0;l<a.length;++l)o.some(e=>e[Y.value]==a[l])||(i={},i[Y.value]=a[l],i[Y.label]=t[l],o.push(i))})();q.data=o,q.dataMap=r,q.loading=!1,q.defaultOpen=!0,q.autoFocus=!0,this.setState({refData:i})}}})};q.timeout=setTimeout(a,500)}}),U)}else if("DatePicker"===e.ui){var B=()=>!1;B=(t=>{var a=!1;return e.min&&t&&t<this.getRealDate(e.min).startOf("day")&&(a=!0),a||e.max&&t&&t>this.getRealDate(e.max).endOf("day")&&(a=!0),a}),n=o.default.createElement(h.default,(0,w.default)({},S,{disabledDate:e=>B(e),placeholder:P}))}else if("TimePicker"===e.ui)n=o.default.createElement(f.default,S);else if("InputNumber"===e.ui)n=o.default.createElement(c.default,(0,w.default)({},S,{placeholder:L}));else if("Upload"===e.ui){var K=(0,y.default)({},this.getFwCoord(),{view:"create"}),W={openerActionId:e.id,openerFunction:this.getFwCoord()["function"],openerView:this.getFwCoord().view,oldData:{},newData:{},saveType:"checkonly"},H=this.objectToFormInputs({fwCoord:K,fwParam:W},null,null),X={name:e.id+"_importFile",action:"/fw/importData?fwCoord.project="+this.getFwCoord().project+"&",data:H,onChange(t){if(this.view.setState({loading:!0}),t.file.status,"done"===t.file.status){var a=t.file.response;this.view.setState({uploadedFile:t.file.name,uploadResult:null,loading:!1}),a.success?(r.connectFilePath=a.connectFilePath,this.view.setState({fwParam:r}),u.default.info("\u6587\u4ef6\u6821\u9a8c\u901a\u8fc7")):a.connectFilePath?this.view.setState({uploadResult:o.default.createElement("span",{dangerouslySetInnerHTML:{__html:'<font color="#ff0000"><a href="/fw/download?fileName='+a.connectFilePath+'" target="_blank">\u4e0a\u4f20\u6587\u4ef6\u6709\u8bef\uff0c\u70b9\u6b64\u4e0b\u8f7d\u660e\u7ec6</a></font>'}})}):a.errorMsg&&u.default.error(a.errorMsg,10)}else"error"===t.file.status&&(this.view.setState({loading:!1}),u.default.error(`${e.label}\u5bfc\u5165\u9519\u8bef`,10))}};X.view=this;var Z=this.state.uploadedFile?this.state.uploadedFile:this.state.uploadShowLabel[e.id]?this.state.uploadShowLabel[e.id]:null;n=o.default.createElement(d.default,(0,w.default)({},S,X,{showUploadList:!1,style:{marginLeft:10}}),o.default.createElement("a",{href:"javascript:;"},Z||"\u70b9\u51fb\u4e0a\u4f20"))}else"MAP"==e.ui?(console.info("col.ui",e.ui),n=o.default.createElement(b.default,(0,w.default)({},S,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn;return n||(n=o.default.createElement(b.default,(0,w.default)({},S,{type:e.ui?e.ui:"text",placeholder:L}))),l[e.id]=n,n}),this.getRealDate=(e=>{if(0==e.indexOf("{today")&&e.indexOf("}")==e.length-1){var t=String(e).substring(6,e.length-1);return(0,_.default)().add(parseInt(t),"days")}return"today"==e?(0,_.default)():(0,_.default)(e)}),this.clearUpload=(e=>{var t=this.state,a=t.uploadShowLabel,l=t.formData;delete a[e.id],l[e.id]&&(l[e.id].value=null,l[e.id].dirty=!0),this.setState({uploadedFile:null,uploadShowLabel:a,formData:l})}),this.normFile=(e=>{return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.file&&e.file.response?e.file.response.success?e&&e.fileList:null:e&&e.fileList}),this.objectToFormInputs=function(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>this.objectToFormInputs(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]).replace(/%/g,"%25").replace(/\&/g,"%26").replace(/\+/g,"%2B").replace(/\=/g,"%3D"):this.objectToFormInputs(e[o],i,l)}return i},this.selectPointInMap=(e=>{var t=this.state.formData,a=this.getLayout().columnMap[e],l=a.showColumn.split(",");console.info("param",l,t),this.state.map.selectPoint({id:e,lat:t[l[0]]?t[l[0]].value:36,lng:t[l[1]]?t[l[1]].value:120,name:a.label,callback:(e,a,i,o,r)=>{console.info("callback",r,r.onlineStr),t[e]||(t[e]={}),t[l[0]]||(t[l[0]]={}),t[l[1]]||(t[l[1]]={}),t[e].value=r.onlineStr,t[l[0]].value=a,t[l[1]].value=i,console.info("newParam",a,i,t),this.setState({formData:t})}})}),this.handleFormChange=(e=>{if(e){var t=this.state,a=t.fwParam;t.formData;a.newData||(a.newData={}),Object.keys(e).map(t=>{var a=e[t],l=this.getLayout().columnMap[t],i=l.ui,o=null;if(a&&null!=a.value)if(this.state.formData[t]||(this.state.formData[t]={}),o=a.value,"DatePicker"===i)o=a.value.format(l.pattern?l.pattern:"YYYY-MM-DD");else if("TimePicker"===i)o=a.value.format(l.pattern?l.pattern:"HH:mm:ss");else if("checkbox01"===i)o=a.value?"1":"0";else if(l.dictionary)l.ui,Array.isArray(a.value)&&(o=a.value.join(","));else if("Cascader"==l.ui)Array.isArray(a.value)&&(o=a.value.join(","),console.info("Cascader",a.value,o));else if("AutoComplete"==l.ui)o=a.value;else if(l.valueRef&&"TreeSelect"!=l.ui){if(o=Array.isArray(a.value)?a.value.filter(e=>e&&e.key).map(e=>e.key).join(","):a.value.key?a.value.key:null,l.showColumn){var r=this.getLayout().columnMap[l.showColumn.split(",")[0]];if(r){var s=a.value.map(e=>Array.isArray(e.label)?e.label[0]:e.label).join(",");this.state.formData[r.id]||(this.state.formData[r.id]={}),this.state.formData[r.id].value=s}}}else"Upload"===l.ui?(console.info("upload",o),Array.isArray(o)&&(o=o[0].name)):"MAP"==l.ui?(o=this.state.formData[t].value,a.dirty=!0):("string"==typeof o&&(o=o.trim(!0),l.size>0&&o.length>l.size&&(o=o.substr(0,l.size))),"NUM"==l.type&&("number"!==typeof o&&(o=new String(o).split("").filter(e=>!R.isEmpty(e)).filter((e,t,a)=>0==t&&"-"==e||"."==e&&a.filter((e,a)=>a<t).every(e=>"."!=e)||R.isNumber(e)).join("")),void 0!=l.min&&null!=l.min&&(null==o||o<l.min)&&(o=l.min),void 0!=l.max&&null!=l.max?o>l.max&&(o=l.max):l.size&&o>Math.pow(10,l.size)-1&&(o=Math.pow(10,l.size)-1)));a.value=o}),this.setState({formData:(0,y.default)({},this.state.formData,e),fwParam:a})}}),this.doOtherInputValidate=(()=>{return null}),this.getEditedNewData=(()=>{var e=(0,y.default)({},this.props.clientNewData,this.state.fwParam.newData);return Object.keys(this.state.formData).map(t=>e[t]=this.state.formData[t].value),this.processNewData&&this.processNewData(e),e}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],r=i;if(e.onFormat)r=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var s=this.getLayout().dictMap[e.dictionary][i];r=s||i}else e.showColumn&&(r=e.showColumn.split(",").map(e=>t[e]).join(" "));return o.default.createElement("span",null,r)}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,y.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return T.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.FIX_WIDTH={},this.CustomizedForm=S.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t={};return this.getLayout().columns.filter(e=>e.visible).map(e=>{var a=(0,y.default)({},this.state.formData[e.id]);if(a&&null!=a.value)if("DatePicker"===e.ui)a.value=a.value?(0,_.default)(a.value,e.pattern?e.pattern:"YYYY-MM-DD"):a.value;else if("TimePicker"===e.ui)a.value=a.value?(0,_.default)(a.value,e.pattern?e.pattern:"HH:mm:ss"):a.value;else if("checkbox01"===e.ui)a.value="1"==a.value;else if(e.dictionary)"checkbox"==e.ui?Array.isArray(a.value)||(a.value=String(a.value).split(",")):e.multiSelect?a.value?a.value=String(a.value).split(","):a.value=null:a.value=String(a.value);else if("Cascader"==e.ui)a.value=String(a.value).split(",");else if("AutoComplete"==e.ui);else if(e.valueRef&&"TreeSelect"!=e.ui){if(Array.isArray(a.value)||(a.value?a.value=String(a.value).split(",").map(e=>({key:e})):a.value=[]),Array.isArray(a.value)&&e.showColumn){var l=this.state.formData[e.showColumn.split(",")[0]];l&&l.value&&l.value.split(",").map((e,t)=>a.value.length>t?a.value[t].label=e:null)}}else"MAP"==e.ui?a.value=a.value.split("\u3001").join(""):"NUM"!=e.type||e.dictionary?a.value=String(a.value):(""===a.value&&(a.value=null),a.value);(void 0===a.value||null===a.value||""===a.value||Array.isArray(a.value)&&0==a.value.length)&&delete a.value,t[e.id]=S.default.createFormField((0,y.default)({},a))}),t},onValuesChange(e,t){}})(e=>{this.state.form=e.form;var t=e.form.getFieldDecorator,l=this.getLayout().columns.filter(e=>e.visible),i={_default:[]},d={};this.getLayout().columnGroups&&this.getLayout().columnGroups.map(e=>d[e.id]=e),l.map(e=>{var t="_default";e.group&&d[e.group]&&(t=e.group),i[t]||(i[t]=[]),i[t].push(e)});var u=e=>e?e.map(e=>{var i=[],r=!1;if(e.editable&&(i.push({required:e.required,message:"\u8bf7\u8f93\u5165"+e.label}),"NUM"==e.type?e.dictionary||e.valueRef||(r=!0,e.max||e.size,e.min):e.dictionary||e.valueRef||"DatePicker"==e.ui||(r=!0,e.size)),e.onValidate&&this.getLayout().clientLogicMap[e.onValidate]){var d=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onValidate].file}`);i.push({validator:(t,a,l)=>{var i=[];a&&!d.validate(a,this.state.fwParam.newData,0,e,this)&&i.push(new Error(d.errorMsg(a,this.state.fwParam.newData,0,e,this))),l(i)}})}var u={valuePropName:"value",rules:i};return r&&(u.validateTrigger="onBlur"),"checkbox01"==e.ui?u.valuePropName="checked":"Upload"==e.ui&&(u.getValueFromEvent=this.normFile),o.default.createElement(s.default,{span:l.length>5||l.some(e=>"MAP"==e.ui)?12:24,key:e.id},o.default.createElement(M,(0,w.default)({},x,{label:e.label}),t(e.id,u)(this.getInputComponent(e)),"Upload"==e.ui&&(this.state.uploadedFile||this.state.uploadShowLabel[e.id])?o.default.createElement(n.default,{icon:"close",shape:"circle",style:{marginLeft:10,width:20,height:20,fontSize:8},onClick:()=>this.clearUpload(e)}):null,e.tail?" "+e.tail:null))}):[],c=[];return Object.keys(i).length>1?["_default",...this.getLayout().columnGroups.map(e=>e.id)].map(e=>{d[e]&&i[e]&&i[e].length>0&&c.push(o.default.createElement(s.default,{span:24,key:"group_"+e,style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,d[e].title))),c=[...c,...u(i[e])]}):c=u(l),l.some(e=>"Upload"==e.ui)&&c.push(o.default.createElement(s.default,{key:"FW_uploadPrompt",span:24,style:{height:60,textAlign:"center"}},this.state.uploadResult)),o.default.createElement(S.default,null,o.default.createElement(r.default,{gutter:1},c))}),this.state=(0,y.default)({},e,{loading:!1,dialogs:{},form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{},uploadedFile:null,uploadResult:null,uploadShowLabel:{},manualValues:{}})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData,l=e.uploadShowLabel;t.newData=(0,y.default)({},this.props.initData),t.oldData={},Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.getLayout().columns.filter(e=>"Upload"==e.ui).map(e=>l[e.id]=this.props.initData[e.id]),this.setState({fwParam:this.state.fwParam,formData:a,refData:{},uploadShowLabel:l},()=>{this.getLayout().columns.filter(e=>"MAP"==e.ui).map(e=>this.selectPointInMap(e.id))})}else if(this.props.showAsDialog){console.info("2",this.props.clientNewData);var i=(0,y.default)({},this.state.fwParam,{oldData:{},newData:this.props.clientNewData});this.props.getCreateData({fwCoord:this.getFwCoord(),fwParam:i,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData,i=e["_FW_DYNAMIC_LAYOUT"];delete e["_FW_DYNAMIC_LAYOUT"],i&&i.columns&&i.columns.map(e=>{var t=this.getLayout().columnMap[e.id];t&&Object.keys(e).map(a=>t[a]=e[a])}),a.newData=(0,y.default)({},e),a.oldData={},Object.keys(e).map(t=>l[t]={value:e[t]}),this.setState({fwParam:this.state.fwParam,formData:l,refData:{}})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null)}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.CustomizedForm;return o.default.createElement("div",null,o.default.createElement(g.default,{spinning:this.props.loading||this.state.loading},o.default.createElement(e,{onChange:this.handleFormChange}),this.getLayout().columns.some(e=>e.visible&&"MAP"==e.ui)?o.default.createElement(A.Map,{height:"50vh",showQueryControl:!0,onRef:e=>this.setState({map:e})}):null),Object.values(this.state.dialogs))}})||P);t.default=G},a29C:function(e,t,a){"use strict";var l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.default=o;var i=l(a("uYVn"));function o(e,t,a,l,o){if(e){var r=i.toDate(e);if(null!=r)return r.format?r.format("yyyy-MM-dd hh:mm:ss"):r}return""}},bfXB:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=f,t.logic=h,t.handleOk=p,t.handleCancel=v;var o=i(a("q1tI"));a("+L6B");var r=i(a("2/Rp"));a("miYZ");var s=i(a("tsqr"));a("2qtc");var n=i(a("kLXV")),d=i(a("MVZn"));a("Pwec");var u=i(a("CtXQ")),c=l(a("uYVn"));function f(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],console.info("layout executed",this),o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(u.default,{type:this.action.icon}),this.action.label," "))}function h(e,t,l,i,r,s){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=r;var u=(0,d.default)({},this.view.getFwCoord(),{view:"create"}),c=(0,d.default)({},this.view.state.fwParam,{openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{}}),f=null;if(this.action.argument&&this.action.argument.antdPath){var h=this.action.argument.antdPath;f=a("RO01")(`./${h}`).default}else f=a("Yn9z").default;var p=e=>{this.innerLayout||(this.innerLayout={}),this.innerLayout[t]=e;var a=this.view.state.dialogs,l=(0,d.default)({},this.view.state.clientNewDataTemplate,s);this.view.props.gridToTreeField&&(l[this.view.props.gridToTreeField]=this.view.props.selectedTreeNodeId);e.columns.filter(e=>e.visible);var i="42vw";this.toStep2=m,a[this.id]=o.default.createElement(n.default,{width:i,key:this.id,title:e.title,visible:!0,maskClosable:!1,confirmLoading:this.view.props.createLoading,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4e0b\u4e00\u6b65",onOk:e=>this.toStep2(e)},o.default.createElement(f,{selectedData:{},innerLayout:e,innerFwCoord:u,fwParam:c,clientNewData:l,showAsDialog:!0,onRef:e=>this.onRef(e)})),delete a[this.id+"2"],this.view.setState({dialogs:a})};this.innerLayout&&this.innerLayout[t]?p(this.innerLayout[t]):this.view.props.loadLayout({fwCoord:u,fwParam:c,callback:p})}function m(){var e=this.dialog.state.formData,t=this.dialog.state.fwParam.newData;Object.keys(e).map(a=>t[a]=e[a].value),t.LEVEL||t.LATEST_RETURN_SPAN||t.HAVE_VALID_TICKET||t.TO_SHOP_DISTANCE?this.dialog.props.saveCreateData({fwCoord:this.dialog.getFwCoord(),fwParam:(0,d.default)({},this.dialog.state.fwParam,{newData:t}),callback:l=>{if(l.success){this.dialog.state.fwParam.newData=(0,d.default)({},this.dialog.state.fwParam.newData,l.resultData),Object.keys(l.resultData).map(t=>e[t]={value:l.resultData[t]});var i=this.action.id,u=(0,d.default)({},this.view.getFwCoord(),{view:"create"}),f=(0,d.default)({},this.view.state.fwParam,{openerActionId:i,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{},processType:"secondStep"}),h=null;if(this.action.argument&&this.action.argument.antdPath){var m=this.action.argument.antdPath;h=a("RO01")(`./${m}`).default}else h=a("Yn9z").default;var p=e=>{this.innerLayout||(this.innerLayout={}),this.innerLayout[i+"2"]=e;var a=this.view.state.dialogs;f.newData=l.resultData,console.info("result",l.resultData);var s=(0,d.default)({},this.view.state.clientNewDataTemplate,l.resultData);this.view.props.gridToTreeField&&(s[this.view.props.gridToTreeField]=this.view.props.selectedTreeNodeId);e.columns.filter(e=>e.visible);var c="30vw",m=[];m.push(o.default.createElement(r.default,{key:"back",onClick:e=>this.handleCancel(e)},"\u53d6\u6d88")),m.push(o.default.createElement(r.default,{key:"toStep1",onClick:e=>this.logic(this.view,i,this.record,this.recordIndex,e,t)},"\u4e0a\u4e00\u6b65")),m.push(o.default.createElement(r.default,{key:"confirm",type:"primary",onClick:e=>this.handleOk(e)},"\u786e\u8ba4\u53d1\u5238")),a[this.id+"2"]=o.default.createElement(n.default,{width:c,key:this.id,title:e.title,visible:!0,maskClosable:!1,confirmLoading:this.view.props.createLoading,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4e0b\u4e00\u6b65",onOk:e=>this.toStep2(e),footer:m},o.default.createElement(h,{selectedData:{},innerLayout:e,innerFwCoord:u,fwParam:f,clientNewData:s,showAsDialog:!0,onRef:e=>this.onRef(e)})),delete a[this.id],this.dialog.setState({innerLayout:null}),this.view.setState({dialogs:a})};this.innerLayout&&this.innerLayout[i+"2"]?p(this.innerLayout[i+"2"]):this.view.props.loadLayout({fwCoord:u,fwParam:f,callback:p})}else{if(l.validResultMap){var v={};Object.keys(l.validResultMap).map(e=>{v[e]={value:values[e],errors:[new Error(l.validResultMap[e])]}}),form.setFields(v)}c.isEmpty(l.errorMsg)||s.default.error(l.errorMsg,10)}}}):s.default.error("\u8bf7\u52fe\u9009\u7b5b\u9009\u6761\u4ef6")}function p(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("create error",a);else{var i=this.dialog.state.formData,o=this.dialog.state.fwParam.newData;Object.keys(i).map(e=>o[e]=i[e].value);var r=(0,d.default)({},this.dialog.state.fwParam,{newData:o,processType:"secondStep"});this.dialog.props.saveCreateData({fwCoord:this.dialog.getFwCoord(),fwParam:r,callback:a=>{if(a.success)c.isEmpty(a.errorMsg)?s.default.success("\u53d1\u5238\u6210\u529f"):s.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}c.isEmpty(a.errorMsg)||s.default.error(a.errorMsg,10)}}})}})}function v(e){var t=this.view.state.dialogs;delete t[this.id],delete t[this.id+"2"],this.view.setState({dialogs:t})}},"c+ja":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=c,t.logic=f,t.handleOk=m,t.handleCancel=p;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr")),s=i(a("MVZn"));a("Pwec");var n=i(a("CtXQ")),d=l(a("uYVn")),u=a("QCDS");function c(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(n.default,{type:this.action.icon}),this.action.label," "))}function f(e,t,a,l,i){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,null==a&&this.view.state.selectedRowKeys&&this.view.state.selectedRowKeys.length>0){var o=this.view.state.selectedRowKeys[0];this.record=this.view.state.data[o],this.recordIndex=o}var r=(0,s.default)({},this.view.getFwCoord()),n=(0,s.default)({},this.view.state.fwParam,{openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,selectedData:this.record?this.record:null,oldData:{},newData:{DATA_RANGE:0,FILE_TYPE:"pdf"},selectedTreeNodeId:this.view.props.selectedTreeNodeId?this.view.props.selectedTreeNodeId:null,treeConnectColumn:this.view.props.gridToTreeField?this.view.props.gridToTreeField:null}),d=h({fwCoord:r,fwParam:n},null,null);d.su=(0,u.getSimulateUserId)(location.search);var c=document.createElement("form");c.style.display="display:none;",c.method="post",c.action="/fw/export",c.target="_blank",Object.keys(d).map(e=>{var t=document.createElement("input");t.type="hidden",t.name=e,t.value=d[e],c.appendChild(t)}),document.body.appendChild(c),c.submit(),document.body.removeChild(c)}function h(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>objectToFormArr(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]).replace(/%/g,"%25").replace(/\&/g,"%26").replace(/\+/g,"%2B").replace(/\=/g,"%3D"):h(e[o],i,l)}return i}function m(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{var i=(0,s.default)({},this.dialog.state.fwParam);this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:i,callback:a=>{if(a.success)d.isEmpty(a.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}d.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}})}})}function p(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},dMwA:function(e,t){e.exports="data:;base64,PCFkb2N0eXBlIGh0bWw+DQo8aHRtbD4NCjxoZWFkPg0KICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0iaW5pdGlhbC1zY2FsZT0xLjAsIG1heGltdW0tc2NhbGU9MS4wLCB1c2VyLXNjYWxhYmxlPW5vIj4NCiAgPG1ldGEgbmFtZT0iZm9ybWF0LWRldGVjdGlvbiIgY29udGVudD0idGVsZXBob25lPXllcyIvPg0KICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCIgLz4NCiAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwOi8vYXBpLm1hcC5iYWlkdS5jb20vbGlicmFyeS9EcmF3aW5nTWFuYWdlci8xLjQvc3JjL0RyYXdpbmdNYW5hZ2VyX21pbi5jc3MiIC8+DQogIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Imh0dHA6Ly9hcGkubWFwLmJhaWR1LmNvbS9hcGk/dj0zLjAmYWs9dTJ2WjlmVDdsSXpiZ0drQlRsRlF1NFk2Ij48L3NjcmlwdD4NCiAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iaHR0cDovL2FwaS5tYXAuYmFpZHUuY29tL2xpYnJhcnkvRHJhd2luZ01hbmFnZXIvMS40L3NyYy9EcmF3aW5nTWFuYWdlcl9taW4uanMiPjwvc2NyaXB0Pg0KICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJodHRwOi8vYXBpLm1hcC5iYWlkdS5jb20vbGlicmFyeS9UZXh0SWNvbk92ZXJsYXkvMS4yL3NyYy9UZXh0SWNvbk92ZXJsYXlfbWluLmpzIj48L3NjcmlwdD4NCgk8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJodHRwOi8vYXBpLm1hcC5iYWlkdS5jb20vbGlicmFyeS9NYXJrZXJDbHVzdGVyZXIvMS4yL3NyYy9NYXJrZXJDbHVzdGVyZXJfbWluLmpzIj48L3NjcmlwdD4NCiAgPHN0eWxlPg0KICAgIGh0bWwsYm9keSB7DQogICAgICAgIG1hcmdpbjogMDsNCiAgICAgICAgcGFkZGluZzogMDsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIGhlaWdodDogMTAwJTsNCiAgICB9Lyrov5nph4zmmK/lhbPplK4qLw0KICAgIGRpdiAuYW50LXRhYnMtY29udGVudCB7DQogICAgICBoZWlnaHQ6MTAwJTsNCiAgICB9DQogICAgZGl2IC5hbnQtdGFicy10YWIgew0KICAgICAgaGVpZ2h0OjEwMCU7DQogICAgfQ0KICAgIGRpdiAuYW50LXRhYnMtdGFicGFuZSB7DQogICAgICBoZWlnaHQ6MTAwJTsNCiAgICB9DQogICAgZGl2IC5hbnQtc3Bpbi1uZXN0ZWQtbG9hZGluZyB7DQogICAgICBoZWlnaHQ6IDEwMCU7DQogICAgfQ0KICAgIGRpdiAuYW50LXNwaW4tY29udGFpbmVyIHsNCiAgICAgIGhlaWdodDogMTAwJTsNCiAgICB9DQogIDwvc3R5bGU+DQogIDx0aXRsZT5Mb2FkaW5nLi4uPC90aXRsZT4NCjwvaGVhZD4NCjxib2R5Pg0KICA8ZGl2IGlkPSJyb290IiBzdHlsZT0iaGVpZ2h0OiAxMDAlOyI+PC9kaXY+DQo8L2JvZHk+DQoNCjwvaHRtbD4="},dNXO:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.getActionEntry=w,t.buildGridQueryArea=y,t.buildGroupMenus=C,t.buildGridMenus=D,t.buildDetailMenus=E;var o=i(a("q1tI"));a("qVdP");var r=i(a("jsC+"));a("lUTK");var s=i(a("BvKs"));a("+L6B");var n=i(a("2/Rp"));a("5NDa");var d=i(a("5rEg")),u=i(a("MVZn"));a("P2fV");var c=i(a("NJEC"));a("Pwec");var f=i(a("CtXQ"));a("OaEy");var h=i(a("2fM7"));a("iQDF");var m=i(a("+eQT")),p=l(a("uYVn")),v=m.default.RangePicker,g=h.default.Option;function w(e,t){if(e.actionEntry||(e.actionEntry={_default:{id:"_default",layout:function(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement(c.default,{key:this.action.fw_index,title:this.action.label+" "+this.action.id+" \u5f85\u5b9e\u73b0",onConfirm:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(f.default,{type:this.action.icon}),this.action.label," "))},logic:function(e,t,a,l,i){alert(t)},isValid:function(e,t,a){return!0}}}),e.actionEntry[t]);else try{var l=e.getLayout().clientLogicMap[t];l||console.warn("Can't find clientLogic ",t);var i=a("WSuX")(`./${l.file}`);if(i){var r={id:t,onRef:function(e){this.dialog=e},isValid:function(e,t,a){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.action.argument){var l=this.action.argument,i=l.showByColumn,o=l.showValue,r=l.showByEmpty;l.setValue,l.showInColumn;if(i){var s=a[i];return!!String(o).split(",").some(e=>e==s)||!(null!=s&&void 0!=s&&""!==s||!r)}return!0}return!0}};e.actionEntry[t]=r,i.logic&&(r.logic=i.logic),i.layout?r.layout=i.layout:r.layout=e.actionEntry["_default"].logic,i.handleOk&&(r.handleOk=i.handleOk),i.handleCancel&&(r.handleCancel=i.handleCancel),i.isValid&&(r.isValid=i.isValid)}else console.warn("logic file is null",t),e.actionEntry[t]=e.actionEntry["_default"]}catch(a){console.warn("Load client logic file error",t,a),e.actionEntry[t]=e.actionEntry["_default"]}return(0,u.default)({},e.actionEntry[t])}function y(e){if(!e.getLayout())return console.info("can not find layout",e),null;var t=[],a={};if(e.getLayout().argument&&e.getLayout().argument.queryColumns){var l=new String(e.getLayout().argument.queryColumns).split(";").filter(e=>e&&""!=e);l&&(l.map(l=>{var i=l.split(",").filter(e=>e&&""!=e),r="",s=null;if(i.length>1)s=o.default.createElement(d.default,{key:l,placeholder:"\u8bf7\u8f93\u5165",value:e.state.queryColumnValues[l],style:{width:100},onChange:t=>e.handleQueryInputChange(l,t)}),r=i.filter(t=>e.getLayout().columnMap[t]&&e.getLayout().columnMap[t].toUser&&!p.isEmpty(e.getLayout().columnMap[t].label)).map(t=>e.getLayout().columnMap[t].label).join("/");else{var n=e.getLayout().columnMap[i[0]];if(n&&n.toUser)if(r=n.label,"DATE"==n.type||"DATETIME"==n.type)100,s=o.default.createElement(v,{style:{width:200},onChange:(t,a)=>e.handleQueryDateRangeChange(l,t,a)});else if(n.dictionary&&e.getLayout().dictMap[n.dictionary]){var u=e.getLayout().dictMap[n.dictionary],c={};Object.keys(u).map(e=>c[u[e]]?c[u[e]].push(e):c[u[e]]=[e]),s=o.default.createElement(h.default,{allowClear:!0,placeholder:"\u8bf7\u9009\u62e9",defaultValue:n.multiSelect?[""]:"",mode:n.multiSelect?"multiple":null,style:{width:120},onChange:(t,a)=>e.handleQuerySelectChange(l,t)},o.default.createElement(g,{key:"_FW_ALL",value:""},"\u5168\u90e8"),Object.keys(c).map(e=>o.default.createElement(g,{key:e,value:c[e].join(",")},e)))}else s=o.default.createElement(d.default,{key:l,placeholder:"\u8bf7\u8f93\u5165",value:e.state.queryColumnValues[l],style:{width:150},onChange:t=>e.handleQueryInputChange(l,t)})}r.length,s&&(a[r]=s,t.push(o.default.createElement("span",null,r," : ",s)),t.push(o.default.createElement("span",null,"\xa0\xa0")))}),t.length>0&&t.push(o.default.createElement("span",null,o.default.createElement(n.default,{type:"primary",onClick:t=>e.refresh()},"\u641c\u7d22"))))}return t}function C(e,t,a){if(!e.getLayout())return console.info("can not find layout",e),null;var l=e.getLayout().otherActions[a];return l?l.map(a=>{var l=[];if("searchGrp"!==a.id&&"gridSearchGrp"!==a.id&&"searchList"!==a.id||l.push(o.default.createElement(d.default,{key:a.id,style:{width:"150px"},size:e.state.buttonSize,className:t.queryValue,defaultValue:e.state.fwParam.queryValue,onPressEnter:t=>e.handleAction(t,"searchList"),onChange:t=>e.setState({fwParam:(0,u.default)({},e.state.fwParam,{queryValue:t.target.value})})})),"group"==a.tag){var i=a.children.filter(e=>e.visible);if(i.length>1){var c=o.default.createElement(s.default,{onClick:t=>e.handleAction(t)},i.filter((e,t)=>!a.showDefault||t>0).map(e=>o.default.createElement(s.default.Item,{key:e.id},o.default.createElement(f.default,{type:e.icon}),e.label)));return a.showDefault?o.default.createElement("span",{key:a.id,style:{marginLeft:10}},l,o.default.createElement(r.default.Button,{key:a.id,size:e.state.buttonSize,onClick:t=>e.handleAction(t,a.children[0].id),overlay:c},o.default.createElement(f.default,{type:a.children[0].icon}),a.children[0].label)):o.default.createElement("span",{key:a.id,style:{marginLeft:10}},l,o.default.createElement(r.default,{overlay:c},o.default.createElement(n.default,{size:e.state.buttonSize},o.default.createElement(f.default,{type:a.icon}),a.label," ",o.default.createElement(f.default,{type:"down"}))))}if(1==i.length)return o.default.createElement("span",{key:i[0].id,style:{marginLeft:10}},l,o.default.createElement(n.default,{key:i[0].id,size:e.state.buttonSize,onClick:t=>e.handleAction(t,i[0].id)},o.default.createElement(f.default,{type:i[0].icon}),i[0].label))}else if(a.visible)return o.default.createElement("span",{key:a.id,style:{marginLeft:10}},l,o.default.createElement(n.default,{key:a.id,size:e.state.buttonSize,onClick:t=>e.handleAction(t,a.id)},o.default.createElement(f.default,{type:a.icon}),a.label))}):null}function D(e,t,a){return e.getLayout()?e.getLayout().displayActions.map(l=>{var i=[];if("searchGrp"===l.id||"gridSearchGrp"===l.id||"searchList"===l.id){if(a)return null;i.push(o.default.createElement(d.default,{key:l.id,style:{width:"150px"},size:e.state.buttonSize,className:t.queryValue,defaultValue:e.state.fwParam.queryValue,onPressEnter:t=>e.handleAction(t,"searchList"),onChange:t=>e.setState({fwParam:(0,u.default)({},e.state.fwParam,{queryValue:t.target.value})})}))}if("group"==l.tag){var c=l.children.filter(e=>e.visible);if(c.length>1){var h=o.default.createElement(s.default,{onClick:t=>e.handleAction(t)},c.filter((e,t)=>!l.showDefault||t>0).map(e=>o.default.createElement(s.default.Item,{key:e.id},o.default.createElement(f.default,{type:e.icon}),e.label)));return l.showDefault?o.default.createElement("span",{key:l.id,style:{marginLeft:10}},i,o.default.createElement(r.default.Button,{key:l.id,size:e.state.buttonSize,onClick:t=>e.handleAction(t,l.children[0].id),overlay:h},o.default.createElement(f.default,{type:l.children[0].icon}),l.children[0].label)):o.default.createElement("span",{key:l.id,style:{marginLeft:10}},i,o.default.createElement(r.default,{overlay:h},o.default.createElement(n.default,{size:e.state.buttonSize},o.default.createElement(f.default,{type:l.icon}),l.label," ",o.default.createElement(f.default,{type:"down"}))))}if(1==c.length){var m=null;return m=a?o.default.createElement("span",{key:c[0].id,style:{marginLeft:10}},i,o.default.createElement("a",{key:c[0].id,size:e.state.buttonSize,onClick:t=>e.handleAction(t,c[0].id)},o.default.createElement(f.default,{type:c[0].icon}),c[0].label)):o.default.createElement("span",{key:c[0].id,style:{marginLeft:10}},i,o.default.createElement(n.default,{key:c[0].id,size:e.state.buttonSize,onClick:t=>e.handleAction(t,c[0].id)},o.default.createElement(f.default,{type:c[0].icon}),c[0].label)),m}}else if(l.visible){if(l.ui){var p=w(e,l.click);return p.layout(e,l.id,null,-1)}var v=null;return v=a?o.default.createElement("span",{key:l.id,style:{marginLeft:10}},i,o.default.createElement("a",{key:l.id,size:e.state.buttonSize,onClick:t=>e.handleAction(t,l.id)},o.default.createElement(f.default,{type:l.icon}),l.label)):o.default.createElement("span",{key:l.id,style:{marginLeft:10}},i,o.default.createElement(n.default,{key:l.id,size:e.state.buttonSize,onClick:t=>e.handleAction(t,l.id)},o.default.createElement(f.default,{type:l.icon}),l.label)),v}}):(console.info("can not find layout",e),null)}function E(e){if(!e.getLayout())return console.info("can not find layout",e),null;var t=e.getLayout().actions.filter(e=>!0).map((t,a)=>{var l=[];if("searchGrp"!==t.id&&"gridSearchGrp"!==t.id&&"searchList"!==t.id||l.push(o.default.createElement(d.default,{key:t.id,className:styles.queryValue,defaultValue:e.state.fwParam.queryValue,onChange:t=>e.setState({fwParam:(0,u.default)({},e.state.fwParam,{queryValue:t.target.value})})})),"group"==t.tag){var i=t.children.filter(e=>e.visible);if(i.length>1){var c=o.default.createElement(s.default,{onClick:t=>e.handleAction(t)},i.filter((e,a)=>!t.showDefault||a>0).map(e=>o.default.createElement(s.default.Item,{key:e.id},o.default.createElement(f.default,{type:e.icon}),e.label)));return t.showDefault?o.default.createElement("span",{key:t.id},l,o.default.createElement(r.default.Button,{key:t.id,onClick:a=>e.handleAction(a,t.children[0].id),overlay:c},t.children[0].icon?o.default.createElement(f.default,{type:t.children[0].icon}):null,t.children[0].label)):o.default.createElement("span",{key:t.id},l,o.default.createElement(r.default,{overlay:c},o.default.createElement(n.default,{style:{marginLeft:8}},t.icon?o.default.createElement(f.default,{type:t.icon}):null,t.label," ",o.default.createElement(f.default,{type:"down"}))))}if(1==i.length)return o.default.createElement("span",{key:i[0].id},l,o.default.createElement(n.default,{type:0==a?"primary":"default",key:i[0].id,style:{marginLeft:8},onClick:t=>e.handleAction(t,i[0].id)},i[0].icon?o.default.createElement(f.default,{type:i[0].icon}):null,i[0].label))}else if(t.visible)return o.default.createElement("span",{key:t.id},l,o.default.createElement(n.default,{type:0==a?"primary":"default",key:t.id,style:{marginLeft:8,marginRight:20},onClick:a=>e.handleAction(a,t.id)},t.icon?o.default.createElement(f.default,{type:t.icon}):null,t.label))});return t.reverse()}},"dc/6":function(e,t,a){"use strict";var l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.logic=i;l(a("uYVn"));function i(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,this.view.getTreeData({})}},"e/J2":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("DjyN");var r=i(a("NUBc"));a("g9YV");var s=i(a("wCAj"));a("jCWc");var n=i(a("kPKH"));a("14J3");var d=i(a("BMrR"));a("/zsF");var u=i(a("PArb")),c=i(a("MVZn"));a("B9cy");var f,h,m=i(a("Ol7k")),p=a("MuoO"),v=(i(a("usdK")),l(a("dNXO"))),g=l(a("uYVn")),w=i(a("wVw7"));m.default.Header,m.default.Footer,m.default.Sider,m.default.Content;function y(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout,o=e.grid,r=o.data,s=o.fwPage;return{loading:e.loading.models.grid||e.loading.models.fw,editLoading:e.loading.models.edit,dispatch:a,fwCoord:l,layout:i,fwPage:s,data:r}}var C=e=>{return{getCreateData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"create/getCreateData",payload:{fwCoord:a,fwParam:l,callback:i}})},getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},getSelectData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getSelectData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},saveSelectData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/saveSelectData",payload:{fwCoord:a,fwParam:l,callback:i}})},validDeleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/validDeleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},deleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/deleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},getGridData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.otherParams,r=t.callback;e({type:"grid/getGridData",payload:{fwPage:a,fwParam:l,fwCoord:i,otherParams:o,callback:r}})},loadLayout:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,fwParam:l,callback:i}})}}},D=(f=(0,p.connect)(y,C),f(h=class extends o.Component{constructor(e){super(e),this.getSelectData=(e=>{var t=e.fwPage,a=e.fwParam,l=e.fwCoord,i=e.selectedData,o=this.getLayout(),r=o.columnMap,s=this.state.queryColumnValues,n=Object.keys(s).map(e=>{if(s[e]){var t=r[e];if(t){if(t.dictionary)return{field:t.id,operator:"=",value1:s[e]};if("DATE"==t.type||"DATETIME"==t.type)return s[e][0]&&s[e][1]?{field:t.id,operator:"BETWEEN",value1:s[e][0],value2:s[e][1]}:void 0}return{field:e,operator:"LIKE",value1:s[e]}}}).filter(e=>e),d=(0,c.default)({},this.state.fwParam,{conditions:n,openerSelectedData:(0,c.default)({},this.props.openerSelectedData,i)},a);i&&(this.state.fwParam.openerSelectedData=i,this.setState({fwParam:this.state.fwParam})),this.props.getSelectData({fwPage:(0,c.default)({},this.state.fwPage,t),fwParam:d,fwCoord:(0,c.default)({},this.getFwCoord(),l),callback:e=>{this.setState({fwPage:e.page?e.page:{},data:e.data})}})}),this.getGridData=(e=>{var t=e.fwPage,a=e.fwParam,l=e.fwCoord,i=e.otherParams;console.info("getGridData",JSON.stringify(this.state.otherParams));var o=this.getLayout(),r=o.columnMap,s=this.state.queryColumnValues,n=Object.keys(s).map(e=>{if(s[e]){var t=r[e];if(t){if(t.dictionary)return{field:t.id,operator:"=",value1:s[e]};if("DATE"==t.type||"DATETIME"==t.type)return s[e][0]&&s[e][1]?{field:t.id,operator:"BETWEEN",value1:s[e][0],value2:s[e][1]}:void 0}return{field:e,operator:"LIKE",value1:s[e]}}}).filter(e=>e),d=(0,c.default)({},this.state.fwParam,{conditions:n,selectedTreeNodeId:this.props.selectedTreeNodeId?this.props.selectedTreeNodeId:null,treeConnectColumn:this.props.gridToTreeField?this.props.gridToTreeField:null},a);this.props.getGridData({otherParams:(0,c.default)({},this.state.otherParams,i),fwPage:(0,c.default)({},this.state.fwPage,t),fwParam:d,fwCoord:(0,c.default)({},this.getFwCoord(),l),callback:e=>{this.setState({fwPage:e.page,data:e.data,gridResult:e})}})}),this.pageChangeHandler=function(e,t){this.getGridData({fwPage:{pageNumber:e,pageSize:t}})},this.OP_COL={title:"Operation",dataIndex:"_FW_ACTIONS",render:(e,t,a)=>o.default.createElement("span",{key:a,className:w.default.operation},(this.getLayout().otherActions["inList"]?this.getLayout().otherActions["inList"]:[]).filter(e=>1==e.visible).map((e,l)=>{e.fw_index=l;var i=v.getActionEntry(this,e.click);return!i.isValid||i.isValid(this,e.id,t)?o.default.createElement("span",{key:l},l>0?o.default.createElement(u.default,{type:"vertical"}):null,v.getActionEntry(this,e.click).layout(this,e.id,t,a)):null}))},this.handleQueryInputChange=((e,t)=>{var a=t.target.value;console.info("input",e,a),void 0!=a&&null!=a&&(a=a.trim(!0));var l=this.getLayout(),i=l.columnMap,o=i[e];if(!o){var r=e.split(",");r&&r.length>0&&(o=i[r[0]])}o&&o.size&&(a=a.substr(0,o.size));var s=this.state.queryColumnValues;s[e]=a,this.setState({queryColumnValues:s})}),this.handleQuerySelectChange=((e,t,a)=>{console.info("select",e,t,a);var l=this.state.queryColumnValues;l[e]=void 0==t?null:Array.isArray(t)?t.join(","):t,this.setState({queryColumnValues:l})}),this.handleQueryDateRangeChange=((e,t,a)=>{console.info("date",e,t,a);var l=this.state.queryColumnValues;l[e]=a,this.setState({queryColumnValues:l})}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,c.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.onComponentRef=((e,t)=>{this.state.components[e]=t}),this.getComponent=(e=>{return this.state.components[e]}),this.getActionEntry=(e=>{return v.getActionEntry(this,e)}),this.handleAction=function(e,t,a){var l=null,i=null;t?(l=t,i=e):(l=e.key,i=e.domEvent),v.getActionEntry(this,this.getLayout().actionArgs[l].click).logic(this,l,a,-1,i)},this.state=(0,c.default)({},e,{gridResult:{},fwParam:(0,c.default)({},e.fwParam),otherParams:{},buttonSize:e.buttonSize?e.buttonSize:"default",tableSize:e.tableSize?e.tableSize:"middle",showSelectCol:!!e.showSelectCol&&e.showSelectCol,selectedRecord:{},selectedRowKeys:[],queryPanelExpanded:!1,dialogs:{},components:{},actionInList:[],queryColumnValues:{}})}componentWillReceiveProps(e){if(e.innerLayout||e.innerFwCoord||e.selectedTreeNodeId||e.otherParams){if(e.innerLayout!=this.props.innerLayout||e.innerFwCoord!=this.props.innerFwCoord){console.info("grid receive props2",e);var t=e.innerLayout?e.innerLayout:this.getLayout();this.state.innerLayout=t,this.state.innerFwCoord=e.innerFwCoord,t.onQuery&&v.getActionEntry(this,t.onQuery).logic(this,t.onQuery,null,-1,null)}if(e.selectedTreeNodeId!=this.props.selectedTreeNodeId){var a=this.state.fwParam;console.info("selectedTreeNodeId",e.selectedTreeNodeId),a.selectedTreeNodeId=e.selectedTreeNodeId,this.setState({fwParam:a}),this.getGridData({fwParam:{selectedTreeNodeId:e.selectedTreeNodeId}})}e.otherParams!=this.props.otherParams&&(console.info("nextOtherParams",e.otherParams),this.setState({otherParams:e.otherParams}),this.getGridData({otherParams:e.otherParams}))}}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){this.getLayout().onQuery&&v.getActionEntry(this,this.getLayout().onQuery).logic(this,this.getLayout().onQuery,null,-1,null)}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=v.buildGridQueryArea(this),t=v.buildGridMenus(this,w.default,e&&e.length>0),l=e&&e.length>0?o.default.createElement(d.default,{style:{whiteSpace:"nowrap",height:50,padding:10,backgroundColor:"#ffffff"}},e):null,i=this.state.gridResult.headerData?this.state.gridResult.headerData.map((e,t)=>{return o.default.createElement("span",{key:e.TITLE,style:{fontWeight:400}},t>0?o.default.createElement(u.default,{type:"vertical"}):null,e.TITLE,": ",o.default.createElement("span",{style:{color:"rgb(51, 153, 0)",fontWeight:700}},e.VALUE," ",e.TAIL))}):null;return o.default.createElement("div",{style:{height:"100%"}},o.default.createElement("div",{style:{height:50+(e&&e.length>0?50:0)}},l,o.default.createElement("div",{style:{marginTop:10,padding:10,backgroundColor:"#ffffff"}},t)),o.default.createElement("div",{className:"search-result-list",style:(0,c.default)({width:"100%",overflow:"auto",backgroundColor:"#ffffff"},g.getFillHeight(60+(e&&e.length>0?40:0)))},i&&i.length>0?o.default.createElement(d.default,{style:{padding:10,backgroundColor:"#ffffff",height:40}},o.default.createElement(n.default,{span:24,style:{textAlign:"left"}},i)):null,o.default.createElement(s.default,{loading:this.props.loading,columns:this.getLayout().columns.filter(e=>e.visible).map(e=>{return"_FW_ACTIONS"==e.id?(this.OP_COL.title=e.label,this.OP_COL):(e.title=e.label,e.dataIndex=e.id,e.onFormat?e.render=((t,l,i)=>a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(t,l,i,e,this)):e.dictionary?e.render=((t,a,l)=>{var i=[],o=[];null!=t&&(o=String(t).split(",")),o.map((t,a)=>{var l=null;null!=t&&(l=this.getLayout().dictMap[e.dictionary][t]),void 0!=l&&null!=l||(l=t),null!=l&&i.push(l)});var r=i.length>0?i.join(","):t;return r}):e.showColumn?e.render=((t,a,l)=>e.showColumn.split(",").map(e=>a[e]).join(" ")):"NUM"==e.type&&(e.align="right",e.render=((e,t,a)=>g.number_format(e))),e)}),dataSource:this.state.data,pagination:!1,rowKey:"fw_index",size:this.state.tableSize,bordered:!0,rowSelection:this.state.showSelectCol?{type:this.state.showSelectCol,selectedRowKeys:this.state.data.filter(e=>e.selected||void 0==e.selected&&e.FW_SELECTED).map(e=>e.fw_index),onSelect:(e,t,a,l)=>{e.selected=t,this.setState({data:this.state.data})},onSelectAll:(e,t,a)=>{this.state.data.map(t=>t.selected=e),this.setState({data:this.state.data})}}:null}),o.default.createElement(r.default,{className:"ant-table-pagination",style:{margin:5},size:"small",showTotal:(e,t)=>`\u5171\u8ba1 ${e} \u6761\u8bb0\u5f55`,showSizeChanger:!0,total:this.state.fwPage.totalRow,current:this.state.fwPage.pageNumber,pageSize:this.state.fwPage.pageSize,onChange:(e,t)=>this.pageChangeHandler(e,t),onShowSizeChange:(e,t)=>this.pageChangeHandler(e,t)})),Object.values(this.state.dialogs))}})||h);t.default=D},eCda:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=f,t.logic=h,t.handleOk=m,t.handleCancel=p;var o=i(a("q1tI"));a("2qtc");var r=i(a("kLXV"));a("+L6B");var s=i(a("2/Rp")),n=i(a("MVZn"));a("miYZ");var d=i(a("tsqr"));a("Pwec");var u=i(a("CtXQ")),c=l(a("uYVn"));function f(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],console.info("layout executed",this),o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(u.default,{type:this.action.icon}),this.action.label," "))}function h(e,t,l,i,u){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=u,null==l&&this.view.state.selectedRowKeys&&this.view.state.selectedRowKeys.length>0){var c=this.view.state.selectedRowKeys[0];this.record=this.view.state.data[c],this.recordIndex=c}if(this.record||null!=this.action.argument&&void 0!=this.action.argument.needSelectData&&null!=this.action.argument.needSelectData&&"1"!=this.action.argument.needSelectData){var f=(0,n.default)({},this.view.getFwCoord(),{view:"detail"});this.action.argument&&(this.action.argument.function&&(f["function"]=this.action.argument.function),this.action.argument.view&&(f["view"]=this.action.argument.view));var h={openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,oldData:{},newData:{}},m=null;if(console.info("this.action",this.action),this.action.argument&&this.action.argument.antdPath){var p=this.action.argument.antdPath;m=a("RO01")(`./${p}`).default}else m=a("i307").default;var v=e=>{this.innerLayout=e,this.view.props.getEditData({fwCoord:f,fwParam:(0,n.default)({},h,{selectedData:this.record}),callback:a=>{if(a){var l=this.view.state.dialogs,i=e.columns.filter(e=>e.visible),u=i.length<5?"25vw":"42vw",c=[],p=this.action.argument.INFOCONTENT,v=(0,n.default)({},this.record);v.ADDRESS&&(v.ADDRESS=v.ADDRESS.split(";")[0].split("\u3001").join("")),Object.keys(v).map(e=>{p=p.split("{"+e+"}").join(v[e])});var g=[{id:t,name:this.action.argument.NAME,lat:v[this.action.argument.LAT],lng:v[this.action.argument.LNG],icon:null,infoContent:p,buttonOpts:null}];c.push(o.default.createElement(s.default,{key:"back",onClick:e=>this.handleCancel(e)},"\u5173\u95ed")),this.action.argument&&this.action.argument.showActions&&this.action.argument.showActions.split(",").map(e=>{var t=this.view.getLayout().actionArgs[e];this.view.getActionEntry(t.click).isValid(this.view,e,a)&&c.push(o.default.createElement(s.default,{key:e,onClick:t=>this.view.handleAction((0,n.default)({},t,{fwSourceAction:this}),e,this.record)},t.label))}),l[this.id]=o.default.createElement(r.default,{width:u,key:this.id,title:e.title,visible:!0,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4fdd\u5b58",onOk:e=>this.handleOk(e),footer:c},o.default.createElement(m,{selectedData:this.record,innerLayout:e,innerFwCoord:f,fwParam:h,showAsDialog:!0,dataManaged:!0,initData:a,points:g,onRef:e=>this.onRef(e)})),this.view.setState({dialogs:l})}else d.default.error("\u52a0\u8f7d\u6570\u636e\u9519\u8bef",10)}})};this.innerLayout?v(this.innerLayout):this.view.props.loadLayout({fwCoord:f,fwParam:h,callback:v})}else d.default.error("\u8bf7\u9009\u62e9\u8981\u67e5\u770b\u7684\u6570\u636e",5)}function m(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{var i=this.dialog.state.formData,o=this.dialog.state.fwParam.newData;Object.keys(i).map(e=>o[e]=i[e].value);var r=(0,n.default)({},this.dialog.state.fwParam,{newData:o});this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:r,callback:a=>{if(a.success)c.isEmpty(a.errorMsg)?d.default.success("\u4fdd\u5b58\u6210\u529f"):d.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}c.isEmpty(a.errorMsg)||d.default.error(a.errorMsg,10)}}})}})}function p(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},fc8R:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=c,t.logic=f,t.handleOk=m,t.handleCancel=p;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr")),s=i(a("MVZn"));a("Pwec");var n=i(a("CtXQ")),d=l(a("uYVn")),u=a("QCDS");function c(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(n.default,{type:this.action.icon}),this.action.label," "))}function f(e,t,a,l,i){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,null==a&&this.view.state.selectedRowKeys&&this.view.state.selectedRowKeys.length>0){var o=this.view.state.selectedRowKeys[0];this.record=this.view.state.data[o],this.recordIndex=o}var r=this.view.getLayout(),n=r.columnMap,d=this.view.state.queryColumnValues,c=Object.keys(d).map(e=>{if(d[e]){var t=n[e];if(t){if(t.dictionary)return{field:t.id,operator:"=",value1:d[e]};if("DATE"==t.type||"DATETIME"==t.type)return d[e][0]&&d[e][1]?{field:t.id,operator:"BETWEEN",value1:d[e][0],value2:d[e][1]}:void 0}return{field:e,operator:"LIKE",value1:d[e]}}}).filter(e=>e),f=(0,s.default)({},this.view.getFwCoord()),m=(0,s.default)({},this.view.state.fwParam,{conditions:c,openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,selectedData:this.record?this.record:null,oldData:{},newData:{DATA_RANGE:0,FILE_TYPE:"xls"},selectedTreeNodeId:this.view.props.selectedTreeNodeId?this.view.props.selectedTreeNodeId:null,treeConnectColumn:this.view.props.gridToTreeField?this.view.props.gridToTreeField:null}),p=h((0,s.default)({},this.view.state.otherParams,{fwCoord:f,fwParam:m}),null,null);p.su=(0,u.getSimulateUserId)(location.search);var v=document.createElement("form");v.style.display="display:none;",v.method="post",v.action="/fw/export",v.target="_blank",Object.keys(p).map(e=>{var t=document.createElement("input");t.type="hidden",t.name=e,t.value=p[e],v.appendChild(t)}),document.body.appendChild(v),v.submit(),document.body.removeChild(v)}function h(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>h(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]):h(e[o],i,l)}return i}function m(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{var i=(0,s.default)({},this.dialog.state.fwParam);this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:i,callback:a=>{if(a.success)d.isEmpty(a.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}d.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}})}})}function p(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},fs94:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=c,t.logic=f,t.handleOk=h,t.handleCancel=m;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr")),s=i(a("MVZn"));a("2qtc");var n=i(a("kLXV"));a("Pwec");var d=i(a("CtXQ")),u=l(a("uYVn"));function c(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(d.default,{type:this.action.icon}),this.action.label," "))}function f(e,t,l,i,r){this.view=e,this.record=l,this.recordIndex=i,this.event=r;var s={function:"members",view:"edit"},d={openerActionId:"showEditInList",openerFunction:"",openerView:"",oldData:{},newData:{}},u=null;u=a("3ICH").default;var c=e=>{this.innerLayout||(this.innerLayout={}),this.innerLayout[t]=e;var a=this.view.state.dialogs,l=e.columns.filter(e=>e.visible),i=l.length<5?"25vw":"42vw";a[this.id]=o.default.createElement(n.default,{width:i,key:this.id,title:e.title,visible:!0,maskClosable:!1,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4fdd\u5b58",onOk:e=>this.handleOk(e)},o.default.createElement(u,{selectedData:this.record,innerLayout:e,innerFwCoord:s,fwParam:d,showAsDialog:!0,onRef:e=>this.onRef(e)})),this.view.setState({dialogs:a})};this.innerLayout&&this.innerLayout[t]?c(this.innerLayout[t]):this.view.props.loadLayout({fwCoord:s,fwParam:d,callback:c})}function h(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{if(a)console.info("edit error",a);else{if(this.dialog.doOtherInputValidate){var i=this.dialog.doOtherInputValidate();if(i){if(Array.isArray(i)){var o={};Object.keys(i).map(e=>{var t=n[e];o[e]=(0,s.default)({},t,{errors:[new Error(i[e])]})}),t.setFields(o)}else r.default.error(i);return}}var n=this.dialog.state.formData,d=this.dialog.state.fwParam.newData;Object.keys(n).map(e=>d[e]=n[e].value);var c=(0,s.default)({},this.dialog.state.fwParam,{newData:d});this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:c,callback:a=>{if(a.success)u.isEmpty(a.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(a.errorMsg,10),this.view.loadMemberInfo(this.view.props),this.view.props.refreshMemberList&&this.view.props.refreshMemberList(),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}u.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}})}})}function m(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},g4V7:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("14J3");var r=i(a("BMrR"));a("jCWc");var s=i(a("kPKH"));a("DZo9");var n=i(a("8z0m"));a("miYZ");var d=i(a("tsqr"));a("giR+");var u=i(a("fyUT"));a("Xi6J");var c=i(a("kl6h"));a("iQDF");var f=i(a("+eQT"));a("O3gP");var h=i(a("lrIw"));a("6UJt");var m=i(a("DFOY"));a("nRaC");var p=i(a("5RzL"));a("T2oS");var v=i(a("W9HT")),g=i(a("pVnL")),w=i(a("MVZn"));a("sRBo");var y=i(a("kaz8"));a("7Kak");var C=i(a("9yH6"));a("OaEy");var D=i(a("2fM7"));a("5NDa");var E=i(a("5rEg"));a("y8nQ");var b=i(a("Vl3Y"));a("ozfa");var S=i(a("MJZm"));a("B9cy");var L,P,k=i(a("Ol7k")),I=a("MuoO"),R=(i(a("QCDS")),l(a("uYVn"))),T=l(a("dNXO")),A=(a("0Fy/"),i(a("wd/R")));a("XDpg"),A.default.locale("zh-cn");k.default.Header,k.default.Footer,k.default.Sider,k.default.Content;var _=S.default.TreeNode,O=b.default.Item,M=E.default.TextArea,F=D.default.Option,N=C.default.Group,j=y.default.Group,V={labelCol:{xs:{span:9},sm:{span:9}},wrapperCol:{xs:{span:15},sm:{span:15}}},x={float:"left",width:"9px",height:"27px",backgroundColor:"rgba(51, 204, 153, 1)"},z={textAlign:"left",fontSize:16,marginLeft:10,marginButtom:10},Y={textAlign:"left",fontSize:14,marginLeft:30,marginButtom:10},G={marginLeft:50,marginButtom:10};function q(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.edit,dispatch:a,fwCoord:l,layout:i}}var U=e=>{return{getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})}}},B=(L=(0,I.connect)(q,U),L(P=class extends o.Component{constructor(e){super(e),this.loadCascaderData=((e,t)=>{var a=e[e.length-1];a.loading=!0;var l=t.valueRef,i=e=>{return e?e.map(e=>{return e.value=e[l.value],e.label=e[l.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e.children&&(e.children=i(e.children)),e}):null};this.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:l.function,view:l.view}),fwParam:{distinct:l.distinct?l.distinct:null,queryColumns:l.value+","+l.label+","+(l.otherRefs?l.otherRefs:""),selectedTreeNodeId:e.map(e=>e[l.value]).join(",")},callback:e=>{a.loading=!1,a.children=i(e.data),this.setState({refData:this.state.refData})}})}),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,w.default)({},this.state.fwParam,{openerSelectedData:(0,w.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,w.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(_,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+","+(t.valueRef.otherRefs?t.valueRef.otherRefs:""),selectedTreeNodeId:e.props.eventKey},callback:e=>{i.children=e.data,a.defaultOpen=!0,console.info(a.data),l(),this.setState({refData:this.state.refData})}}))})),this.onCascaderChange=((e,t,a)=>{if(console.info("onCascaderChange",e.id,t,a),"ADDRESS_SELECT"==e.id){var l=this.state,i=l.fwParam,o=l.formData,r=l.manualValues;i.newData||(i.newData={}),i.newData[e.id]=t.join(","),o[e.id]||(o[e.id]={}),o[e.id].value=t.join(","),r[e.id]=t,this.setState({fwParam:i,manualValues:r,formData:o})}}),this.onAutoCompleteSelect=((e,t,a)=>{console.info("onAutoCompleteSelect",e.id,t,a)}),this.onSelectChange=((e,t,a)=>{console.info("onSelectChange",e.id,t,a)}),this.onSelectSelect=((e,t,a)=>{console.info("onSelectSelect",e.id,t,a)}),this.MONEY_IDS={RE_INSURANCE_DAYS:80,MAINTAIN_MILES:80,MAINTAIN_DAYS:80,SERVICE_NUMBER:150,MT_TODO_UNFOLLOW_RECYCLE:60,MT_TODO_AUTO_DISTRIBUTE_DAYS:60,INS_TODO_UNFOLLOW_RECYCLE:60,INS_TODO_AUTO_DISTRIBUTE_DAYS:60},this.getInputComponent=((e,t)=>{var a=this.state,l=a.components,i=a.refData,r=a.fwParam,s=a.formData,b=null,S={disabled:!e.editable,style:{width:this.MONEY_IDS[e.id]?this.MONEY_IDS[e.id]:90},size:this.state.InputSize};t&&(S.value=this.state.manualValues[e.id]);var L="",P="";if(e.editable&&(L=e.prompt?e.prompt:"\u8bf7\u8f93\u5165",P=e.prompt?e.prompt:"\u8bf7\u9009\u62e9"),"label"==e.ui)b=this.getDisplayValue(e);else if("MEMO"===e.type)b=o.default.createElement(M,(0,g.default)({},S,{rows:4}));else if("checkbox01"===e.ui)b=o.default.createElement(y.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictList[e.dictionary]){var k=this.getLayout().dictList[e.dictionary];if("radio"==e.ui)b=o.default.createElement(N,(0,g.default)({name:e.id},S),k.map(e=>o.default.createElement(C.default,{key:e.value,value:String(e.value)},e.label)));else if("checkbox"==e.ui){var I=k;b=o.default.createElement(j,(0,g.default)({name:e.id},S,{options:I}))}else b=o.default.createElement(D.default,S,k.map(e=>o.default.createElement(F,{key:e.value,value:e.value},e.label)))}else if("TreeSelect"===e.ui&&e.valueRef){var R=e.valueRef;if(!i[e.id]){var T=null;R.function==this.props.fwParam.openerFunction&&R.view==this.props.fwParam.openerView&&this.props.treeData&&(T=this.props.treeData),i[e.id]={loading:!1,data:T,queryIndex:0,defaultOpen:!1}}var _=i[e.id];_.data||(_.data=[],this.props.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:R.function,view:R.view}),fwParam:{distinct:R.distinct?R.distinct:null,queryColumns:R.value+","+R.label+","+(R.otherRefs?R.otherRefs:"")},callback:t=>{t.success?(_.data=t.data,console.info("result.data",_.data),_.loading=!1,i[e.id]=_,this.setState({refData:i})):_.data=null}})),b=o.default.createElement(p.default,(0,g.default)({},S,{placeholder:P,notFoundContent:_.loading?o.default.createElement(v.default,{size:"small"}):null,showArrow:!0,showSearch:!0,searchPlaceholder:"\u8f93\u5165\u641c\u7d22",filterTreeNode:(e,t)=>{return console.info("treeNode",t),t.props.title.indexOf(e)>=0},treeNodeFilterProp:"title",filterOption:!1,loadData:t=>this.onTreeSelectLoadData(t,e,_),treeExpandedKeys:_.expandedKeys?_.expandedKeys:_.data.map(e=>String(e[R.value])),onTreeExpand:e=>{_.expandedKeys=e,_.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:_.defaultOpen,onSearch1:t=>{_.timeout&&(clearTimeout(_.timeout),_.timeout=null),_.currentValue=t;var a=()=>{console.info(t),_.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:R.function,view:R.view}),fwParam:{queryStr:t,distinct:R.distinct?R.distinct:null,queryColumns:R.value+","+R.label+","+(R.otherRefs?R.otherRefs:"")},callback:a=>{_.currentValue==t&&(_.data=a.data,_.loading=!1,_.defaultOpen=!0,s[e.id].value=t,this.setState({refData:i,fwParam:r,formData:s}))}})};_.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(_.data,R))}else if("Cascader"==e.ui&&e.valueRef){var O=e.valueRef;if(!i[e.id]){var V={};V[O.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),V[O.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var x=i[e.id];x.data||(x.data=[],this.props.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:O.function,view:O.view}),fwParam:{distinct:O.distinct?O.distinct:null,queryColumns:O.value+","+O.label+","+(O.otherRefs?O.otherRefs:"")},callback:t=>{t.success?(x.data=t.data.map(e=>{return e.value=e[O.value],e.label=e[O.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e}),x.loading=!1,i[e.id]=x,this.setState({refData:i})):x.data=null}})),b=o.default.createElement(m.default,(0,g.default)({},S,{placeholder:P,options:x.data,loadData:t=>this.loadCascaderData(t,e),onChange:(t,a)=>this.onCascaderChange(e,t,a),showSearch:{filter:(e,t)=>{return t.some(t=>t.label.toLowerCase().indexOf(e.toLowerCase())>-1)}}}))}else if("AutoComplete"==e.ui&&e.valueRef){var z=e.valueRef;i[e.id]||(i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i}));var Y=i[e.id];b=o.default.createElement(h.default,(0,g.default)({},S,{placeholder:L,dataSource:Y.data,defaultOpen:Y.defaultOpen,onSelect:(t,a)=>this.onAutoCompleteSelect(e,t,a),onSearch:e=>{Y.timeout&&(clearTimeout(Y.timeout),Y.timeout=null),Y.currentValue=e;var t=()=>{Y.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:z.function,view:z.view}),fwParam:(0,w.default)({},this.state.fwParam,{queryValue:e,distinct:z.distinct?z.distinct:null,queryColumns:z.value+","+z.label+","+(z.otherRefs?z.otherRefs:"")}),callback:t=>{if(Y.currentValue==e){var a={};t.success&&t.data.map(e=>{a[e[z.label]]=e}),Y.dataMap=a,Y.data=Object.keys(a),Y.loading=!1,Y.defaultOpen=!0,Y.autoFocus=!0,this.setState({refData:i,fwParam:r})}}})};Y.timeout=setTimeout(t,900)}}))}else if(null!=e.valueRef){var G=e.valueRef;if(!i[e.id]){var q={};q[G.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),q[G.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var U=i[e.id];U.data||(U.data=[],this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:G.function,view:G.view}),fwParam:{distinct:G.distinct?G.distinct:null,queryColumns:G.value+","+G.label+","+(G.otherRefs?G.otherRefs:"")},callback:t=>{var a,l=[],o={};(t.success&&(l=t.data,l&&l.map(e=>o[e[G.value]]=e)),e.showColumn)&&function(){console.info("showColumn",s[e.showColumn],s[e.id]);var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],i=s[e.id]&&s[e.id].value?s[e.id].value.split(","):[],o=null;if(i.length>0&&t.length==i.length)for(a=0;a<i.length;++a)l.some(e=>e[G.value]==i[a])||(o={},o[G.value]=i[a],o[G.label]=t[a],l.push(o))}();U.data=l,U.dataMap=o,U.loading=!1,i[e.id]=U,this.setState({refData:i,formData:s})}}));var B=U.data.map(e=>o.default.createElement(F,{key:e[G.value]},e[G.label],G.otherRefs?G.otherRefs.split(",").map(t=>{e[t]}):""));b=o.default.createElement(D.default,(0,g.default)({},S,{placeholder:P,showSearch:!0,mode:e.multiSelect?"multiple":null,notFoundContent:U.loading?o.default.createElement(v.default,{size:"small"}):null,showArrow:!0,filterOption:!1,labelInValue:!0,autoFocus:U.autoFocus,defaultOpen:U.defaultOpen,onSelect:(t,a)=>this.onSelectSelect(e,t,a),onChange:(t,a)=>this.onSelectChange(e,t,a),onSearch:t=>{U.timeout&&(clearTimeout(U.timeout),U.timeout=null),U.currentValue=t;var a=()=>{U.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:G.function,view:G.view}),fwParam:{queryValue:t,distinct:G.distinct?G.distinct:null,queryColumns:G.value+","+G.label+","+(G.otherRefs?G.otherRefs:"")},callback:a=>{if(U.currentValue==t){var l,o=[],r={};if(a.success&&(o=a.data,o&&o.map(e=>r[e[G.value]]=e)),e.showColumn)(function(){var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],a=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],i=null;if(a.length>0&&t.length==a.length)for(l=0;l<a.length;++l)o.some(e=>e[G.value]==a[l])||(i={},i[G.value]=a[l],i[G.label]=t[l],o.push(i))})();U.data=o,U.dataMap=r,U.loading=!1,U.defaultOpen=!0,U.autoFocus=!0,this.setState({refData:i})}}})};U.timeout=setTimeout(a,500)}}),B)}else if("DatePicker"===e.ui){var K=()=>!1;"today"==e.min?K=(e=>e&&e<(0,A.default)().startOf("day")):"today"==e.max&&(K=(e=>e&&e>(0,A.default)().endOf("day"))),b=o.default.createElement(f.default,(0,g.default)({},S,{disabledDate:e=>K(e),placeholder:P}))}else if("TimePicker"===e.ui)b=o.default.createElement(c.default,S);else if("InputNumber"===e.ui)b=o.default.createElement(u.default,(0,g.default)({},S,{placeholder:L}));else if("Upload"===e.ui){var W=(0,w.default)({},this.getFwCoord(),{view:"create"}),H={openerActionId:e.id,openerFunction:this.getFwCoord()["function"],openerView:this.getFwCoord().view,oldData:{},newData:{},saveType:"checkonly"},X=this.objectToFormInputs({fwCoord:W,fwParam:H},null,null),Z={name:e.id+"_importFile",action:"/fw/importData?fwCoord.project="+this.getFwCoord().project+"&",data:X,onChange(t){if(this.view.setState({loading:!0}),t.file.status,"done"===t.file.status){var a=t.file.response;this.view.setState({uploadedFile:t.file.name,uploadResult:null,loading:!1}),a.success?(r.connectFilePath=a.connectFilePath,this.view.setState({fwParam:r}),d.default.info("\u6587\u4ef6\u6821\u9a8c\u901a\u8fc7")):a.connectFilePath?this.view.setState({uploadResult:o.default.createElement("span",{dangerouslySetInnerHTML:{__html:'<font color="#ff0000"><a href="/fw/download?fileName='+a.connectFilePath+'" target="_blank">\u4e0a\u4f20\u6587\u4ef6\u6709\u8bef\uff0c\u70b9\u6b64\u4e0b\u8f7d\u660e\u7ec6</a></font>'}})}):a.errorMsg&&d.default.error(a.errorMsg,10)}else"error"===t.file.status&&(this.view.setState({loading:!1}),d.default.error(`${e.label}\u5bfc\u5165\u9519\u8bef`,10))}};Z.view=this,b=o.default.createElement(n.default,(0,g.default)({},S,Z,{showUploadList:!1,style:{marginLeft:10}}),o.default.createElement("a",{href:"javascript:;"},this.state.uploadedFile?this.state.uploadedFile:"\u70b9\u6b64\u4e0a\u4f20"))}else"MAP"==e.ui?(console.info("col.ui",e.ui),b=o.default.createElement(E.default,(0,g.default)({},S,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn;return b||(b=o.default.createElement(E.default,(0,g.default)({},S,{type:e.ui?e.ui:"text",placeholder:L}))),l[e.id]=b,b}),this.normFile=(e=>{return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.file&&e.file.response?e.file.response.success?e&&e.fileList:null:e&&e.fileList}),this.objectToFormInputs=function(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>this.objectToFormInputs(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]).replace(/%/g,"%25").replace(/\&/g,"%26").replace(/\+/g,"%2B").replace(/\=/g,"%3D"):this.objectToFormInputs(e[o],i,l)}return i},this.selectPointInMap=(e=>{var t=this.state.formData,a=this.getLayout().columnMap[e],l=a.showColumn.split(",");console.info("param",l,t),this.state.map.selectPoint({id:e,lat:t[l[0]].value,lng:t[l[1]].value,name:a.label,callback:(e,a,i,o,r)=>{console.info("callback",r,r.onlineStr),t[e].value=r.onlineStr,t[l[0]].value=a,t[l[1]].value=i,console.info("newParam",a,i,t),this.setState({formData:t})}})}),this.handleFormChange=(e=>{if(e){var t=this.state,a=t.fwParam;t.formData;a.newData||(a.newData={}),Object.keys(e).map(t=>{var a=e[t],l=this.getLayout().columnMap[t],i=l.ui,o=null;if(a&&null!=a.value)if(this.state.formData[t]||(this.state.formData[t]={}),o=a.value,"DatePicker"===i)o=a.value.format(l.pattern?l.pattern:"YYYY-MM-DD");else if("TimePicker"===i)o=a.value.format(l.pattern?l.pattern:"HH:mm:ss");else if("checkbox01"===i)o=a.value?"1":"0";else if(l.dictionary)"checkbox"==l.ui&&Array.isArray(a.value)&&(o=a.value.join(","));else if("Cascader"==l.ui)Array.isArray(a.value)&&(o=a.value.join(","),console.info("Cascader",a.value,o));else if("AutoComplete"==l.ui)o=a.value;else if(l.valueRef&&"TreeSelect"!=l.ui){if(o=Array.isArray(a.value)?a.value.filter(e=>e&&e.key).map(e=>e.key).join(","):a.value.key?a.value.key:null,l.showColumn){var r=this.getLayout().columnMap[l.showColumn.split(",")[0]];if(r){var s=a.value.map(e=>Array.isArray(e.label)?e.label[0]:e.label).join(",");this.state.formData[r.id]||(this.state.formData[r.id]={}),this.state.formData[r.id].value=s}}}else"Upload"===l.ui?(console.info("upload",o),Array.isArray(o)&&(o=o[0].name)):"MAP"==l.ui?(o=this.state.formData[t].value,a.dirty=!0):("string"==typeof o&&(o=o.trim(),l.size>0&&o.length>l.size&&(o=o.substr(0,l.size))),"NUM"==l.type&&("number"!==typeof o&&(o=new String(o).split("").filter(e=>!R.isEmpty(e)).filter((e,t,a)=>0==t&&"-"==e||"."==e&&a.filter((e,a)=>a<t).every(e=>"."!=e)||R.isNumber(e)).join("")),void 0!=l.min&&null!=l.min&&(null==o||o<l.min)&&(o=l.min),void 0!=l.max&&null!=l.max?o>l.max&&(o=l.max):l.size&&o>Math.pow(10,l.size)-1&&(o=Math.pow(10,l.size)-1)));a.value=o}),this.setState({formData:(0,w.default)({},this.state.formData,e),fwParam:a})}}),this.doOtherInputValidate=(()=>{var e=this.state,t=e.formData,a=(e.fwParam,null),l=null,i=null;return t.INIT_MEMBER_LEVEL_AG&&(a=parseFloat(t.INIT_MEMBER_LEVEL_AG.value)),t.INIT_MEMBER_LEVEL_AU&&(l=parseFloat(t.INIT_MEMBER_LEVEL_AU.value)),t.INIT_MEMBER_LEVEL_PT&&(i=parseFloat(t.INIT_MEMBER_LEVEL_PT.value)),null!=a&&(null!=l&&a>l||null!=i&&a>i)?"\u94f6\u5361\u8f66\u4ef7\u4e0d\u53ef\u9ad8\u4e8e\u91d1\u5361\u6216\u94c2\u91d1\u8f66\u4ef7":null!=l&&null!=i&&l>i?"\u91d1\u5361\u8f66\u4ef7\u4e0d\u53ef\u9ad8\u4e8e\u94c2\u91d1\u8f66\u4ef7":null}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],r=i;if(e.onFormat)r=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var s=this.getLayout().dictMap[e.dictionary][i];r=s||i}else e.showColumn&&(r=e.showColumn.split(",").map(e=>t[e]).join(" "));return o.default.createElement("span",null,r)}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,w.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return T.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.FIX_WIDTH={},this.CustomizedForm=b.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t={};return this.getLayout().columns.filter(e=>e.visible).map(e=>{var a=(0,w.default)({},this.state.formData[e.id]);if(a&&null!=a.value)if("DatePicker"===e.ui)a.value=a.value?(0,A.default)(a.value,e.pattern?e.pattern:"YYYY-MM-DD"):a.value;else if("TimePicker"===e.ui)a.value=a.value?(0,A.default)(a.value,e.pattern?e.pattern:"HH:mm:ss"):a.value;else if("checkbox01"===e.ui)a.value="1"==a.value;else if(e.dictionary)"checkbox"==e.ui?Array.isArray(a.value)||(a.value=String(a.value).split(",")):a.value=String(a.value);else if("Cascader"==e.ui)a.value=String(a.value).split(",");else if("AutoComplete"==e.ui);else if(e.valueRef&&"TreeSelect"!=e.ui){if(Array.isArray(a.value)||(a.value?a.value=String(a.value).split(",").map(e=>({key:e})):a.value=[]),Array.isArray(a.value)&&e.showColumn){var l=this.state.formData[e.showColumn.split(",")[0]];l&&l.value&&l.value.split(",").map((e,t)=>a.value.length>t?a.value[t].label=e:null)}}else"MAP"==e.ui?a.value=a.value.split("\u3001").join(""):"NUM"!=e.type||e.dictionary?a.value=String(a.value):(""==a.value&&(a.value=null),a.value);e.valueRef&&"TreeSelect"!=e.ui&&null==a.value&&delete a.value,t[e.id]=b.default.createFormField((0,w.default)({},a))}),t},onValuesChange(e,t){}})(e=>{this.state.form=e.form;var t=e.form.getFieldDecorator,a=this.state.formData,l=null;l=this.getLayout().columnMap.MT_TODO_FOLLOW_INVALID_COUNT,a.MT_TODO_FOLLOW_INVALID_UNIT&&"1"==a.MT_TODO_FOLLOW_INVALID_UNIT.value?l.tail="\u6b21\u65e0\u6548\u5219\u56de\u6536":l.tail="\u5929\u65e0\u6548\u5219\u56de\u6536",l=this.getLayout().columnMap.INS_TODO_FOLLOW_INVALID_COUNT,a.INS_TODO_FOLLOW_INVALID_UNIT&&"1"==a.INS_TODO_FOLLOW_INVALID_UNIT.value?l.tail="\u6b21\u65e0\u6548\u5219\u56de\u6536":l.tail="\u5929\u65e0\u6548\u5219\u56de\u6536";var i={valuePropName:"checkbox01"==l.ui?"checked":"value",validateTrigger:"onBlur",rules:[{required:l.required,message:l.label+"\u5fc5\u9700\u8f93\u5165"}]},n=[];n.push(o.default.createElement(r.default,{key:1},o.default.createElement(s.default,{span:23,style:z},o.default.createElement("div",{style:x}),"\xa0",o.default.createElement("b",null,"\u670d\u52a1\u63d0\u9192")))),n.push(o.default.createElement(r.default,{key:1.1,style:G},["RE_INSURANCE_DAYS","SERVICE_NUMBER"].map((e,a)=>{var l=this.getLayout().columnMap[e];return o.default.createElement(s.default,{key:e,span:8},o.default.createElement(O,(0,g.default)({},V,{label:l.label}),t(l.id,i)(this.getInputComponent(l)),"\xa0",l.tail))}))),n.push(o.default.createElement(r.default,{key:1.2,style:G},["MAINTAIN_MILES","MAINTAIN_DAYS"].map((e,a)=>{var l=this.getLayout().columnMap[e];return o.default.createElement(s.default,{key:e,span:8},o.default.createElement(O,(0,g.default)({},V,{label:l.label}),t(l.id,i)(this.getInputComponent(l)),"\xa0",l.tail))}))),n.push(o.default.createElement(r.default,{key:2},o.default.createElement(s.default,{span:23,style:z},o.default.createElement("div",{style:x}),"\xa0",o.default.createElement("b",null,"\u5f85\u529e\u4e8b\u9879\u56de\u6536&\u5206\u914d\u673a\u5236")))),n.push(o.default.createElement(r.default,{key:2.1},o.default.createElement(s.default,{span:4,style:Y},o.default.createElement("b",null,"\u4fdd\u517b\u63d0\u9192")))),n.push(o.default.createElement(r.default,{key:2.2},["MT_TODO_UNFOLLOW_RECYCLE","MT_TODO_FOLLOW_INVALID_UNIT","MT_TODO_FOLLOW_INVALID_COUNT","MT_TODO_AUTO_DISTRIBUTE_DAYS"].map((e,a)=>{var l=this.getLayout().columnMap[e],r="MT_TODO_FOLLOW_INVALID_COUNT"!=e?V:{};return o.default.createElement(s.default,{key:e,span:6},o.default.createElement(O,(0,g.default)({},r,{label:"MT_TODO_FOLLOW_INVALID_COUNT"!=e?l.label:null}),t(l.id,i)(this.getInputComponent(l)),"\xa0",l.tail))}))),n.push(o.default.createElement(r.default,{key:2.3},o.default.createElement(s.default,{span:4,style:Y},o.default.createElement("b",null,"\u7eed\u4fdd\u63d0\u9192")))),n.push(o.default.createElement(r.default,{key:2.4},["INS_TODO_UNFOLLOW_RECYCLE","INS_TODO_FOLLOW_INVALID_UNIT","INS_TODO_FOLLOW_INVALID_COUNT","INS_TODO_AUTO_DISTRIBUTE_DAYS"].map((e,a)=>{var l=this.getLayout().columnMap[e],r="INS_TODO_FOLLOW_INVALID_COUNT"!=e?V:{};return o.default.createElement(s.default,{key:e,span:6},o.default.createElement(O,(0,g.default)({},r,{label:"INS_TODO_FOLLOW_INVALID_COUNT"!=e?l.label:null}),t(l.id,i)(this.getInputComponent(l)),"\xa0",l.tail))}))),n.push(o.default.createElement(r.default,{key:3},o.default.createElement(s.default,{span:23,style:z},o.default.createElement("div",{style:x}),"\xa0",o.default.createElement("b",null,"\u4f1a\u5458\u7b49\u7ea7\u89c4\u5219")))),n.push(o.default.createElement(r.default,{key:3.1},o.default.createElement(s.default,{span:4,style:Y},o.default.createElement("b",null,"\u4f1a\u5458\u7b49\u7ea7&\u79ef\u5206\u89c4\u5219")))),n.push(o.default.createElement(r.default,{key:3.2,style:G},["AMOUNT_PER_POINT","POINTS_PER_COMMENT","LEVEL_VALID_MONTHS"].map((e,a)=>{var l=this.getLayout().columnMap[e];return o.default.createElement(s.default,{key:e,span:6,offset:0==a?4:0},o.default.createElement(O,(0,g.default)({},V,{label:l.label}),t(l.id,i)(this.getInputComponent(l)),"\xa0",l.tail))}),o.default.createElement(s.default,{span:6}))),n.push(o.default.createElement(r.default,{key:3.3},o.default.createElement(s.default,{span:4,style:Y},o.default.createElement("b",null,"\u6ce8\u518c\u4f1a\u5458\u521d\u59cb\u7b49\u7ea7")))),n.push(o.default.createElement(r.default,{key:3.4,style:G},["INIT_MEMBER_LEVEL_PT","INIT_MEMBER_LEVEL_AU","INIT_MEMBER_LEVEL_AG"].map((e,a)=>{var l=this.getLayout().columnMap[e];return o.default.createElement(s.default,{key:e,span:6,offset:0==a?4:0},o.default.createElement(O,(0,g.default)({},V,{label:l.label}),t(l.id,i)(this.getInputComponent(l)),"\xa0",l.tail))}),o.default.createElement(s.default,{span:12}))),n.push(o.default.createElement(r.default,{key:3.5},o.default.createElement(s.default,{span:4,style:Y},o.default.createElement("b",null,"\u4f1a\u5458\u5347\u7ea7\u89c4\u5219\uff08\u6709\u6548\u671f\u5185\u83b7\u5f97\u79ef\u5206\uff09")))),n.push(o.default.createElement(r.default,{key:3.6,style:G},["UP_NORMAL_TO_AG_POINTS","UP_AG_TO_AU_POINTS","UP_AU_TO_PT_POINTS"].map((e,a)=>{var l=this.getLayout().columnMap[e];return o.default.createElement(s.default,{key:e,span:6,offset:0==a?4:0},o.default.createElement(O,(0,g.default)({},V,{label:l.label}),t(l.id,i)(this.getInputComponent(l)),"\xa0",l.tail))}),o.default.createElement(s.default,{span:12}))),n.push(o.default.createElement(r.default,{key:3.7},o.default.createElement(s.default,{span:4,style:Y},o.default.createElement("b",null,"\u4f1a\u5458\u4fdd\u7ea7\u89c4\u5219\uff08\u6709\u6548\u671f\u5185\u83b7\u5f97\u79ef\u5206\uff09")))),n.push(o.default.createElement(r.default,{key:3.8,style:G},["KEEP_TO_AG_POINTS","KEEP_TO_AU_POINTS","KEEP_TO_PT_POINTS"].map((e,a)=>{var l=this.getLayout().columnMap[e];return o.default.createElement(s.default,{key:e,span:6,offset:0==a?4:0},o.default.createElement(O,(0,g.default)({},V,{label:l.label}),t(l.id,i)(this.getInputComponent(l)),"\xa0",l.tail))}),o.default.createElement(s.default,{span:12})));var d=T.buildDetailMenus(this);return o.default.createElement(b.default,{style:{height:"100%"}},o.default.createElement("div",{style:{overflow:"auto",height:"90%",left:0,backgroundColor:"#ffffff"}},n),o.default.createElement("div",{style:{height:50,padding:10,marginTop:10,marginBottom:10,backgroundColor:"#ffffff",textAlign:"right"}},d))}),this.state=(0,w.default)({},e,{loading:!1,dialogs:{},form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{},uploadedFile:null,uploadResult:null,manualValues:{}})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData;t.newData=(0,w.default)({},this.props.initData),t.oldData=(0,w.default)({},this.props.initData),Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.setState({fwParam:this.state.fwParam,formData:a,refData:{}},()=>{this.getLayout().columns.filter(e=>"MAP"==e.ui).map(e=>this.selectPointInMap(e.id))})}else if(this.props.showAsDialog){var l=(0,w.default)({},this.state.fwParam,{oldData:{},newData:{},selectedData:this.props.selectedData});this.props.getEditData({fwCoord:this.getFwCoord(),fwParam:l,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData;a.newData=(0,w.default)({},e),a.oldData=(0,w.default)({},e),Object.keys(e).map(t=>l[t]={value:e[t]}),this.setState({fwParam:this.state.fwParam,formData:l,refData:{}})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null)}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.CustomizedForm;return o.default.createElement("div",{style:{height:"100%"}},o.default.createElement(v.default,{style:{height:"100%"},spinning:this.props.loading||this.state.loading},o.default.createElement(e,{onChange:this.handleFormChange})),Object.values(this.state.dialogs))}})||P);t.default=B},i307:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("fOrg");var r=i(a("+KLJ"));a("14J3");var s=i(a("BMrR"));a("jCWc");var n=i(a("kPKH"));a("giR+");var d=i(a("fyUT"));a("Xi6J");var u=i(a("kl6h"));a("iQDF");var c=i(a("+eQT"));a("nRaC");var f=i(a("5RzL"));a("T2oS");var h=i(a("W9HT"));a("sRBo");var m=i(a("kaz8")),p=i(a("pVnL")),v=i(a("MVZn"));a("7Kak");var g=i(a("9yH6"));a("OaEy");var w=i(a("2fM7"));a("5NDa");var y=i(a("5rEg"));a("y8nQ");var C=i(a("Vl3Y"));a("ozfa");var D=i(a("MJZm")),E=a("MuoO"),b=(i(a("QCDS")),l(a("dNXO"))),S=i(a("wd/R"));a("XDpg");var L,P,k=a("0Fy/");S.default.locale("zh-cn");var I=D.default.TreeNode,R=C.default.Item,T=y.default.TextArea,A=w.default.Option,_=g.default.Group,O={labelCol:{xs:{span:8},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16}}};function M(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.edit,dispatch:a,fwCoord:l,layout:i}}var F=e=>{return{getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})}}},N=(L=(0,E.connect)(M,F),L(P=class extends o.Component{constructor(e){super(e),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,v.default)({},this.state.fwParam,{openerSelectedData:(0,v.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,v.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(I,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+","+(t.valueRef.otherRefs?t.valueRef.otherRefs:""),selectedTreeNodeId:e.props.eventKey},callback:e=>{i.children=e.data,a.defaultOpen=!0,console.info(a.data),l(),this.setState({refData:this.state.refData})}}))})),this.getInputComponent=(e=>{var t=this.state,a=t.components,l=t.refData,i=t.fwParam,r=t.formData,s=null,n={disabled:!e.editable,style:{width:"90%"}};if("MEMO"===e.type&&(s=o.default.createElement(T,(0,p.default)({},n,{rows:4}))),"checkbox01"===e.ui)s=o.default.createElement(m.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictMap[e.dictionary]){var C=this.getLayout().dictMap[e.dictionary];s="radio"==e.ui?o.default.createElement(_,(0,p.default)({name:e.id},n),Object.keys(C).map(e=>o.default.createElement(g.default,{key:e,value:e},C[e]))):o.default.createElement(w.default,n,Object.keys(C).map(e=>o.default.createElement(A,{key:e,value:e},C[e])))}else if("TreeSelect"===e.ui&&e.valueRef){var D=e.valueRef;if(!l[e.id]){var E=null;D.function==this.props.fwParam.openerFunction&&D.view==this.props.fwParam.openerView&&this.props.treeData&&(E=this.props.treeData),l[e.id]={loading:!1,data:E,queryIndex:0,defaultOpen:!1}}var b=l[e.id];b.data||(console.info("before remote call"),b.data=[],this.props.getTreeData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:D.function,view:D.view}),fwParam:{distinct:D.distinct?D.distinct:null,queryColumns:D.value+","+D.label+","+(D.otherRefs?D.otherRefs:"")},callback:t=>{t.success?(b.data=t.data,console.info("result.data",b.data),b.loading=!1,l[e.id]=b,this.setState({refData:l})):b.data=null}})),console.info("before render ",b.data),s=o.default.createElement(f.default,(0,p.default)({},n,{placeholder:e.prompt?e.prompt:"\u8bf7\u9009\u62e9",notFoundContent:b.loading?o.default.createElement(h.default,{size:"small"}):null,showArrow:!0,filterOption:!1,loadData:t=>this.onTreeSelectLoadData(t,e,b),treeExpandedKeys:b.expandedKeys?b.expandedKeys:b.data.map(e=>String(e[D.value])),onTreeExpand:e=>{b.expandedKeys=e,b.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:b.defaultOpen,onSearch1:t=>{b.timeout&&(clearTimeout(b.timeout),b.timeout=null),b.currentValue=t;var a=()=>{console.info(t),b.loading=!0,this.props.getRefData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:D.function,view:D.view}),fwParam:{queryStr:t,distinct:D.distinct?D.distinct:null,queryColumns:D.value+","+D.label+","+(D.otherRefs?D.otherRefs:"")},callback:a=>{b.currentValue==t&&(b.data=a.data,b.loading=!1,b.defaultOpen=!0,r[e.id].value=t,this.setState({refData:l,fwParam:i,formData:r}))}})};b.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(b.data,D))}else if(null!=e.valueRef){var S=e.valueRef;if(!l[e.id]){console.info(i.newData);var L={};L[S.value]=r[e.id]?r[e.id].value:0,e.showColumn&&r[e.showColumn]&&(console.info("showcolumn",e.showColumn,r),L[S.label]=r[e.showColumn].value),l[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:l})}var P=l[e.id];P.data||(console.info("before remote call"),P.data=[],this.props.getRefData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:S.function,view:S.view}),fwParam:{distinct:S.distinct?S.distinct:null,queryColumns:S.value+","+S.label+","+(S.otherRefs?S.otherRefs:"")},callback:t=>{var a,i=[];(t.success&&(i=t.data),e.showColumn)&&function(){console.info("showColumn",r[e.showColumn],r[e.id]);var t=r[e.showColumn]&&r[e.showColumn].value?r[e.showColumn].value.split(","):[],l=r[e.id]&&r[e.id].value?r[e.id].value.split(","):[],o=null;if(l.length>0&&t.length==l.length)for(a=0;a<l.length;++a)i.filter(e=>e[S.value]==l[a])||(o={},o[S.value]=l[a],o[S.label]=t[a],i.push(o))}();console.info("this.state.fwParam.newData",this.state.fwParam.newData),P.data=i,P.loading=!1,l[e.id]=P,this.setState({refData:l,formData:r})}}));var k=P.data.map(e=>o.default.createElement(A,{key:e[S.value]},e[S.label],S.otherRefs?S.otherRefs.split(",").map(t=>{e[t]}):""));s=o.default.createElement(w.default,(0,p.default)({},n,{showSearch:!0,placeholder:e.prompt,mode:e.multiSelect?"multiple":null,notFoundContent:P.loading?o.default.createElement(h.default,{size:"small"}):null,showArrow:!0,filterOption:!1,labelInValue:!0,autoFocus:P.autoFocus,defaultOpen:P.defaultOpen,onBlur:()=>console.info("blur"),onSearch:t=>{P.timeout&&(clearTimeout(P.timeout),P.timeout=null),P.currentValue=t;var a=()=>{P.loading=!0,this.props.getRefData({fwCoord:(0,v.default)({},this.getFwCoord(),{function:S.function,view:S.view}),fwParam:{queryValue:t,distinct:S.distinct?S.distinct:null,queryColumns:S.value+","+S.label+","+(S.otherRefs?S.otherRefs:"")},callback:a=>{if(P.currentValue==t){var o,s=[];if(a.success&&(s=a.data),e.showColumn)(function(){var t=r[e.showColumn]&&r[e.showColumn].value?r[e.showColumn].value.split(","):[],a=r[e.id]&&r[e.id]?String(r[e.id].value).split(","):[],l=null;if(a.length>0&&t.length==a.length)for(o=0;o<a.length;++o)s.filter(e=>e[S.value]==a[o])||(l={},l[S.value]=a[o],l[S.label]=t[o],s.push(l))})();console.info("this.state.fwParam.newData2",this.state.fwParam.newData),P.data=s,P.loading=!1,P.defaultOpen=!0,P.autoFocus=!0,this.setState({refData:l,fwParam:i})}}})};P.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange"),console.info(e)}}),k)}else{if("DatePicker"===e.ui)return o.default.createElement(c.default,n);if("TimePicker"===e.ui)return o.default.createElement(u.default,n);if("InputNumber"===e.ui)return o.default.createElement(d.default,n);"Upload"===e.ui||("MAP"==e.ui?(console.info("col.ui",e.ui),s=o.default.createElement(y.default,(0,p.default)({},n,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn)}return s||(s=o.default.createElement(y.default,(0,p.default)({},n,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u8f93\u5165"}))),a[e.id]=s,s}),this.handleFormChange=(e=>{e&&(Object.keys(e).map(t=>{var a=e[t],l=this.getLayout().columnMap[t],i=l.ui,o=null;if(a&&null!=a.value)if(this.state.formData[t]||(this.state.formData[t]={}),o=a.value,"DatePicker"===i)o=a.value.format(l.pattern?l.pattern:"YYYY-MM-DD");else if("TimePicker"===i)o=a.value.format(l.pattern?l.pattern:"HH:mm:ss");else if("checkbox01"===i)o=a.value?"1":"0";else if(l.valueRef&&"TreeSelect"!=l.ui){if(o=a.value.filter(e=>e&&e.key).map(e=>e.key).join(","),l.showColumn){var r=this.getLayout().columnMap[l.showColumn.split(",")[0]];if(r){var s=a.value.map(e=>Array.isArray(e.label)?e.label[0]:e.label).join(",");this.state.formData[r.id]||(this.state.formData[r.id]={}),this.state.formData[r.id].value=s}}}else"MAP"==l.ui&&(o=this.state.formData[t].value,a.dirty=!0);a.value=o}),this.setState({formData:(0,v.default)({},this.state.formData,e)}))}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],o=i;if(e.onFormat)o=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var r=this.getLayout().dictMap[e.dictionary][i];o=r||i}else e.showColumn&&(o=e.showColumn.split(",").map(e=>t[e]).join(" "));return o}),this.getLayout=(()=>{return this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,v.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return b.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.CustomizedForm=C.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t={};return this.getLayout().columns.filter(e=>e.visible).map(e=>{var a=(0,v.default)({},this.state.formData[e.id]);if(a&&null!=a.value)if("DatePicker"===e.ui)a.value=a.value?(0,S.default)(a.value,e.pattern?e.pattern:"YYYY-MM-DD"):a.value;else if("TimePicker"===e.ui)a.value=a.value?(0,S.default)(a.value,e.pattern?e.pattern:"HH:mm:ss"):a.value;else if("checkbox01"===e.ui)a.value="1"==a.value;else if(e.valueRef&&"TreeSelect"!=e.ui){if(Array.isArray(a.value)||(a.value?a.value=String(a.value).split(",").map(e=>({key:e})):a.value=[]),e.showColumn){var l=this.state.formData[e.showColumn.split(",")[0]];l&&l.value&&l.value.split(",").map((e,t)=>a.value.length>t?a.value[t].label=e:null)}}else"MAP"==e.ui||("NUM"!=e.type||e.dictionary?a.value=String(a.value):e.decimalSize>0?a.value=parseFloat(a.value):a.value=parseInt(a.value));t[e.id]=C.default.createFormField((0,v.default)({},a))}),t},onValuesChange(e,t){}})(e=>{this.state.form=e.form;e.form.getFieldDecorator;var t=this.getLayout().columns.filter(e=>e.visible),a={_default:[]},l={};this.getLayout().columnGroups&&this.getLayout().columnGroups.map(e=>l[e.id]=e),t.map(e=>{var t="_default";e.group&&l[e.group]&&(t=e.group),a[t]||(a[t]=[]),a[t].push(e)});var i=e=>e?e.map(e=>{return o.default.createElement(n.default,{span:t.length>5?12:24,key:e.id,style:{height:24}},o.default.createElement(R,(0,p.default)({},O,{label:e.label}),this.getDisplayValue(e)," ",e.tail))}):[],r=[];return Object.keys(a).length>1?["_default",...this.getLayout().columnGroups.map(e=>e.id)].map(e=>{l[e]&&a[e]&&a[e].length>0&&r.push(o.default.createElement(n.default,{span:24,key:"group_"+e,style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,l[e].title))),r=[...r,...i(a[e])]}):r=i(t),o.default.createElement(C.default,null,o.default.createElement(s.default,{gutter:1},r))}),this.state=(0,v.default)({},e,{form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{}})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData;t.newData=(0,v.default)({},this.props.initData),t.oldData=(0,v.default)({},this.props.initData),Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.setState({fwParam:this.state.fwParam,formData:a,refData:{}})}else if(this.props.showAsDialog){var l=(0,v.default)({},this.state.fwParam,{oldData:{},newData:{},selectedData:this.props.selectedData});this.props.getEditData({fwCoord:this.getFwCoord(),fwParam:l,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData;a.newData=(0,v.default)({},e),a.oldData=(0,v.default)({},e),Object.keys(e).map(t=>l[t]={value:e[t]}),this.setState({fwParam:this.state.fwParam,formData:l,refData:{}})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null)}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){this.CustomizedForm;return o.default.createElement("div",null,o.default.createElement(h.default,{spinning:!1},!this.state.points||1!=this.state.points.length||this.state.points[0].lat&&this.state.points[0].lng?null:o.default.createElement(r.default,{message:"\u8bbe\u5907\u672a\u5b9a\u4f4d",type:"info",showIcon:!0}),o.default.createElement(k.Map,(0,p.default)({height:500},this.props.mapOptions,{points:this.state.points}))))}})||P);t.default=N},iPio:function(e,t){e.exports="data:;base64,PCFkb2N0eXBlIGh0bWw+DQo8aHRtbD4NCjxoZWFkPg0KICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0iaW5pdGlhbC1zY2FsZT0xLjAsIG1heGltdW0tc2NhbGU9MS4wLCB1c2VyLXNjYWxhYmxlPW5vIj4NCiAgPG1ldGEgbmFtZT0iZm9ybWF0LWRldGVjdGlvbiIgY29udGVudD0idGVsZXBob25lPXllcyIvPg0KICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCIgLz4NCiAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwOi8vYXBpLm1hcC5iYWlkdS5jb20vbGlicmFyeS9EcmF3aW5nTWFuYWdlci8xLjQvc3JjL0RyYXdpbmdNYW5hZ2VyX21pbi5jc3MiIC8+DQogIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Imh0dHA6Ly9hcGkubWFwLmJhaWR1LmNvbS9hcGk/dj0zLjAmYWs9dTJ2WjlmVDdsSXpiZ0drQlRsRlF1NFk2Ij48L3NjcmlwdD4NCiAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iaHR0cDovL2FwaS5tYXAuYmFpZHUuY29tL2xpYnJhcnkvRHJhd2luZ01hbmFnZXIvMS40L3NyYy9EcmF3aW5nTWFuYWdlcl9taW4uanMiPjwvc2NyaXB0Pg0KICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJodHRwOi8vYXBpLm1hcC5iYWlkdS5jb20vbGlicmFyeS9UZXh0SWNvbk92ZXJsYXkvMS4yL3NyYy9UZXh0SWNvbk92ZXJsYXlfbWluLmpzIj48L3NjcmlwdD4NCgk8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJodHRwOi8vYXBpLm1hcC5iYWlkdS5jb20vbGlicmFyeS9NYXJrZXJDbHVzdGVyZXIvMS4yL3NyYy9NYXJrZXJDbHVzdGVyZXJfbWluLmpzIj48L3NjcmlwdD4NCiAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iaHR0cDovL3Jlcy53eC5xcS5jb20vb3Blbi9qcy9qd2VpeGluLTEuNC4wLmpzIj48L3NjcmlwdD4NCiAgPHN0eWxlPg0KICAgIGh0bWwsYm9keSB7DQogICAgICAgIG1hcmdpbjogMDsNCiAgICAgICAgcGFkZGluZzogMDsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIGhlaWdodDogMTAwJTsNCiAgICB9Lyrov5nph4zmmK/lhbPplK4qLw0KICAgIGRpdiAuYW50LXRhYnMtY29udGVudCB7DQogICAgICBoZWlnaHQ6MTAwJTsNCiAgICB9DQogICAgZGl2IC5hbnQtdGFicy10YWIgew0KICAgICAgaGVpZ2h0OjEwMCU7DQogICAgfQ0KICAgIGRpdiAuYW50LXRhYnMtdGFicGFuZSB7DQogICAgICBoZWlnaHQ6MTAwJTsNCiAgICB9DQogICAgZGl2IC5hbnQtc3Bpbi1uZXN0ZWQtbG9hZGluZyB7DQogICAgICBoZWlnaHQ6IDEwMCU7DQogICAgfQ0KICAgIGRpdiAuYW50LXNwaW4tY29udGFpbmVyIHsNCiAgICAgIGhlaWdodDogMTAwJTsNCiAgICB9DQogIDwvc3R5bGU+DQogIDx0aXRsZT5Mb2FkaW5nLi4uPC90aXRsZT4NCjwvaGVhZD4NCjxib2R5Pg0KICA8ZGl2IGlkPSJyb290IiBzdHlsZT0iaGVpZ2h0OiAxMDAlOyI+PC9kaXY+DQo8L2JvZHk+DQoNCjwvaHRtbD4="},kw1y:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("Ksrn");var r=i(a("MR/8"));a("14J3");var s=i(a("BMrR"));a("Telt");var n=i(a("Tckk"));a("Q9mQ");var d=i(a("diRs"));a("jCWc");var u=i(a("kPKH"));a("+L6B");var c=i(a("2/Rp"));a("qVdP");var f=i(a("jsC+")),h=i(a("pVnL"));a("T2oS");var m=i(a("W9HT"));a("Pwec");var p=i(a("CtXQ")),v=i(a("MVZn"));a("5NDa");var g=i(a("5rEg"));a("Znn+");var w=i(a("ZTPi"));a("lUTK");var y=i(a("BvKs"));a("B9cy");var C,D,E=i(a("Ol7k")),b=a("MuoO"),S=(i(a("usdK")),i(a("MVSn"))),L=(i(a("U5mO")),l(a("dNXO"))),P=l(a("uYVn")),k=a("QCDS"),I=E.default.Header,R=(E.default.Footer,E.default.Sider),T=E.default.Content,A=y.default.SubMenu,_=w.default.TabPane;g.default.Search;function O(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.fw,dispatch:a,fwCoord:l,layout:i}}var M=e=>{return{loadLayout:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,fwParam:l,callback:i}})},changePassword:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"fw/changePassword",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})}}},F=(C=(0,b.connect)(O,M),C(D=class extends o.Component{constructor(e){var t;t=super(e),this.selectMember=((e,t)=>{console.info("key",e),this.openTab("memberDetail","\u4f1a\u5458\u8d44\u6599","projects/zd4s/memberDetail",{memberIdAndCarId:e})}),this.showMainDataBoard=(e=>{var t="../../projects/zd4s/biMainBoard.html",a=(0,k.getSimulateUserId)(location.search);a&&(t=t+"?su="+a),window.open(t)}),this.getOpenPage=function(e,t,l,i,r){var s=null,n=t,d=null,u=null;return i&&i.argument&&(d=i.argument.function,u=i.argument.view,u||(u=null),i.argument.antdPath?n=i.argument.antdPath:u&&(n="fw/"+u+"/"+u)),n||(n="fw/grid/grid"),s=a("RO01")(`./${n}`).default,o.default.createElement("div",{style:{height:"100%"}},o.default.createElement(s,{innerLayout:r,innerFwCoord:(0,v.default)({},this.state.fwCoord,{function:d,view:u}),state:l,mainPagePath:n,refreshMemberList:()=>{this.memberSearchIns&&this.memberSearchIns.refresh()},jumpTo:(t,a,l)=>this.switchTabPage(e,t,a,l),openMainTab:(e,t,a,l,i)=>this.openTab(e,t,a,l,i),closeMainTab:()=>this.onEditTab(e,"remove")}))},this.onEditTab=((e,t)=>{var a=this.state.tabs;if("remove"==t){var l=0;Object.keys(a).map((t,a)=>t==e?l=a:null),delete a[e],--l,l<0&&(l=0),this.setState({tabs:a,activeTab:Object.keys(a)[l]})}}),this.openTab=((e,t,a,l,i)=>{var r=this.state.tabs,s=null,n=null,d=null,u=t;i&&(i.argument&&(s=i.argument.function,n=i.argument.view),d=i.icon,u||(u=i.label)),n||(n=null),d||(d="pie-chart");var c={style:(0,v.default)({},P.getFillHeight(60))};r[e]?(r[e]=o.default.createElement(_,(0,h.default)({key:e},c,{action:i,tab:o.default.createElement("span",null,o.default.createElement(p.default,{type:d}),u),closable:e!=this.state.firstTab}),this.getOpenPage(e,a,l,i,null)),this.setState({newTabs:r,activeTab:e})):(r[e]=o.default.createElement(_,(0,h.default)({key:e},c,{tab:o.default.createElement("span",null,o.default.createElement(p.default,{type:d}),u),closable:e!=this.state.firstTab,style:{margin:"10px"}}),o.default.createElement(m.default,{size:"large",style:{width:"100%"}},"\u52a0\u8f7d\u4e2d...")),this.setState({tabs:r,activeTab:e}),s?this.props.loadLayout({fwCoord:(0,v.default)({},this.getFwCoord(),{function:s,view:n}),callback:t=>{var r=(0,v.default)({},this.state.tabs);r[e]=o.default.createElement(_,(0,h.default)({key:e},c,{action:i,tab:o.default.createElement("span",null,o.default.createElement(p.default,{type:d}),u),closable:e!=this.state.firstTab}),this.getOpenPage(e,a,l,i,t)),this.setState({tabs:r,activeTab:e})}}):(r[e]=o.default.createElement(_,(0,h.default)({key:e},c,{action:i,tab:o.default.createElement("span",null,o.default.createElement(p.default,{type:d}),u),closable:e!=this.state.firstTab}),this.getOpenPage(e,a,l,i,null)),this.setState({tabs:r,activeTab:e})))}),this.switchTabPage=((e,l,i,r)=>{console.info("otherParams",r);var s=a("RO01")(`./${l}`).default,n=this.state.tabs,d=n[e].props.action,u=o.default.createElement(s,(0,h.default)({},r,{backParams:r,state:i,mainPagePath:l,jumpTo:function(a,l){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t.switchTabPage(e,a,l,i)}}));n[e]=o.default.createElement(_,{key:e,action:d,tab:o.default.createElement("span",null,o.default.createElement(p.default,{type:d.icon}),d.label),closable:e!=this.state.firstTab},u),this.setState({tabs:n})}),this.onMenuClick=function(e){e.item;var t=e.key;e.keyPath;if(this.state.tabs[t])this.setState({activeTab:t});else{var a=this.getLayout().actionArgs[t];this.openTab(t,null,null,null,a)}},this.onSystemMenuClick=function(e){"changePassword"==e.key?L.getActionEntry(this,"showChangePassword").logic(this,"showChangePassword",null,-1,e):e.key},this.onTabExtendMenuClick=function(e){var t=this.state.activeTab;"closeAll"===e.key&&(t=this.state.firstTab);var a=this.state.tabs,l=Object.keys(a)[0];console.info(l),Object.keys(this.state.tabs).map((e,l)=>l>0&&(null==t||e!==t)?delete a[e]:null),this.setState({tabs:a,activeTab:null==t?l:t})},this.rootSubmenuKeys=[],this.onOpenChange=((e,t)=>{console.info("openchange",e,t);var a=e.find(e=>-1===this.state.openKeys.indexOf(e));-1===this.rootSubmenuKeys.indexOf(a)?t?this.setState({openKeys:[]}):this.setState({openKeys:e}):this.setState({openKeys:a?[a]:[]})}),this.getLayout=(()=>{return this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,v.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.state=(0,v.default)({},e,{openKeys:[],collapsed:!1,activeTab:null,dialogs:{},tabs:{},firstTab:null})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this)}setTitle(e){var t=this.getLayout(),a=t.title,l=t.project,i="";l&&(l["main.title"]?i=l["main.title"]:l["project.title"]&&(i=l["project.title"])),!i&&a&&(i=a),e&&(i=e),"ddb.gpswv.com"==location.hostname&&(i="\u5230\u5e97\u4fdd"),document.title=i}render(){this.rootSubmenuKeys=[];var e=this.getLayout().displayActions.filter(e=>0!=e.id.indexOf("_")).map(e=>{if("group"===e.tag&&e.children&&e.children.filter(e=>e.visible).length>0){var t=null,a=e.children.filter(e=>e.visible).map(e=>{return t=e.label,null==this.state.firstTab&&(this.state.firstTab=e.id,this.setState({firstTab:e.id},()=>this.onMenuClick({item:null,key:this.state.firstTab,keyPath:null}))),o.default.createElement(y.default.Item,{key:e.id},o.default.createElement(p.default,{type:e.icon?e.icon:""}),o.default.createElement("span",null,e.label))});return 1==a.length&&t==e.label?a[0]:(this.rootSubmenuKeys.push("group_"+e.id),o.default.createElement(A,{key:"group_"+e.id,title:o.default.createElement("span",null,o.default.createElement(p.default,{type:e.icon?e.icon:"setting"}),o.default.createElement("span",null,e.label))},a))}}),t=o.default.createElement(y.default,{onClick:e=>this.onSystemMenuClick(e)},o.default.createElement(y.default.Item,{key:"changePassword"},"\u4fee\u6539\u5bc6\u7801"),o.default.createElement(y.default.Item,{key:"exit"},o.default.createElement("a",{href:"/fw/logout"},"\u9000\u51fa\u7cfb\u7edf"))),l=o.default.createElement(y.default,{onClick:e=>this.onTabExtendMenuClick(e)},o.default.createElement(y.default.Item,{key:"closeAll"},"\u5168\u90e8\u5173\u95ed"),o.default.createElement(y.default.Item,{key:"closeOthers"},"\u5173\u95ed\u5176\u5b83")),i=o.default.createElement(f.default,{overlay:l},o.default.createElement("a",{className:"ant-dropdown-link",href:"javascript:;"},o.default.createElement(p.default,{type:"down"}))),h=a("xc/l"),v=null,g=150,C=20;return v="ddb.gpswv.com"==location.hostname?"../../../../../ui/projects/zd4s/logo_ddb.png":this.getLayout()&&this.getLayout().project&&this.getLayout().project["project.logo"]?`../../../../${this.getLayout().project["project.logo"]}`:"../../../../../ui/projects/zd4s/logo.png",this.getLayout().loading?o.default.createElement(m.default,{size:"large"},"\u52a0\u8f7d\u4e2d..."):o.default.createElement(r.default,{locale:h},o.default.createElement(E.default,{style:{height:"100%"}},o.default.createElement(R,{width:220,style:{overflow:"auto",height:"100%",left:0},collapsed:this.state.collapsed},o.default.createElement("div",{style:{textAlign:"center"}},o.default.createElement("img",{src:v,style:{width:g,margin:C}}),o.default.createElement(c.default,{onClick:()=>this.setState({collapsed:!this.state.collapsed}),style:{width:"90%",margin:10,backgroundColor:"#192C3E",border:"none",color:"#7F7F7F"}},o.default.createElement(p.default,{type:this.state.collapsed?"menu-unfold":"menu-fold"}))),o.default.createElement(y.default,{theme:"dark",mode:"inline",inlineCollapsed:this.state.collapsed,defaultSelectedKeys:["1"],selectedKeys:[this.state.activeTab],onClick:e=>{var t=e.item,a=e.key,l=e.keyPath;return this.onMenuClick({item:t,key:a,keyPath:l})},openKeys:this.state.openKeys,onOpenChange:e=>this.onOpenChange(e)},e)),o.default.createElement(T,{style:{height:"100%"}},o.default.createElement(E.default,{style:{height:"100%"}},o.default.createElement(I,{style:{textAlign:"center",paddingLeft:10,paddingRight:10,height:60,backgroundColor:"#ffffff"}},o.default.createElement(s.default,null,o.default.createElement(u.default,{span:3,style:{textAlign:"left",color:"#0",fontSize:24,minWidth:"ddb.gpswv.com"==location.hostname?100:230,maxWidth:"ddb.gpswv.com"==location.hostname?100:230}},"ddb.gpswv.com"==location.hostname?"\u5230\u5e97\u4fdd":this.getLayout().project?this.getLayout().project["main.title"]?this.getLayout().project["main.title"]:this.getLayout().project["project.name"]:null),o.default.createElement(u.default,{span:1,style:{textAlign:"left"}},this.getLayout().actionArgs["bi_mainboard"]&&this.getLayout().actionArgs["bi_mainboard"].visible?o.default.createElement(c.default,{type:"primary",shape:"circle",icon:"fund",size:"large",onClick:e=>this.showMainDataBoard(e)}):null),o.default.createElement(u.default,{style:{textAlign:"right"}},this.getLayout().actionArgs["search_member"]&&this.getLayout().actionArgs["search_member"].visible?o.default.createElement(S.default,{selectedMember:this.selectMember,onRef:e=>this.memberSearchIns=e}):null,o.default.createElement(d.default,{content:"\u5ba2\u670d\u7535\u8bdd 0532-80922954"},o.default.createElement(p.default,{type:"customer-service",size:"large",style:{fontSize:20,color:"#0",margin:"0 20px 0 10px"}})),o.default.createElement(n.default,{icon:"user",style:{marginRight:"10px"}}),o.default.createElement(f.default,{overlay:t},o.default.createElement("a",{className:"ant-dropdown-link",href:"javascript:;",style:{color:"#0"}},this.getLayout().user?this.getLayout().user.name:"\u672a\u77e5"," ",o.default.createElement(p.default,{type:"down"}))))),Object.values(this.state.dialogs)),o.default.createElement(T,{style:{height:"100%",left:0,marginLeft:10,marginRight:10,marginTop:12}},o.default.createElement(w.default,{defaultActiveKey:"1",type:"editable-card",style:{height:"100%"},hideAdd:!0,activeKey:this.state.activeTab,tabBarExtraContent:i,onChange:e=>this.setState({activeTab:e}),onEdit:(e,t)=>this.onEditTab(e,t)},Object.values(this.state.tabs)))))))}})||D);t.default=F},lRx8:function(e,t,a){"use strict";var l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.logic=i;l(a("uYVn"));function i(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,this.view.getSelectData({})}},"lV+C":function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("Pwec");var r=i(a("CtXQ")),s=i(a("MVZn"));a("lUTK");var n=i(a("BvKs"));a("B9cy");var d,u,c=i(a("Ol7k")),f=a("MuoO"),h=i(a("mOP9")),m=c.default.Header,p=c.default.Footer,v=c.default.Sider,g=c.default.Content,w=n.default.SubMenu;function y(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.fw,dispatch:a,fwCoord:l,layout:i}}var C=e=>{return{}},D=(d=(0,f.connect)(y,C),d(u=class extends o.Component{constructor(e){super(e),this.state=(0,s.default)({},e,{tabs:{}})}render(){return o.default.createElement(c.default,null,o.default.createElement(v,{width:256,style:{minHeight:"100vh"}},o.default.createElement("div",{style:{height:"32px",background:"rgba(255,255,255,.2)",margin:"16px"}}),o.default.createElement(n.default,{theme:"dark",mode:"inline",defaultSelectedKeys:["1"]},o.default.createElement(n.default.Item,{key:"1"},o.default.createElement(h.default,{to:"grid?fwCoord.function=users"},o.default.createElement(r.default,{type:"pie-chart"}),o.default.createElement("span",null,"Helloworld"))),o.default.createElement(n.default.Item,{key:"20"},o.default.createElement(h.default,{to:"grid?fwCoord.function=plc"},o.default.createElement(r.default,{type:"pie-chart"}),o.default.createElement("span",null,"Member"))),o.default.createElement(w,{key:"sub1",title:o.default.createElement("span",null,o.default.createElement(r.default,{type:"dashboard"}),o.default.createElement("span",null,"Dashboard"))},o.default.createElement(n.default.Item,{key:"2"},o.default.createElement(h.default,{to:"/dashboard/analysis"},"\u5206\u6790\u9875")),o.default.createElement(n.default.Item,{key:"3"},o.default.createElement(h.default,{to:"/dashboard/monitor"},"\u76d1\u63a7\u9875")),o.default.createElement(n.default.Item,{key:"4"},o.default.createElement(h.default,{to:"/dashboard/workplace"},"\u5de5\u4f5c\u53f0"))))),o.default.createElement(c.default,null,o.default.createElement(m,{style:{background:"#fff",textAlign:"center",padding:0}},"Header"),o.default.createElement(g,{style:{margin:"24px 16px 0"}},o.default.createElement("div",{style:{padding:24,background:"#fff",minHeight:360}},this.props.children)),o.default.createElement(p,{style:{textAlign:"center"}},"Ant Design \xa92018 Created by Ant UED")))}})||u);t.default=D},n5aT:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("jCWc");var r=i(a("kPKH"));a("14J3");var s=i(a("BMrR"));a("5NDa");var n=i(a("5rEg"));a("Pwec");var d=i(a("CtXQ"));a("O3gP");var u=i(a("lrIw")),c=i(a("MVZn"));a("B9cy");var f,h,m=i(a("Ol7k")),p=a("MuoO"),v=i(a("TzGd")),g=i(a("e/J2")),w=(i(a("usdK")),l(a("dNXO"))),y=l(a("uYVn")),C=i(a("wVw7"));m.default.Header,m.default.Footer,m.default.Sider,m.default.Content;function D(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout,o=e.grid,r=o.data,s=o.fwPage;return{loading:e.loading.models.grid,dispatch:a,fwCoord:l,layout:i,fwPage:s,data:r}}var E=e=>{return{getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getSelectData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getSelectData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},saveSelectData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/saveSelectData",payload:{fwCoord:a,fwParam:l,callback:i}})},validDeleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/validDeleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},deleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/deleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},getGridData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getGridData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},loadLayout:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,fwParam:l,callback:i}})}}},b=(f=(0,p.connect)(D,E),f(h=class extends o.Component{constructor(e){super(e),this.onSelectTreeNode=((e,t)=>{e&&t&&(console.info("selected tree node",e),this.setState({selectedTreeNodeId:e,selectedTreeNodeData:t}))}),this.onSearchShopSelect=((e,t)=>{t&&(console.info("select",t.key,e),this.state.components.tree&&this.state.components.tree.onTreeNodeSelected([t.key],{selected:!0}))}),this.editShop=(e=>{this.state.components.tree.handleAction(e,"showEditInTree")}),this.createShop=(e=>{this.state.components.tree.handleAction(e,"showCreateShop")}),this.deleteShop=(e=>{this.state.components.tree.handleAction(e,"deleteTreeNode")}),this.tempLayout=null,this.getLayout=(()=>{return this.tempLayout&&this.tempLayout!=this.props.innerLayout?this.tempLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(e=>{var t=(0,c.default)({},this.props.fwCoord,this.props.innerFwCoord);return e&&Object.keys(e).filter(t=>!!t&&!!e[t]).map(a=>t[a]=e[a]),t}),this.onFormRef=(e=>{this.props.form=e}),this.onComponentRef=((e,t)=>{this.state.components[e]=t}),this.getComponent=(e=>{return this.state.components[e]}),this.state=(0,c.default)({},e,{fwParam:(0,c.default)({},e.fwParam),buttonSize:e.buttonSize?e.buttonSize:"default",tableSize:e.tableSize?e.tableSize:"middle",showSelectCol:!!e.showSelectCol&&e.showSelectCol,dialogs:{},components:{},actionInList:[],treeFwCoord:(0,c.default)({},this.getFwCoord()),treeLayout:{isEmpty:!0,actions:[],columns:[],displayActions:[],gotResource:[]},selectedTreeNodeId:null,selectedTreeNodeData:{},gridFwCoord:(0,c.default)({},this.getFwCoord()),gridLayout:{isEmpty:!0,actions:[],columns:[],displayActions:[]},gridToTreeField:null,gridOtherParams:{},refData:{}});var t=(0,c.default)({},this.getFwCoord()),a=(0,c.default)({},this.getFwCoord()),l=null;this.getLayout().argument&&(this.getLayout().argument.treeFunction&&(t["function"]=this.getLayout().argument.treeFunction),this.getLayout().argument.treeView&&(t.view=this.getLayout().argument.treeView),this.getLayout().argument.gridFunction&&(a["function"]=this.getLayout().argument.gridFunction),this.getLayout().argument.gridView&&(a.view=this.getLayout().argument.gridView),l=this.getLayout().argument.gridToTreeField),this.props.loadLayout({fwCoord:t,fwParam:{},callback:e=>{this.setState({treeLayout:e,treeFwCoord:t})}}),this.props.loadLayout({fwCoord:a,fwParam:{},callback:e=>{this.setState({gridLayout:e,gridFwCoord:a,gridToTreeField:l})}})}componentWillReceiveProps(e){}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this)}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e={id:"SHOP_ID",valueRef:{function:"shop",view:"select",label:"NAME",value:"SID",otherRefs:"CUSTOMER_ID"}},t=e.valueRef,a=this.state.refData;a[e.id]||(a[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:a}));var l=a[e.id],i=(o.default.createElement(u.default,{style:{width:"100%"},allowClear:!0,placeholder:"\u516c\u53f8\u7b80\u79f0/\u516c\u53f8\u540d\u79f0",optionLabelProp:"value",dataSource:l.data,defaultOpen:l.defaultOpen,onSelect:(e,t)=>this.onSearchShopSelect(e,t),onSearch:e=>{l.timeout&&(clearTimeout(l.timeout),l.timeout=null),l.currentValue=e;var i=()=>{l.loading=!0,this.props.getRefData({fwCoord:(0,c.default)({},this.getFwCoord(),{function:t.function,view:t.view}),fwParam:(0,c.default)({},this.state.fwParam,{queryValue:e,distinct:t.distinct?t.distinct:null,queryColumns:t.value+","+t.label+","+(t.otherRefs?t.otherRefs:""),selectedData:null}),callback:i=>{if(l.currentValue==e){var r={},s=[];i.success&&(s=i.data.map(e=>{return r[e[t.label]]=e,o.default.createElement(u.default.Option,{key:e[t.value],value:e[t.label]},e[t.label])})),console.info("values",i.data),l.dataMap=r,l.data=s,l.loading=!1,l.defaultOpen=!0,l.autoFocus=!0,this.setState({refData:a})}}})};l.timeout=setTimeout(i,900)}},o.default.createElement(n.default,{suffix:o.default.createElement(d.default,{type:"search",className:"certain-category-icon"})})),null),f=null,h=(w.buildGroupMenus(this,C.default,"inShop"),this.state.components.tree?this.state.components.tree.state.treeData:[]),m=[],p=e=>{return e?e.map(e=>{m.push(o.default.createElement(u.default.Option,{key:e.SID},e.NAME)),p(e.children)}):[]};return p(h),o.default.createElement("div",{className:C.default.normal,style:{height:"100%"}},o.default.createElement("div",null,o.default.createElement(s.default,null,f),o.default.createElement(s.default,null,o.default.createElement(r.default,{span:24,style:{textAlign:"left"}},i))),o.default.createElement(s.default,{style:{height:"100%"}},o.default.createElement(r.default,{span:6,style:{height:"100%"}},o.default.createElement(s.default,{style:{height:"100%"}},o.default.createElement(r.default,{style:{padding:10,marginBottom:1,backgroundColor:"#ffffff",height:50}},o.default.createElement(u.default,{dataSource:m,style:{width:"100%"},placeholder:"\u516c\u53f8\u7b80\u79f0/\u516c\u53f8\u540d\u79f0",allowClear:!0,filterOption:(e,t)=>t.props.children.indexOf(e)>=0,onSelect:(e,t)=>this.onSearchShopSelect(e,t)},o.default.createElement(n.default,{suffix:o.default.createElement(d.default,{type:"search",className:"certain-category-icon"})}))),o.default.createElement(r.default,{style:(0,c.default)({backgroundColor:"#ffffff",overflow:"auto"},y.getFillHeight(50))},o.default.createElement(v.default,{innerLayout:this.state.treeLayout,style:{height:"100%"},innerFwCoord:this.state.treeFwCoord,fwParam:{showAsDialog:"1"},onRef:e=>this.onComponentRef("tree",e),showAsDialog:!0,openerSelectedData:this.state.selectedRecord,buttonSize:"small",tableSize:"small",showSelectCol:"checkbox",onSelectTreeNode:(e,t)=>this.onSelectTreeNode(e,t)})))),o.default.createElement(r.default,{span:18,style:{paddingLeft:10,paddingRight:10,height:"100%"}},o.default.createElement("div",{style:{backgroundColor:"#ffffff",height:50,paddingLeft:10,paddingTop:10,marginBottom:1}},o.default.createElement("span",null,o.default.createElement("b",null,"\u95e8\u5e97\u4fe1\u606f")," \xa0\xa0\xa0\xa0\xa0\xa0",o.default.createElement("a",{href:"javascript:;",onClick:e=>this.editShop(e)},"\u7f16\u8f91\u95e8\u5e97\u4fe1\u606f"),"\xa0\xa0\xa0",o.default.createElement("a",{href:"javascript:;",onClick:e=>this.createShop(e)},"\u65b0\u589e\u95e8\u5e97"),"\xa0\xa0\xa0",o.default.createElement("a",{href:"javascript:;",onClick:e=>this.deleteShop(e)},"\u5220\u9664\u95e8\u5e97"))),o.default.createElement(s.default,{style:{backgroundColor:"#ffffff",height:50,paddingLeft:10,paddingTop:10}},o.default.createElement(r.default,{span:2},"ID : ",this.state.selectedTreeNodeData.SID),o.default.createElement(r.default,{span:8},"\u540d\u79f0 : ",this.state.selectedTreeNodeData.NAME),o.default.createElement(r.default,{span:14},"\u5730\u5740 : ",this.state.selectedTreeNodeData.ADDRESS?this.state.selectedTreeNodeData.ADDRESS.split("\u3001").join(""):null)),o.default.createElement("div",{style:(0,c.default)({backgroundColor:"#ffffff"},y.getFillHeight(100))},o.default.createElement(g.default,{innerLayout:this.state.gridLayout,innerFwCoord:this.state.gridFwCoord,fwParam:{showAsDialog:"1"},onRef:e=>this.onComponentRef("grid",e),showAsDialog:!0,openerSelectedData:this.state.selectedRecord,gridToTreeField:"DEPARTMENTID",selectedTreeNodeId:this.state.selectedTreeNodeId,buttonSize:"small",tableSize:"small",showSelectCol:!1,otherParams:this.state.gridOtherParams})))),Object.values(this.state.dialogs))}})||h);t.default=b},nAcz:function(e,t){e.exports="data:;base64,PCFkb2N0eXBlIGh0bWw+DQo8aHRtbD4NCjxoZWFkPg0KICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0iaW5pdGlhbC1zY2FsZT0xLjAsIG1heGltdW0tc2NhbGU9MS4wLCB1c2VyLXNjYWxhYmxlPW5vIj4NCiAgPG1ldGEgbmFtZT0iZm9ybWF0LWRldGVjdGlvbiIgY29udGVudD0idGVsZXBob25lPXllcyIvPg0KICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCIgLz4NCiAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwOi8vYXBpLm1hcC5iYWlkdS5jb20vbGlicmFyeS9EcmF3aW5nTWFuYWdlci8xLjQvc3JjL0RyYXdpbmdNYW5hZ2VyX21pbi5jc3MiIC8+DQogIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBzcmM9Imh0dHA6Ly9hcGkubWFwLmJhaWR1LmNvbS9hcGk/dj0zLjAmYWs9dTJ2WjlmVDdsSXpiZ0drQlRsRlF1NFk2Ij48L3NjcmlwdD4NCiAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iaHR0cDovL2FwaS5tYXAuYmFpZHUuY29tL2xpYnJhcnkvRHJhd2luZ01hbmFnZXIvMS40L3NyYy9EcmF3aW5nTWFuYWdlcl9taW4uanMiPjwvc2NyaXB0Pg0KICA8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJodHRwOi8vYXBpLm1hcC5iYWlkdS5jb20vbGlicmFyeS9UZXh0SWNvbk92ZXJsYXkvMS4yL3NyYy9UZXh0SWNvbk92ZXJsYXlfbWluLmpzIj48L3NjcmlwdD4NCgk8c2NyaXB0IHR5cGU9InRleHQvamF2YXNjcmlwdCIgc3JjPSJodHRwOi8vYXBpLm1hcC5iYWlkdS5jb20vbGlicmFyeS9NYXJrZXJDbHVzdGVyZXIvMS4yL3NyYy9NYXJrZXJDbHVzdGVyZXJfbWluLmpzIj48L3NjcmlwdD4NCiAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiIHNyYz0iaHR0cDovL3Jlcy53eC5xcS5jb20vb3Blbi9qcy9qd2VpeGluLTEuNC4wLmpzIj48L3NjcmlwdD4NCiAgPHN0eWxlPg0KICAgIGh0bWwsYm9keSB7DQogICAgICAgIG1hcmdpbjogMDsNCiAgICAgICAgcGFkZGluZzogMDsNCiAgICAgICAgd2lkdGg6IDEwMCU7DQogICAgICAgIGhlaWdodDogMTAwJTsNCiAgICAgICAgZm9udC1mYW1pbHk6IFBpbmdGYW5nU0M7DQogICAgfS8q6L+Z6YeM5piv5YWz6ZSuKi8NCiAgICBkaXYgLmFudC10YWJzLWNvbnRlbnQgew0KICAgICAgaGVpZ2h0OjEwMCU7DQogICAgfQ0KICAgIGRpdiAuYW50LXRhYnMtdGFiIHsNCiAgICAgIGhlaWdodDoxMDAlOw0KICAgIH0NCiAgICBkaXYgLmFudC10YWJzLXRhYnBhbmUgew0KICAgICAgaGVpZ2h0OjEwMCU7DQogICAgfQ0KICAgIGRpdiAuYW50LXNwaW4tbmVzdGVkLWxvYWRpbmcgew0KICAgICAgaGVpZ2h0OiAxMDAlOw0KICAgIH0NCiAgICBkaXYgLmFudC1zcGluLWNvbnRhaW5lciB7DQogICAgICBoZWlnaHQ6IDEwMCU7DQogICAgfQ0KICAgIC5hbnQtcmFkaW8tZ3JvdXB7DQogICAgICB3aWR0aDoxMDAlOw0KICAgIH0NCiAgICAjbWFpbkluY29tZSAuYW50LXJhZGlvLWJ1dHRvbi13cmFwcGVyOmZpcnN0LWNoaWxkIHsNCiAgICAgIHdpZHRoOjE1JTsNCiAgICB9DQoNCiAgICAjbWFpbkluY29tZSAuYW50LXJhZGlvLWJ1dHRvbi13cmFwcGVyOm50aC1jaGlsZCgyKSB7DQogICAgICB3aWR0aDoxNSU7DQogICAgfQ0KDQogICAgI21haW5JbmNvbWUgLmFudC1yYWRpby1idXR0b24td3JhcHBlcjpudGgtY2hpbGQoMykgew0KICAgICAgd2lkdGg6MjUlOw0KICAgIH0NCg0KICAgICNtYWluSW5jb21lIC5hbnQtcmFkaW8tYnV0dG9uLXdyYXBwZXI6bnRoLWNoaWxkKDQpIHsNCiAgICAgIHdpZHRoOjI1JTsNCiAgICB9DQoNCiAgICAjbWFpbkluY29tZSAuYW50LXJhZGlvLWJ1dHRvbi13cmFwcGVyOm50aC1jaGlsZCg1KSB7DQogICAgICB3aWR0aDoyMCU7DQogICAgfQ0KDQogICAgI3dvcmtiZW5jaFRvZG9BbmRSZW1pbmQgLmFudC1yYWRpby1idXR0b24td3JhcHBlciB7DQogICAgICB3aWR0aDo1MCU7DQogICAgfSANCiAgICANCiAgICAjdG9kb0FuZFJlbWluZCAuYW50LXRhYmxlLXNtYWxsIHsNCiAgICAgIGJvcmRlcjpub25lOw0KICAgIH0NCg0KICAgIC5zZWxlY3RlZFJlbWluZCB7DQogICAgICAgIGJhY2tncm91bmQtY29sb3I6ICM0MzZCRjc7DQogICAgICAgIGNvbG9yOndoaXRlOw0KICAgIH0NCiAgICANCiAgICAjREVWSUNFX05PUyAuYW50LXNlbGVjdC1zZWxlY3Rpb24gew0KICAgICAgbWluLWhlaWdodDogMTAwcHg7DQogICAgfQ0KICA8L3N0eWxlPg0KICA8dGl0bGU+TG9hZGluZy4uLjwvdGl0bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCiAgPGRpdiBpZD0icm9vdCIgc3R5bGU9ImhlaWdodDogMTAwJTsiPjwvZGl2Pg0KPC9ib2R5Pg0KDQo8L2h0bWw+"},pM3X:function(e,t,a){"use strict";var l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.logic=i;l(a("uYVn"));function i(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,this.view.getGridData({})}},qx2S:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("+L6B");var r=i(a("2/Rp"));a("DjyN");var s=i(a("NUBc"));a("g9YV");var n=i(a("wCAj"));a("14J3");var d=i(a("BMrR"));a("7Kak");var u=i(a("9yH6"));a("jCWc");var c=i(a("kPKH"));a("qVdP");var f=i(a("jsC+"));a("lUTK");var h=i(a("BvKs"));a("Pwec");var m=i(a("CtXQ"));a("miYZ");var p=i(a("tsqr")),v=i(a("MVZn"));a("B9cy");var g,w,y=i(a("Ol7k")),C=a("MuoO"),D=(i(a("usdK")),l(a("dNXO"))),E=l(a("uYVn")),b=i(a("+B/R")),S=i(a("wVw7")),L=i(a("e/J2")),P=(y.default.Header,y.default.Footer,y.default.Sider),k=y.default.Content;function I(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout,o=e.grid,r=o.data,s=o.fwPage;return{loading:e.loading.models.grid,dispatch:a,fwCoord:l,layout:i,fwPage:s,data:r}}var R=e=>{return{getCreateData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"create/getCreateData",payload:{fwCoord:a,fwParam:l,callback:i}})},getSelectData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.callback;e({type:"grid/getSelectData",payload:{fwPage:a,fwParam:l,fwCoord:i,callback:o}})},saveSelectData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/saveSelectData",payload:{fwCoord:a,fwParam:l,callback:i}})},validDeleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/validDeleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},deleteData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"grid/deleteData",payload:{fwCoord:a,fwParam:l,callback:i}})},getGridData:t=>{var a=t.fwPage,l=t.fwParam,i=t.fwCoord,o=t.otherParams,r=t.callback;e({type:"grid/getGridData",payload:{fwPage:a,fwParam:l,fwCoord:i,otherParams:o,callback:r}})},loadLayout:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,fwParam:l,callback:i}})}}},T=(g=(0,C.connect)(I,R),g(w=class extends o.Component{constructor(e){super(e),this.getSelectData=(e=>{var t=e.fwPage,a=e.fwParam,l=e.fwCoord,i=(0,v.default)({},this.state.fwParam,{openerSelectedData:(0,v.default)({},this.props.openerSelectedData)},a);this.props.getSelectData({fwPage:(0,v.default)({},this.state.fwPage,t),fwParam:i,fwCoord:(0,v.default)({},this.getFwCoord(),l),callback:e=>{this.setState({fwPage:e.page,data:e.data})}})}),this.getGridData=(e=>{var t=e.fwPage,a=e.fwParam,l=e.fwCoord,i=e.otherParams;console.info("getGridData",JSON.stringify(this.state.otherParams));var o=(0,v.default)({},this.state.fwParam,{selectedTreeNodeId:this.props.selectedTreeNodeId?this.props.selectedTreeNodeId:null,treeConnectColumn:this.props.gridToTreeField?this.props.gridToTreeField:null},a);this.props.getGridData({otherParams:(0,v.default)({},this.state.otherParams,i),fwPage:(0,v.default)({},this.state.fwPage,t),fwParam:o,fwCoord:(0,v.default)({},this.getFwCoord(),l),callback:e=>{this.setState({fwPage:e.page,data:e.data}),this.onTableRowClick(e.data.length>0?e.data[0]:null)}})}),this.pageChangeHandler=function(e,t){this.getGridData({fwPage:{pageNumber:e,pageSize:t}})},this.OP_COL={title:"Operation",dataIndex:"_FW_ACTIONS",render:(e,t,a)=>o.default.createElement("span",{className:S.default.operation},(this.getLayout().otherActions["inList"]?this.getLayout().otherActions["inList"]:[]).filter(e=>1==e.visible).map((e,l)=>{return e.fw_index=l,this.getActionEntry(e.click).layout(this,e.id,t,a)}))},this.onTableRowClick=function(e){if(null!=e){if(null==this.state.selectedRowKeys||0==this.state.selectedRowKeys.length||this.state.selectedRowKeys[0]!=e.fw_index){var t=this.state.components;t.rightList,t.selectRole;if(this.setState({selectedRecord:e,selectedRowKeys:[e.fw_index]},()=>{this.state.selectRoleLayout.isEmpty||this.getComponent("selectRole").getSelectData({selectedData:e})}),this.props.loadLayout({fwCoord:(0,v.default)({},this.getFwCoord(),{function:"rights",view:"rightList"}),fwParam:{openerSelectedData:e},callback:e=>{this.convertChildrenToNodes(e.gotResource),this.setState({rightListLayout:e})}}),this.state.selectRoleLayout.isEmpty){var a={openerFunction:this.getFwCoord()["function"],openerView:this.getFwCoord()["view"],openerActionId:"showRole",openerSelectedData:e,showAsDialog:1};this.props.loadLayout({fwCoord:(0,v.default)({},this.getFwCoord(),{function:"role",view:"select"}),fwParam:a,callback:e=>{this.setState({selectRoleLayout:e})}})}}}else this.setState({selectedRecord:null})},this.convertChildrenToNodes=(e=>{e&&Array.isArray(e)&&e.map((e,t)=>{e.nodes=e.children,delete e.children,this.convertChildrenToNodes(e.nodes)})}),this.onRoleTypeChange=(e=>{console.info(e.target);var t=this.state.clientNewDataTemplate;t["ROLE_TYPE"]=e.target.value;var a=(0,v.default)({},this.state.fwParam,{queryType:e.target.value});this.setState({clientNewDataTemplate:t,fwParam:a,selectedRowKeys:[]},this.getGridData({fwParam:a}))}),this.saveRoleRight=(e=>{console.info(this.state.components);var t=this.state.components,a=t.rightList,l=t.selectRole;a.getActionEntry("saveRightList").logic(a,"saveSelect",null,-1,e,t=>{t.success?(t.errorMsg&&p.default.info(t.errorMsg),D.getActionEntry(l,"saveSelect").logic(l,"saveSelect",null,-1,e)):E.isEmpty(t.errorMsg)?p.default.error("\u4fdd\u5b58\u5931\u8d25"):p.default.error(t.errorMsg,10)})}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,v.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.onComponentRef=((e,t)=>{this.state.components[e]=t}),this.getComponent=(e=>{return this.state.components[e]}),this.getActionEntry=function(e){return D.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.state=(0,v.default)({},e,{fwParam:(0,v.default)({},e.fwParam,{queryType:"0"}),otherParams:{},buttonSize:e.buttonSize?e.buttonSize:"small",tableSize:e.tableSize?e.tableSize:"middle",showSelectCol:e.showSelectCol?e.showSelectCol:"radio",selectedRecord:null,selectedRowKeys:[],queryPanelExpanded:!1,dialogs:{},components:{},actionInList:[],rightListFwCoord:(0,v.default)({},this.props.fwCoord,{function:"rights",view:"rightList"}),rightListLayout:{actions:[],columns:[],displayActions:[],gotResource:[]},selectRoleFwCoord:(0,v.default)({},this.getFwCoord(),{function:"role",view:"select"}),selectRoleLayout:{isEmpty:!0,actions:[],columns:[],displayActions:[]},clientNewDataTemplate:{}})}componentWillReceiveProps(e){if(e.openerSelectedData||e.innerLayout||e.innerFwCoord||e.selectedTreeNodeId||e.otherParams){if(e.openerSelectedData!=this.props.openerSelectedData||e.innerLayout!=this.props.innerLayout||e.innerFwCoord!=this.props.innerFwCoord){console.info("grid receive props2",e);var t=e.innerLayout?e.innerLayout:this.getLayout();this.state.innerLayout=t,this.state.innerFwCoord=e.innerFwCoord,t.onQuery&&this.getActionEntry(t.onQuery).logic(this,t.onQuery,null,-1,null)}e.selectedTreeNodeId!=this.props.selectedTreeNodeId&&this.getGridData({fwParam:{selectedTreeNodeId:e.selectedTreeNodeId}}),e.otherParams!=this.props.otherParams&&this.getGridData({otherParams:e.otherParams})}}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.getLayout().onQuery&&this.getActionEntry(this.getLayout().onQuery).logic(this,this.getLayout().onQuery,null,-1,null)}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){D.buildGridMenus(this,S.default);var e=o.default.createElement(h.default,{onClick:e=>this.handleAction(e)},this.getLayout().actions.filter(e=>["showCreateInList","showCopyRole","deleteList"].indexOf(e.id)>=0).map(e=>o.default.createElement(h.default.Item,{key:e.id},o.default.createElement(m.default,{type:e.icon}),e.label))),t=o.default.createElement(f.default,{overlay:e},o.default.createElement(m.default,{type:"down"}));D.buildGridQueryArea(this);return o.default.createElement("div",{className:S.default.normal,style:{height:"100%"}},o.default.createElement(y.default,{style:{height:"100%"}},o.default.createElement(P,{width:400,style:{overflow:"auto",backgroundColor:"#ffffff",height:"100%"}},o.default.createElement("div",{style:{width:"95%",margin:"10px"}},o.default.createElement(d.default,null,o.default.createElement(c.default,{span:6}),o.default.createElement(c.default,{span:12,style:{textAlign:"center"}},o.default.createElement(u.default.Group,{defaultValue:this.state.fwParam.queryType,value:this.state.fwParam.queryType,buttonStyle:"solid",onChange:e=>this.onRoleTypeChange(e)},Object.keys(this.getLayout().dictMap["ROLE_TYPE"]).map(e=>o.default.createElement(u.default.Button,{key:e,value:e},this.getLayout().dictMap["ROLE_TYPE"][e])))),o.default.createElement(c.default,{span:6,style:{textAlign:"center"}},t))),o.default.createElement("div",{className:"search-result-list"},o.default.createElement(n.default,{loading:this.props.loading,columns:this.getLayout().columns.filter(e=>e.visible&&"_FW_ACTIONS"!=e.id).map(e=>{return"_FW_ACTIONS"==e.id?(this.OP_COL.title=e.label,this.OP_COL):(e.title=e.label,e.dataIndex=e.id,e.showColumn&&(e.render=((t,a,l)=>e.showColumn.split(",").map(e=>a[e]).join(" "))),e)}),dataSource:this.state.data,pagination:!1,rowKey:"fw_index",size:this.state.tableSize,bordered:!0,rowSelection:{type:"radio",selectedRowKeys:this.state.selectedRowKeys},onRow:e=>{return{onClick:()=>this.onTableRowClick(e),onMouseEnter:()=>{}}}}),o.default.createElement(s.default,{className:"ant-table-pagination",style:{margin:"15px"},size:"small",showTotal:(e,t)=>`\u5171\u8ba1 ${e} \u6761\u8bb0\u5f55`,showSizeChanger:!0,total:this.state.fwPage.totalRow,current:this.state.fwPage.pageNumber,pageSize:this.state.fwPage.pageSize,onChange:(e,t)=>this.pageChangeHandler(e,t),onShowSizeChange:(e,t)=>this.pageChangeHandler(e,t)}))),o.default.createElement(k,{style:{marginLeft:"20px",height:"100%",backgroundColor:"#ffffff"}},o.default.createElement(d.default,{style:{padding:10}},o.default.createElement(c.default,{span:18,style:{fontSize:18}},o.default.createElement("b",null,"\u89d2\u8272\u6743\u9650")),o.default.createElement(c.default,{span:6,style:{textAlign:"right",paddingRight:"20px",paddingTop:"10px"}},this.state.selectedRecord?o.default.createElement(r.default,{type:"primary",onClick:e=>this.saveRoleRight(e)},"\u4fdd\u5b58"):null)),o.default.createElement(d.default,{style:{height:"88%"}},o.default.createElement(c.default,{span:12,style:{padding:"10px",height:"100%"}},"ddb.gpswv.com"==location.hostname?"\u5230\u5e97\u4fdd":"\u8f66\u5546\u500d\u76c8","\u5e73\u53f0\u2014\u2014","1"==this.state.fwParam.queryType?"\u7ba1\u7406\u5458":"\u8f66\u5546","\u7aef\u6743\u9650",o.default.createElement("div",{style:{height:"100%",overflow:"auto"}},o.default.createElement(b.default,{innerLayout:this.state.rightListLayout,innerFwCoord:this.state.rightListFwCoord,fwParam:{openerFunction:this.getFwCoord()["function"],openerView:this.getFwCoord().view,openerActionId:"showRightList",showAsDialog:"1"},onRef:e=>this.onComponentRef("rightList",e),showAsDialog:!0,openerSelectedData:this.state.selectedRecord}))),this.state.selectedRecord?o.default.createElement(c.default,{span:12,style:{padding:"10px"}},"\u53ef\u5206\u914d\u89d2\u8272\uff1a",o.default.createElement(L.default,{innerLayout:this.state.selectRoleLayout,innerFwCoord:this.state.selectRoleFwCoord,fwParam:{openerFunction:this.getFwCoord()["function"],openerView:this.getFwCoord().view,openerActionId:"showRole",showAsDialog:"1"},onRef:e=>this.onComponentRef("selectRole",e),showAsDialog:!0,openerSelectedData:this.state.selectedRecord,buttonSize:"small",tableSize:"small",showSelectCol:"checkbox"})):null))),Object.values(this.state.dialogs))}})||w);t.default=T},r0dD:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("jCWc");var r=i(a("kPKH"));a("14J3");var s=i(a("BMrR"));a("DZo9");var n=i(a("8z0m"));a("miYZ");var d=i(a("tsqr"));a("giR+");var u=i(a("fyUT"));a("Xi6J");var c=i(a("kl6h"));a("iQDF");var f=i(a("+eQT"));a("O3gP");var h=i(a("lrIw"));a("6UJt");var m=i(a("DFOY"));a("nRaC");var p=i(a("5RzL"));a("T2oS");var v=i(a("W9HT")),g=i(a("pVnL")),w=i(a("MVZn"));a("sRBo");var y=i(a("kaz8"));a("7Kak");var C=i(a("9yH6"));a("OaEy");var D=i(a("2fM7"));a("5NDa");var E=i(a("5rEg"));a("y8nQ");var b=i(a("Vl3Y"));a("ozfa");var S,L,P=i(a("MJZm")),k=a("MuoO"),I=(i(a("QCDS")),l(a("uYVn"))),R=l(a("dNXO")),T=i(a("wd/R"));a("XDpg"),T.default.locale("zh-cn");var A=P.default.TreeNode,_=b.default.Item,O=E.default.TextArea,M=D.default.Option,F=C.default.Group,N=y.default.Group,j={labelCol:{xs:{span:8},sm:{span:8}},wrapperCol:{xs:{span:16},sm:{span:16}}};function V(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{loading:e.loading.models.edit,dispatch:a,fwCoord:l,layout:i}}var x=e=>{return{getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},getRefData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.otherParams,o=t.callback;e({type:"edit/getRefData",payload:{fwCoord:a,fwParam:l,otherParams:i,callback:o}})},getTreeData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"tree/getTreeData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})}}},z=(S=(0,k.connect)(V,x),S(L=class extends o.Component{constructor(e){super(e),this.loadCascaderData=((e,t)=>{var a=e[e.length-1];a.loading=!0;var l=t.valueRef,i=e=>{return e?e.map(e=>{return e.value=e[l.value],e.label=e[l.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e.children&&(e.children=i(e.children)),e}):null};this.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:l.function,view:l.view}),fwParam:{distinct:l.distinct?l.distinct:null,queryColumns:l.value+","+l.label+","+(l.otherRefs?l.otherRefs:""),selectedTreeNodeId:e.map(e=>e[l.value]).join(",")},callback:e=>{a.loading=!1,a.children=i(e.data),this.setState({refData:this.state.refData})}})}),this.getTreeData=(e=>{var t=e.fwParam,a=e.fwCoord,l=e.callback,i=(0,w.default)({},this.state.fwParam,{openerSelectedData:(0,w.default)({},this.props.openerSelectedData)},t);this.props.getTreeData({fwParam:i,fwCoord:(0,w.default)({},this.getFwCoord(),a),callback:l||(e=>{this.setState({treeData:e.data,expandedKeys:e.data.map(e=>String(e[this.getLayout().argument.treeIdField]))})})})}),this.renderTreeNodes=((e,t)=>e?e.map(e=>o.default.createElement(A,{title:e[t.label],key:String(e[t.value]),value:e[t.value],isLeaf:!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,dataRef:e},this.renderTreeNodes(e.children,t))):null),this.onTreeSelectLoadData=((e,t,a)=>new Promise(l=>{console.info("treeNode.props",e);var i=e.props.dataRef;i.children?l():(console.info("realData",i),this.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:t.valueRef.function,view:t.valueRef.view}),fwParam:{distinct:t.valueRef.distinct?t.valueRef.distinct:null,queryColumns:t.valueRef.value+","+t.valueRef.label+","+(t.valueRef.otherRefs?t.valueRef.otherRefs:""),selectedTreeNodeId:e.props.eventKey},callback:e=>{i.children=e.data,a.defaultOpen=!0,l(),this.setState({refData:this.state.refData})}}))})),this.onCascaderChange=((e,t,a)=>{if(console.info("onCascaderChange",e.id,t,a),"ADDRESS_SELECT"==e.id){var l=this.state,i=l.fwParam,o=l.formData,r=l.manualValues;i.newData||(i.newData={}),i.newData[e.id]=t.join(","),o[e.id]||(o[e.id]={}),o[e.id].value=t.join(","),r[e.id]=t,this.setState({fwParam:i,manualValues:r,formData:o})}}),this.onAutoCompleteSelect=((e,t,a)=>{console.info("onAutoCompleteSelect",e.id,t,a)}),this.onSelectChange=((e,t,a)=>{console.info("onSelectChange",e.id,t,a)}),this.onSelectSelect=((e,t,a)=>{console.info("onSelectSelect",e.id,t,a)}),this.buildDeviceNoList=(()=>{return Object.keys(this.state.totalInputDevices).map(e=>o.default.createElement(M,{key:e},e))}),this.MONEY_IDS={},this.getInputComponent=((e,t)=>{var a=this.state,l=a.components,i=a.refData,r=a.fwParam,s=a.formData,b=null,S={disabled:!e.editable,style:{width:"90%"}};t&&(S.value=this.state.manualValues[e.id]);var L="",P="";if(e.editable&&(L=e.prompt?e.prompt:"\u8bf7\u8f93\u5165",P=e.prompt?e.prompt:"\u8bf7\u9009\u62e9"),"DEVICE_NOS"==e.id)b=o.default.createElement(D.default,(0,g.default)({},S,{style:(0,w.default)({},S.style,{minHeight:100}),mode:"tags",placeholder:"\u8bf7\u8f93\u5165\u8bbe\u5907\u53f7\uff0c\u4e00\u884c\u4e00\u4e2a",tokenSeparators:["\n","\r"," ",","],dropdownStyle:{display:"none"}}),this.buildDeviceNoList());else if("label"==e.ui)b=this.getDisplayValue(e);else if("MEMO"===e.type)b=o.default.createElement(O,(0,g.default)({},S,{rows:4}));else if("checkbox01"===e.ui)b=o.default.createElement(y.default,{disabled:!e.editable});else if(e.dictionary&&this.getLayout().dictList[e.dictionary]){var k=this.getLayout().dictList[e.dictionary];if("radio"==e.ui)b=o.default.createElement(F,(0,g.default)({name:e.id},S),k.map(e=>o.default.createElement(C.default,{key:e.value,value:String(e.value)},e.label)));else if("checkbox"==e.ui){var R=k;b=o.default.createElement(N,(0,g.default)({name:e.id},S,{options:R}))}else b=o.default.createElement(D.default,S,k.map(e=>o.default.createElement(M,{key:e.value,value:e.value},e.label)))}else if("TreeSelect"===e.ui&&e.valueRef){var T=e.valueRef;if(!i[e.id]){var A=null;T.function==this.props.fwParam.openerFunction&&T.view==this.props.fwParam.openerView&&this.props.treeData&&(A=this.props.treeData),i[e.id]={loading:!1,data:A,queryIndex:0,defaultOpen:!1}}var _=i[e.id];_.data||(_.data=[],this.props.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:T.function,view:T.view}),fwParam:{distinct:T.distinct?T.distinct:null,queryColumns:T.value+","+T.label+","+(T.otherRefs?T.otherRefs:"")},callback:t=>{t.success?(_.data=t.data,console.info("result.data",_.data),_.loading=!1,i[e.id]=_,this.setState({refData:i})):_.data=null}})),b=o.default.createElement(p.default,(0,g.default)({},S,{placeholder:P,notFoundContent:_.loading?o.default.createElement(v.default,{size:"small"}):null,showArrow:!0,showSearch:!0,searchPlaceholder:"\u8f93\u5165\u641c\u7d22",filterTreeNode:(e,t)=>{return console.info("treeNode",t),t.props.title.indexOf(e)>=0},treeNodeFilterProp:"title",filterOption:!1,labelInValue:!1,loadData:t=>this.onTreeSelectLoadData(t,e,_),treeExpandedKeys:_.expandedKeys?_.expandedKeys:_.data.map(e=>String(e[T.value])),onTreeExpand:e=>{_.expandedKeys=e,_.defaultOpen=!0,this.setState({refData:this.state.refData})},defaultOpen:_.defaultOpen,onSearch1:t=>{_.timeout&&(clearTimeout(_.timeout),_.timeout=null),_.currentValue=t;var a=()=>{console.info(t),_.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:T.function,view:T.view}),fwParam:{queryStr:t,distinct:T.distinct?T.distinct:null,queryColumns:T.value+","+T.label+","+(T.otherRefs?T.otherRefs:"")},callback:a=>{_.currentValue==t&&(_.data=a.data,_.loading=!1,_.defaultOpen=!0,s[e.id].value=t,this.setState({refData:i,fwParam:r,formData:s}))}})};_.timeout=setTimeout(a,500)},onChange:e=>{console.info("onChange",e)}}),this.renderTreeNodes(_.data,T))}else if("Cascader"==e.ui&&e.valueRef){var j=e.valueRef;if(!i[e.id]){var V={};V[j.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),V[j.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var x=i[e.id];x.data||(x.data=[],this.props.getTreeData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:j.function,view:j.view}),fwParam:{distinct:j.distinct?j.distinct:null,queryColumns:j.value+","+j.label+","+(j.otherRefs?j.otherRefs:"")},callback:t=>{t.success?(x.data=t.data.map(e=>{return e.value=e[j.value],e.label=e[j.label],e.isLeaf=!e.GOT_SUBCOUNT||e.GOT_SUBCOUNT<1,e}),x.loading=!1,i[e.id]=x,this.setState({refData:i})):x.data=null}})),b=o.default.createElement(m.default,(0,g.default)({},S,{placeholder:P,options:x.data,loadData:t=>this.loadCascaderData(t,e),onChange:(t,a)=>this.onCascaderChange(e,t,a),showSearch:{filter:(e,t)=>{return t.some(t=>t.label.toLowerCase().indexOf(e.toLowerCase())>-1)}}}))}else if("AutoComplete"==e.ui&&e.valueRef){var z=e.valueRef;i[e.id]||(i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i}));var Y=i[e.id];b=o.default.createElement(h.default,(0,g.default)({},S,{placeholder:L,dataSource:Y.data,defaultOpen:Y.defaultOpen,onSelect:(t,a)=>this.onAutoCompleteSelect(e,t,a),onSearch:e=>{Y.timeout&&(clearTimeout(Y.timeout),Y.timeout=null),Y.currentValue=e;var t=()=>{Y.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:z.function,view:z.view}),fwParam:(0,w.default)({},this.state.fwParam,{queryValue:e,distinct:z.distinct?z.distinct:null,queryColumns:z.value+","+z.label+","+(z.otherRefs?z.otherRefs:"")}),callback:t=>{if(Y.currentValue==e){var a={};t.success&&t.data.map(e=>{a[e[z.label]]=e}),Y.dataMap=a,Y.data=Object.keys(a),Y.loading=!1,Y.defaultOpen=!0,Y.autoFocus=!0,this.setState({refData:i,fwParam:r})}}})};Y.timeout=setTimeout(t,900)}}))}else if(null!=e.valueRef){var G=e.valueRef;if(!i[e.id]){var q={};q[G.value]=s[e.id]?s[e.id].value:0,e.showColumn&&s[e.showColumn]&&(console.info("showcolumn",e.showColumn,s),q[G.label]=s[e.showColumn].value),i[e.id]={loading:!1,data:null,queryIndex:0,defaultOpen:!1},this.setState({refData:i})}var U=i[e.id];U.data||(U.data=[],this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:G.function,view:G.view}),fwParam:{distinct:G.distinct?G.distinct:null,queryColumns:G.value+","+G.label+","+(G.otherRefs?G.otherRefs:"")},callback:t=>{var a,l=[],o={};(t.success&&(l=t.data,l&&l.map(e=>o[e[G.value]]=e)),e.showColumn)&&function(){console.info("showColumn",s[e.showColumn],s[e.id]);var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],i=s[e.id]&&s[e.id].value?s[e.id].value.split(","):[],o=null;if(i.length>0&&t.length==i.length)for(a=0;a<i.length;++a)l.some(e=>e[G.value]==i[a])||(o={},o[G.value]=i[a],o[G.label]=t[a],l.push(o))}();U.data=l,U.dataMap=o,U.loading=!1,i[e.id]=U,this.setState({refData:i,formData:s})}}));var B=U.data.map(e=>o.default.createElement(M,{key:e[G.value]},e[G.label],G.otherRefs?G.otherRefs.split(",").map(t=>{e[t]}):""));b=o.default.createElement(D.default,(0,g.default)({},S,{placeholder:P,showSearch:!0,mode:e.multiSelect?"multiple":null,notFoundContent:U.loading?o.default.createElement(v.default,{size:"small"}):null,showArrow:!0,filterOption:!1,labelInValue:!0,autoFocus:U.autoFocus,defaultOpen:U.defaultOpen,onSelect:(t,a)=>this.onSelectSelect(e,t,a),onChange:(t,a)=>this.onSelectChange(e,t,a),onSearch:t=>{U.timeout&&(clearTimeout(U.timeout),U.timeout=null),U.currentValue=t;var a=()=>{U.loading=!0,this.props.getRefData({fwCoord:(0,w.default)({},this.getFwCoord(),{function:G.function,view:G.view}),fwParam:{queryValue:t,distinct:G.distinct?G.distinct:null,queryColumns:G.value+","+G.label+","+(G.otherRefs?G.otherRefs:"")},callback:a=>{if(U.currentValue==t){var l,o=[],r={};if(a.success&&(o=a.data,o&&o.map(e=>r[e[G.value]]=e)),e.showColumn)(function(){var t=s[e.showColumn]&&s[e.showColumn].value?s[e.showColumn].value.split(","):[],a=s[e.id]&&s[e.id]?String(s[e.id].value).split(","):[],i=null;if(a.length>0&&t.length==a.length)for(l=0;l<a.length;++l)o.some(e=>e[G.value]==a[l])||(i={},i[G.value]=a[l],i[G.label]=t[l],o.push(i))})();U.data=o,U.dataMap=r,U.loading=!1,U.defaultOpen=!0,U.autoFocus=!0,this.setState({refData:i})}}})};U.timeout=setTimeout(a,500)}}),B)}else if("DatePicker"===e.ui){var K=()=>!1;K=(t=>{var a=!1;return e.min&&t&&t<I.getRealDate(e.min).startOf("day")&&(a=!0),a||e.max&&t&&t>I.getRealDate(e.max).endOf("day")&&(a=!0),a}),b=o.default.createElement(f.default,(0,g.default)({},S,{disabledDate:e=>K(e),placeholder:P}))}else if("TimePicker"===e.ui)b=o.default.createElement(c.default,S);else if("InputNumber"===e.ui)b=o.default.createElement(u.default,(0,g.default)({},S,{placeholder:L}));else if("Upload"===e.ui){var W=(0,w.default)({},this.getFwCoord(),{view:"create"}),H={openerActionId:e.id,openerFunction:this.getFwCoord()["function"],openerView:this.getFwCoord().view,selectedData:(0,w.default)({},this.state.selectedShop,{children:null}),oldData:{},newData:{}},X=this.objectToFormInputs({fwCoord:W,fwParam:H},null,null),Z={name:e.id+"_importFile",action:"/fw/importData?fwCoord.project="+this.getFwCoord().project+"&",data:X,onChange(t){if(this.view.setState({loading:!0,uploadResult:null}),t.file.status,"done"===t.file.status){var a=t.file.response;this.view.setState({uploadedFile:t.file.name,uploadResult:null,loading:!1}),a.success?(r.connectFilePath=a.connectFilePath,this.view.setState({fwParam:r}),d.default.info("\u6587\u4ef6\u6821\u9a8c\u901a\u8fc7")):a.connectFilePath?this.view.setState({uploadResult:o.default.createElement("span",{dangerouslySetInnerHTML:{__html:'<font color="#ff0000"><a href="/fw/download?fileName='+a.connectFilePath+'" target="_blank">\u4e0a\u4f20\u6587\u4ef6\u6709\u8bef\uff0c\u70b9\u6b64\u4e0b\u8f7d\u660e\u7ec6</a></font>'}})}):a.errorMsg&&d.default.error(a.errorMsg,10)}else"error"===t.file.status&&(this.view.setState({loading:!1}),d.default.error(`${e.label}\u5bfc\u5165\u9519\u8bef`,10))}};Z.view=this,b=o.default.createElement(n.default,(0,g.default)({},S,Z,{showUploadList:!1,style:{marginLeft:10},disabled:this.state.uploadDisabled}),o.default.createElement("a",{href:"javascript:;"},this.state.uploadedFile?this.state.uploadedFile:this.state.uploadDisabled?"\u8bf7\u5148\u9009\u62e9\u95e8\u5e97":"\u70b9\u6b64\u4e0a\u4f20"))}else"MAP"==e.ui?(console.info("col.ui",e.ui),b=o.default.createElement(E.default,(0,g.default)({},S,{type:e.ui?e.ui:"text",placeholder:e.prompt?e.prompt:"\u8bf7\u5728\u5730\u56fe\u4e0a\u9009\u62e9"+e.label,onClick:t=>this.selectPointInMap(e.id)}))):e.showColumn;return b||(b=o.default.createElement(E.default,(0,g.default)({},S,{type:e.ui?e.ui:"text",placeholder:L}))),l[e.id]=b,b}),this.normFile=(e=>{return console.log("Upload event:",e),Array.isArray(e)?e:e&&e.file&&e.file.response?e.file.response.success?e&&e.fileList:null:e&&e.fileList}),this.objectToFormInputs=function(e,t,a){var l,i=t||{};if(Array.isArray(e))e.map((e,t)=>this.objectToFormInputs(e,i,(a||"")+"["+t+"]"));else for(var o in e)if(e.hasOwnProperty(o)){var r=Array.isArray(e)?"[]":`[${o}]`;l=a?a+r:o,"object"!==typeof e[o]||e[o]instanceof File?i[l]=new String(e[o]).replace(/%/g,"%25").replace(/\&/g,"%26").replace(/\+/g,"%2B").replace(/\=/g,"%3D"):this.objectToFormInputs(e[o],i,l)}return i},this.selectPointInMap=(e=>{var t=this.state.formData,a=this.getLayout().columnMap[e],l=a.showColumn.split(",");console.info("param",l,t),this.state.map.selectPoint({id:e,lat:t[l[0]].value,lng:t[l[1]].value,name:a.label,callback:(e,a,i,o,r)=>{console.info("callback",r,r.onlineStr),t[e].value=r.onlineStr,t[l[0]].value=a,t[l[1]].value=i,console.info("newParam",a,i,t),this.setState({formData:t})}})}),this.handleFormChange=(e=>{if(e){var t=this.state,a=t.fwParam;t.formData;a.newData||(a.newData={}),Object.keys(e).map(t=>{var a=e[t],l=this.getLayout().columnMap[t],i=l.ui,o=null;if(a&&null!=a.value)if(this.state.formData[t]||(this.state.formData[t]={}),o=a.value,"DEVICE_NOS"==l.id){if(console.info("DEVICE_NOS",a.value),Array.isArray(a.value)){var r=this.state.totalInputDevices;a.value.length>0?a.value.map(e=>r[e]=!0):r={},this.setState({totalInputDevices:r,inputDeviceCount:a.value.length}),o=a.value.join(",")}}else if("DatePicker"===i)o=a.value.format(l.pattern?l.pattern:"YYYY-MM-DD");else if("TimePicker"===i)o=a.value.format(l.pattern?l.pattern:"HH:mm:ss");else if("checkbox01"===i)o=a.value?"1":"0";else if(l.dictionary)"checkbox"==l.ui&&Array.isArray(a.value)&&(o=a.value.join(","));else if("Cascader"==l.ui)Array.isArray(a.value)&&(o=a.value.join(","),console.info("Cascader",a.value,o));else if("AutoComplete"==l.ui)o=a.value;else if(l.valueRef&&"TreeSelect"!=l.ui){if(o=Array.isArray(a.value)?a.value.filter(e=>e&&e.key).map(e=>e.key).join(","):a.value.key?a.value.key:null,l.showColumn){var s=this.getLayout().columnMap[l.showColumn.split(",")[0]];if(s){var n=a.value.map(e=>Array.isArray(e.label)?e.label[0]:e.label).join(",");this.state.formData[s.id]||(this.state.formData[s.id]={}),this.state.formData[s.id].value=n}}}else if("Upload"===l.ui)console.info("upload",o),Array.isArray(o)&&(o=o[0].name);else if("MAP"==l.ui)o=this.state.formData[t].value,a.dirty=!0;else if("SHOP_ID"==l.id){var d=this.state.refData[l.id],u=this.findNode(a.value,d.data);this.setState({uploadDisabled:!0}),u&&(console.info("selectedNode",u),u.PARENT_ID||"1"==u.TYPE?this.setState({uploadDisabled:!1,selectedShop:u}):(a.errors=[new Error("\u8bf7\u9009\u62e9\u95e8\u5e97")],o=null))}a.value=o}),this.setState({formData:(0,w.default)({},this.state.formData,e),fwParam:a})}}),this.doOtherInputValidate=(()=>{return null}),this.processEditSaveResult=(e=>{e.success||(document.querySelectorAll("li.ant-select-selection__choice[title]").forEach(e=>delete e.style.color),e.validResultMap&&e.validResultMap["ERROR_DEVICE_NOS"]&&e.validResultMap["ERROR_DEVICE_NOS"].map(e=>{var t=document.querySelector('li.ant-select-selection__choice[title="'+e+'"]');t&&(t.style.color="#ff0000")}))}),this.getDisplayValue=(e=>{var t=this.state.fwParam.newData,l=0,i=t[e.id],r=i;if(e.onFormat)r=a("WSuX")(`./${this.getLayout().clientLogicMap[e.onFormat].file}`).default(i,t,l,e,this);else if(e.dictionary){var s=this.getLayout().dictMap[e.dictionary][i];r=s||i}else e.showColumn&&(r=e.showColumn.split(",").map(e=>t[e]).join(" "));return o.default.createElement("span",null,r)}),this.findNode=((e,t)=>{var a=t;if(void 0==a)a=this.state.treeData;else if(null==t||t.length<1)return null;var l=a.filter(t=>t["SID"]==e);if(l.length>0)return l[0];var i=a.filter(e=>e.children&&e.children.length>0).map(t=>this.findNode(e,t.children)).filter(e=>!!e);return i.length>0?i[0]:null}),this.getLayout=(()=>{return this.state.innerLayout&&this.state.innerLayout!=this.props.innerLayout?this.state.innerLayout:this.props.innerLayout?this.props.innerLayout:this.props.layout}),this.getFwCoord=(()=>{return(0,w.default)({},this.props.fwCoord,this.props.innerFwCoord)}),this.onFormRef=(e=>{this.props.form=e}),this.getActionEntry=function(e){return R.getActionEntry(this,e)},this.handleAction=function(e,t){var a=null,l=null;t?(a=t,l=e):(a=e.key,l=e.domEvent),this.getActionEntry(this.getLayout().actionArgs[a].click).logic(this,a,null,-1,l)},this.FIX_WIDTH={},this.CustomizedForm=b.default.create({onFieldsChange(e,t){e.onChange(t)},mapPropsToFields:e=>{var t={};return this.getLayout().columns.filter(e=>e.visible).map(e=>{var a=(0,w.default)({},this.state.formData[e.id]);if(a&&null!=a.value)if("DEVICE_NOS"==e.id)console.info("DEVICE_NOS2",a.value),a.value?a.value=a.value.split(","):a.value=[];else if("DatePicker"===e.ui)a.value=a.value?(0,T.default)(a.value,e.pattern?e.pattern:"YYYY-MM-DD"):a.value;else if("TimePicker"===e.ui)a.value=a.value?(0,T.default)(a.value,e.pattern?e.pattern:"HH:mm:ss"):a.value;else if("checkbox01"===e.ui)a.value="1"==a.value;else if(e.dictionary)"checkbox"==e.ui?Array.isArray(a.value)||(a.value=String(a.value).split(",")):a.value=String(a.value);else if("Cascader"==e.ui)a.value=String(a.value).split(",");else if("AutoComplete"==e.ui);else if(e.valueRef&&"TreeSelect"!=e.ui){if(Array.isArray(a.value)||(a.value?a.value=String(a.value).split(",").map(e=>({key:e})):a.value=[]),Array.isArray(a.value)&&e.showColumn){var l=this.state.formData[e.showColumn.split(",")[0]];l&&l.value&&l.value.split(",").map((e,t)=>a.value.length>t?a.value[t].label=e:null)}}else"MAP"==e.ui||("NUM"!=e.type||e.dictionary?a.value=String(a.value):(""==a.value&&(a.value=null),null!=a.value&&(e.decimalSize>0?a.value=parseFloat(a.value):a.value=parseInt(a.value))));e.valueRef&&"TreeSelect"!=e.ui&&null==a.value&&delete a.value,t[e.id]=b.default.createFormField((0,w.default)({},a))}),t},onValuesChange(e,t){}})(e=>{this.state.form=e.form;var t=e.form.getFieldDecorator,a=this.getLayout().columns.filter(e=>e.visible),l={_default:[]},i={};this.getLayout().columnGroups&&this.getLayout().columnGroups.map(e=>i[e.id]=e),a.map(e=>{var t="_default";e.group&&i[e.group]&&(t=e.group),l[t]||(l[t]=[]),l[t].push(e)});var n=e=>e?e.map(e=>{var l=[];e.editable&&(l.push({required:e.required,message:"\u8bf7\u8f93\u5165"+e.label}),"NUM"==e.type?e.dictionary||e.valueRef||(e.max?l.push({type:"number",max:parseInt(e.max),message:e.label+"\u4e0d\u80fd\u8d85\u8fc7"+e.max}):e.size>0&&l.push({type:"number",max:Math.pow(10,parseInt(e.size))-1,message:e.label+"\u4e0d\u80fd\u8d85\u8fc7"+e.size+"\u4f4d"}),e.min&&l.push({type:"number",min:parseInt(e.min),message:e.label+"\u4e0d\u80fd\u5c0f\u4e8e"+e.min})):e.size>0&&l.push({max:e.size,message:e.label+"\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc7"+e.size}));var i={valuePropName:"value",rules:l};return"checkbox01"==e.ui?i.valuePropName="checked":"Upload"==e.ui&&(i.getValueFromEvent=this.normFile),o.default.createElement(r.default,{span:a.length>5?12:24,key:e.id},o.default.createElement(_,(0,g.default)({},j,{label:e.label}),t(e.id,i)(this.getInputComponent(e)),e.tail?" "+e.tail:null,"DEVICE_NOS"==e.id?o.default.createElement(s.default,{style:{textAlign:"right"}},"\u5df2\u5f55\u5165",this.state.inputDeviceCount,"\u4e2a"):null))}):[],d=[];return Object.keys(l).length>1?["_default",...this.getLayout().columnGroups.map(e=>e.id)].map(e=>{i[e]&&l[e]&&l[e].length>0&&d.push(o.default.createElement(r.default,{span:24,key:"group_"+e,style:{fontSize:16,marginTop:20}},o.default.createElement("b",null,i[e].title))),d=[...d,...n(l[e])]}):d=n(a),a.some(e=>"Upload"==e.ui)&&d.push(o.default.createElement(r.default,{key:"FW_uploadPrompt",span:24,style:{height:60,textAlign:"center"}},this.state.uploadResult)),o.default.createElement(b.default,null,o.default.createElement(s.default,{gutter:1},d))}),this.state=(0,w.default)({},e,{loading:!1,dialogs:{},form:{},treeData:[],refData:{COL:{loading:!1,data:[]}},components:{},formData:{},uploadedFile:null,uploadResult:null,manualValues:{},uploadDisabled:!0,selectedShop:{},inputDeviceCount:0,totalInputDevices:{}})}componentDidMount(){this.props.innerLayout||this.setTitle(),this.props.onRef&&this.props.onRef(this),this.refresh()}refresh(){if(this.props.dataManaged){var e=this.state,t=e.fwParam,a=e.formData;t.newData=(0,w.default)({},this.props.initData),t.oldData=(0,w.default)({},this.props.initData),Object.keys(this.props.initData).map(e=>a[e]={value:this.props.initData[e]}),this.setState({fwParam:this.state.fwParam,formData:a,refData:{}})}else if(this.props.showAsDialog){var l=(0,w.default)({},this.state.fwParam,{oldData:{},newData:{},selectedData:this.props.selectedData});this.props.getEditData({fwCoord:this.getFwCoord(),fwParam:l,callback:e=>{var t=this.state,a=t.fwParam,l=t.formData;a.newData=(0,w.default)({},e),a.oldData=(0,w.default)({},e),Object.keys(e).map(t=>l[t]={value:e[t]}),this.setState({fwParam:this.state.fwParam,formData:l,refData:{}})}})}else this.getLayout().onInit&&this.getActionEntry(this.getLayout().onInit).logic(this,this.getLayout().onInit,null,-1,null)}componentWillUpdate(){}setTitle(e){var t=this.getLayout(),a=t.title;document.title=e||a}render(){var e=this.CustomizedForm;return o.default.createElement("div",null,o.default.createElement(v.default,{spinning:this.props.loading||this.state.loading},o.default.createElement(e,{onChange:this.handleFormChange})),Object.values(this.state.dialogs))}})||L);t.default=z},rq8y:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=s,t.logic=n,t.handleOk=d,t.handleCancel=u;var o=i(a("q1tI"));a("Pwec");var r=i(a("CtXQ"));l(a("uYVn"));function s(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(r.default,{type:this.action.icon}),this.action.label," "))}function n(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,window.open("main.html?fwCoord.view=main&fwCoord.project=zd4s&fwCoord.function=main&fwCoord.ui=antd&fwCoord.lang=zh_cn&su="+a.USER_ID)}function d(e){}function u(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},sbYD:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=c,t.logic=f,t.handleOk=h,t.handleCancel=m;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr"));a("2qtc");var s=i(a("kLXV")),n=i(a("MVZn"));a("Pwec");var d=i(a("CtXQ")),u=l(a("uYVn"));function c(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(d.default,{type:this.action.icon}),this.action.label," "))}function f(e,t,l,i,d){if(this.view=e,this.action=e.getLayout().actionArgs[t],this.record=l,this.recordIndex=i,this.event=d,null==l&&this.view.state.selectedRowKeys&&this.view.state.selectedRowKeys.length>0){var u=this.view.state.selectedRowKeys[0];this.record=this.view.state.data[u],this.recordIndex=u}var c=(0,n.default)({},this.view.getFwCoord(),{view:"create"});this.useSelectedData=!1,this.action.argument&&(this.useSelectedData=this.action.argument.useSelectedData,this.action.argument.function&&(c["function"]=this.action.argument.function),this.action.argument.view&&(c["view"]=this.action.argument.view)),console.info("this.useSelectedData",this.useSelectedData,this.record);var f=(0,n.default)({},this.view.state.fwParam,{openerActionId:t,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,openerSelectedData:this.useSelectedData?this.record:null,selectedTreeNodeId:this.view.props.selectedTreeNodeId?this.view.props.selectedTreeNodeId:null,treeConnectColumn:this.view.props.gridToTreeField?this.view.props.gridToTreeField:null,oldData:{},newData:{}}),h=null;if(this.action.argument&&this.action.argument.antdPath){var m=this.action.argument.antdPath;h=a("RO01")(`./${m}`).default}else h=a("Yn9z").default;var p=e=>{this.innerLayout||(this.innerLayout={}),this.innerLayout[t]=e;var a=(0,n.default)({},this.view.state.clientNewDataTemplate);this.view.props.gridToTreeField&&(a[this.view.props.gridToTreeField]=this.view.props.selectedTreeNodeId),this.view.props.getCreateData({fwCoord:c,fwParam:(0,n.default)({},f,{newData:a}),callback:t=>{if(t){var a=t["_FW_DYNAMIC_LAYOUT"];delete t["_FW_DYNAMIC_LAYOUT"],a&&a.columns&&a.columns.map(t=>{var a=e.columnMap[t.id];a&&Object.keys(t).map(e=>a[e]=t[e])});var l=this.view.state.dialogs,i=e.columns.filter(e=>e.visible),n=i.length<5?"25vw":"42vw";l[this.id]=o.default.createElement(s.default,{width:n,key:this.id,title:e.title,visible:!0,maskClosable:!1,confirmLoading:this.view.props.createLoading,cancelText:"\u53d6\u6d88",onCancel:e=>this.handleCancel(e),okText:"\u4fdd\u5b58",onOk:e=>this.handleOk(e)},o.default.createElement(h,{selectedData:{},innerLayout:e,innerFwCoord:c,fwParam:f,dataManaged:!0,initData:t,clientNewData:t,showAsDialog:!0,onRef:e=>this.onRef(e)})),this.view.setState({dialogs:l})}else r.default.error("\u52a0\u8f7d\u6570\u636e\u9519\u8bef",10)}})};this.innerLayout&&this.innerLayout[t]?p(this.innerLayout[t]):this.view.props.loadLayout({fwCoord:c,fwParam:f,callback:p})}function h(e){var t=this.dialog.state.form,a=this.dialog.state.formData;t.validateFieldsAndScroll((l,i)=>{if(l)console.info("create error",l);else{if(this.dialog.doOtherInputValidate){var o=this.dialog.doOtherInputValidate();if(o){if("object"==typeof o){var s={};Object.keys(o).map(e=>{var t=a[e];s[e]=(0,n.default)({},t,{errors:[new Error(o[e])]})}),t.setFields(s)}else r.default.error(o);return}}var d=this.dialog.state.fwParam.newData;Object.keys(a).map(e=>d[e]=a[e].value),this.dialog.processNewData&&this.dialog.processNewData(d);var c=(0,n.default)({},this.dialog.state.fwParam,{selectedTreeNodeId:this.view.props.selectedTreeNodeId?this.view.props.selectedTreeNodeId:null,treeConnectColumn:this.view.props.gridToTreeField?this.view.props.gridToTreeField:null,openerActionId:this.action.id,openerFunction:this.view.getFwCoord()["function"],openerView:this.view.getFwCoord().view,openerSelectedData:this.useSelectedData?this.record:null,oldData:{},newData:d});this.dialog.props.saveCreateData({fwCoord:this.dialog.getFwCoord(),fwParam:c,callback:a=>{if(a.success)u.isEmpty(a.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(a.errorMsg,10),this.view.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var l={};Object.keys(a.validResultMap).map(e=>{l[e]={value:i[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(l)}u.isEmpty(a.errorMsg)||r.default.error(a.errorMsg,10)}}})}})}function m(e){var t=this.view.state.dialogs;delete t[this.id],this.view.setState({dialogs:t})}},tMO9:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=u,t.logic=c,t.handleOk=f,t.handleCancel=h;var o=i(a("q1tI"));a("miYZ");var r=i(a("tsqr")),s=i(a("MVZn"));a("Pwec");var n=i(a("CtXQ")),d=l(a("uYVn"));function u(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(n.default,{type:this.action.icon}),this.action.label," "))}function c(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i;var o=this.view.state.form,n=this.view.state.formData;o.validateFieldsAndScroll((e,t)=>{if(e)console.info("error",e);else{if(this.view.doOtherInputValidate){var a=this.view.doOtherInputValidate();if(a){if(Array.isArray(a)){var l={};Object.keys(a).map(e=>{var t=n[e];l[e]=(0,s.default)({},t,{errors:[new Error(a[e])]})}),o.setFields(l)}else r.default.error(a);return}}var i=this.view.state.fwParam.newData;Object.keys(n).map(e=>i[e]=n[e].value);var u=(0,s.default)({},this.view.state.fwParam,{newData:i});console.info("final formData:",JSON.stringify(n)),this.view.props.saveEditData({fwCoord:this.view.getFwCoord(),fwParam:u,callback:e=>{if(e.success)d.isEmpty(e.errorMsg)?r.default.success("\u4fdd\u5b58\u6210\u529f"):r.default.info(e.errorMsg,10),this.view.refresh();else{if(e.validResultMap){var a={};Object.keys(e.validResultMap).map(l=>{a[l]={value:t[l],errors:[new Error(e.validResultMap[l])]}}),o.setFields(a)}d.isEmpty(e.errorMsg)||r.default.error(e.errorMsg,10)}}})}})}function f(e){}function h(e){}},vvwl:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;var o=i(a("q1tI"));l(a("uYVn"));function r(e,t,a,l,i){var r=i.getLayout().dictMap[l.dictionary][e],s=null;return s=["0","1"].some(t=>t==e)?"rgb(102, 204, 102)":"rgb(153, 153, 153)",o.default.createElement("span",{key:a},o.default.createElement("span",{style:{color:s}},"\u25cf"),"\xa0",o.default.createElement("span",{style:{color:"rgb(101, 101, 101)"}},r))}},wVw7:function(e,t,a){e.exports={"ant-advanced-search-form":"ant-advanced-search-form___M7oOy","ant-form-item":"ant-form-item___nhptW","ant-form-item-control-wrapper":"ant-form-item-control-wrapper___1f-FL",queryValue:"queryValue___E_wqk"}},xdQr:function(e,t,a){"use strict";var l=a("284h");Object.defineProperty(t,"__esModule",{value:!0}),t.logic=i;l(a("uYVn"));function i(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,this.view.getGridData({})}},yOrV:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=l(a("q1tI"));a("miYZ");var r=i(a("tsqr"));a("pC0b");var s=i(a("GzdX"));a("2qtc");var n=i(a("kLXV")),d=i(a("pVnL"));a("5NDa");var u=i(a("5rEg"));a("/zsF");var c=i(a("PArb"));a("g9YV");var f=i(a("wCAj"));a("14J3");var h=i(a("BMrR"));a("+L6B");var m=i(a("2/Rp"));a("jCWc");var p=i(a("kPKH")),v=i(a("MVZn"));a("7Kak");var g=i(a("9yH6"));a("y8nQ");var w,y,C=i(a("Vl3Y")),D=a("MuoO"),E=i(a("DQt+")),b=a("iv27"),S=l(a("uYVn")),L=i(a("cc/Q")),P=i(a("wd/R"));a("XDpg"),P.default.locale("zh-cn");var k=C.default.Item;g.default.Group;function I(e){var t=e.fw,a=t.dispatch,l=t.fwCoord,i=t.layout;return{dispatch:a,fwCoord:l,layout:i}}var R=e=>{return{getEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/getEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},saveEditData:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"edit/saveEditData",payload:{fwCoord:a,fwParam:l,callback:i}})},loadLayout:t=>{var a=t.fwCoord,l=t.fwParam,i=t.callback;e({type:"fw/loadLayout",payload:{fwCoord:a,fwParam:l,callback:i}})}}},T=(w=(0,D.connect)(I,R),w(y=class extends o.Component{constructor(e){super(e),this.showEditAction=(0,v.default)({onRef:function(e){this.dialog=e}},a("fs94")),this.showEditVehicleAction=(0,v.default)({onRef:function(e){this.dialog=e}},a("8vKD")),this.showGpsLocationAction=(0,v.default)({onRef:function(e){this.dialog=e}},a("+p4c")),this.showGpsLocation=(()=>{this.showGpsLocationAction.logic(this,"showGpsLocation",this.state.vehicleInfo,0,null)}),this.handleFormChange=(e=>{if(console.info("handleFormChange",this.form,e),e){var t={};Object.values(e).map(e=>{if("currentMile"==e.name&&e.value){var a=String(e.value).split("").filter(e=>S.isNumber(e)).join("");a!=e.value&&(t[e.name]=a)}}),Object.keys(t).length>0&&this.form.setFieldsValue(t)}}),this.CustomizedForm=C.default.create({onFieldsChange(e,t){e.onChange(t)},onValuesChange(e,t){}})(e=>{this.form=e.form;var t={labelCol:{span:8},wrapperCol:{span:16},style:{height:"20px"}},a=e.form.getFieldDecorator,l=[{title:"\u65f6\u95f4",dataIndex:"SERVICE_TIME",width:"10%"},{title:"\u9879\u76ee",dataIndex:"SERVICE_TYPE",width:"10%",render:e=>{return"0"===e?"\u4fdd\u517b":"1"===e?"\u5e38\u89c4\u673a\u4fee":"2"===e?"\u4e8b\u6545\u7ef4\u4fee":"3"===e?"\u7eed\u4fdd":void 0}},{title:"\u91cc\u7a0b\uff08\u516c\u91cc\uff09",dataIndex:"MILE",width:"7%",align:"right"},{title:"\u8d39\u7528\uff08\u5143\uff09",dataIndex:"SERVICE_FEE",width:"7%",align:"right"},{title:"\u670d\u52a1\u5907\u6ce8",dataIndex:"MEMO",width:"25%"},{title:"\u5ba2\u6237\u8bc4\u4ef7",dataIndex:"MEMBER_REMARKING",width:"25%"},{title:"\u5ba2\u6237\u8bc4\u5206",dataIndex:"MEMBER_RANKING",width:"10%"},{title:"\u64cd\u4f5c",width:"5%",render:(e,t,a)=>{return o.default.createElement("div",null,o.default.createElement("a",{href:"javascript:",onClick:()=>this.clickListRow(t)},"\u8be6\u60c5"))}}],i=[{title:"\u63d0\u9192\u65f6\u95f4",dataIndex:"REMIND_TIME",width:"20%",render:(e,t,a)=>(0,P.default)(e).format("YYYY-MM-DD")},{title:"\u63d0\u9192\u7c7b\u578b",dataIndex:"REMIND_TYPE",width:"15%",render:e=>{return"0"===e?"\u4fdd\u517b":"1"===e?"\u7eed\u4fdd":"2"===e?"\u5546\u4e1a\u9669":"3"===e?"\u5546\u4e1a\u9669\u548c\u4ea4\u5f3a\u9669":void 0}},{title:"\u63d0\u9192\u8bf4\u660e",dataIndex:"REMIND_NOTE",width:"30%"},{title:"\u8ba1\u5212\u56de\u8bbf",dataIndex:"PLAN_CALLBACK_DATE",width:"20%",render:(e,t,a)=>{return null==e||"null"===e?"":(0,P.default)(e).format("YYYY-MM-DD")}},{title:"\u72b6\u6001",dataIndex:"STATUS",width:"15%",render:e=>{return"0"===e?"\u5f85\u5206\u914d":"1"===e?"\u672a\u8054\u7cfb":"2"===e?"\u5f85\u8ddf\u8fdb":"3"===e?"\u5df2\u9884\u7ea6":"4"===e?"\u5df2\u5b8c\u6210":"5"===e?"\u5df2\u6218\u8d25":"9"===e?"\u5df2\u56de\u6536":void 0}}];return o.default.createElement("div",{style:{height:innerHeight-120,fontSize:"12px"}},o.default.createElement("div",{id:"memberInfo",style:{paddingLeft:"15px",paddingTop:"15px",paddingBottom:"15px",backgroundColor:"white",marginRight:"10px",border:"1px solid #EAEAEA"}},o.default.createElement(h.default,null,o.default.createElement(p.default,{span:2},o.default.createElement(E.default,{sex:this.showValue(this.state.memberInfo,"SEX"),memberLevel:this.showValue(this.state.memberInfo,"LEVEL"),headImage:this.showValue(this.state.memberInfo,"WECHAT_HEADIMGURL")})),o.default.createElement(p.default,{span:22},o.default.createElement(h.default,{style:{height:"27px"}},o.default.createElement(p.default,{span:8},o.default.createElement("span",{style:{fontSize:"14px",fontWeight:"bold"}},this.showValue(this.state.memberInfo,"NAME")),"\uff08",0==this.showValue(this.state.memberInfo,"SEX")?"\u5148\u751f":"\u5973\u58eb","\uff09",this.state.memberInfo&&this.state.memberInfo.WECHAT_OPENID?o.default.createElement("a",{href:"javascript:;"},"\u5fae\u4fe1\u7ed1\u5b9a"):""),o.default.createElement(p.default,{span:16,style:{textAlign:"right",paddingRight:"50px"}},o.default.createElement(m.default,{type:"primary",onClick:()=>this.showUpdateMemberInfo()},"\u7f16\u8f91\u4f1a\u5458"),"\xa0\xa0")),o.default.createElement(h.default,{style:{height:"27px"}},o.default.createElement(p.default,{span:4},"\u4f1a\u5458\u79ef\u5206\uff1a",this.showValue(this.state.memberInfo,"BONUS")),o.default.createElement(p.default,{span:4},"\u4f1a\u5458\u6765\u6e90\uff1a","1"===this.showValue(this.state.memberInfo,"MEMBER_SOURCE")?"\u81ea\u5e97\u8d2d\u8f66":"\u552e\u540e\u5f00\u62d3"),o.default.createElement(p.default,{span:5},"\u624b\u673a\u53f7\uff1a",this.showValue(this.state.memberInfo,"MOBILE_NO")),o.default.createElement(p.default,{span:4},"\u804c\u4e1a\uff1a",this.showValue(this.state.memberInfo,"OCCUPATION")),o.default.createElement(p.default,{span:7},"\u9a7e\u9f84\uff1a",this.showValue(this.state.memberInfo,"DRIVE_YEARS"))),o.default.createElement(h.default,{style:{height:"27px"}},o.default.createElement(p.default,{span:4},"\u6ce8\u518c\u65f6\u95f4\uff1a",this.showValue(this.state.memberInfo,"CREATEDATE")),o.default.createElement(p.default,{span:4},"\u95e8\u5e97\uff1a",this.showValue(this.state.memberInfo,"DEPTNAME")),o.default.createElement(p.default,{span:5},"\u8eab\u4efd\u8bc1\u53f7\uff1a",this.showValue(this.state.memberInfo,"ID_NO")),o.default.createElement(p.default,{span:4},"\u5bb6\u5ead\u6536\u5165\uff1a",this.showValue(this.state.memberInfo,"FAMILIY_INCOMING")),o.default.createElement(p.default,{span:7},"\u4f1a\u5458\u5730\u5740\uff1a",this.showMemberAddress(this.showValue(this.state.memberInfo,"ADDRESS"))))))),o.default.createElement("div",{id:"vehicleInfo",className:L.default.scrollAuto,style:{height:innerHeight-250,marginTop:"15px",paddingLeft:"15px",paddingTop:"15px",paddingBottom:"15px",backgroundColor:"white",marginRight:"10px",border:"1px solid #EAEAEA"}},o.default.createElement(h.default,null,o.default.createElement(p.default,{span:16,style:{fontSize:"14px",fontWeight:"bold"}},"\u8f66\u8f86\u4fe1\u606f"),o.default.createElement(p.default,{span:8,style:{textAlign:"right",paddingRight:"50px"}},o.default.createElement(m.default,{type:"primary",onClick:()=>this.showUpdateVehicleInfo()},"\u7f16\u8f91\u8f66\u8f86\u4fe1\u606f"),"\xa0\xa0")),o.default.createElement(h.default,{style:{paddingLeft:"20px",height:"25px",marginTop:"10px"}},o.default.createElement(p.default,{span:4},"\u8f66\u578b\uff1a",this.showCarType(this.showValue(this.state.vehicleInfo,"CAR_MODEL"))),o.default.createElement(p.default,{span:5},"VIN\u7801\uff1a",this.showValue(this.state.vehicleInfo,"VIN")),o.default.createElement(p.default,{span:4},"\u8f66\u8f86\u4ef7\u683c\uff1a",this.showValue(this.state.vehicleInfo,"PRICE")),o.default.createElement(p.default,{span:4},"\u8d2d\u8f66\u65e5\u671f\uff1a",this.showValue(this.state.vehicleInfo,"BY_DATE")),o.default.createElement(p.default,{span:7},"\u91cc\u7a0b\uff1a",this.showValue(this.state.vehicleInfo,"CURRENT_MILE")," \u5343\u7c73\xa0",o.default.createElement("a",{onClick:()=>this.modifyMile()}," \u4fee\u6b63\u91cc\u7a0b"))),o.default.createElement(h.default,{style:{width:"100%",paddingLeft:"20px",height:"25px"}},o.default.createElement(p.default,{span:4},"\u8f66\u724c\u53f7\uff1a",this.showValue(this.state.vehicleInfo,"VEHICLE_NUM")),o.default.createElement(p.default,{span:5},"\u989c\u8272\uff1a",this.showValue(this.state.vehicleInfo,"COLOR")),o.default.createElement(p.default,{span:4},"\u53d1\u52a8\u673a\u53f7\uff1a",this.showValue(this.state.vehicleInfo,"ENGINE_ID")),o.default.createElement(p.default,{span:4},"\u8f66\u8f86\u767b\u8bb0\u65e5\u671f\uff1a",this.showValue(this.state.vehicleInfo,"REG_DATE")),o.default.createElement(p.default,{span:7},"GPS\u8bbe\u5907\u53f7\uff1a",this.state.vehicleInfo&&this.state.vehicleInfo.GPS_DEVICE_NO?o.default.createElement("a",{href:"javascript:;",onClick:()=>this.showGpsLocation()},this.state.vehicleInfo.GPS_DEVICE_NO):"-")),o.default.createElement(h.default,{style:{width:"100%",paddingLeft:"20px",height:"25px"}},o.default.createElement(p.default,{span:4},"\u5546\u4e1a\u9669\u5230\u671f\uff1a",this.showValue(this.state.insuranceInfo,"COMMERCIAL_INS_DUE_DATE")),o.default.createElement(p.default,{span:5},"\u4ea4\u5f3a\u9669\u5230\u671f\uff1a",this.showValue(this.state.insuranceInfo,"COMPULSORY_INS_DUE_DATE")),o.default.createElement(p.default,{span:4},"\u76d7\u62a2\u9669\u5230\u671f\uff1a",this.showValue(this.state.insuranceInfo,"THEFT_INS_DUS_DATE")),o.default.createElement(p.default,{span:4},"\u4e0b\u6b21\u4fdd\u517b\uff1a",this.showValue(this.state.vehicleInfo,"NEXT_MAINTAIN_MILE"),"\u516c\u91cc/",this.showValue(this.state.vehicleInfo,"NEXT_MAINTAIN_DATE"))),o.default.createElement(h.default,{style:{marginTop:"15px",marginBottom:"15px"}},o.default.createElement(p.default,{span:24,style:{fontSize:"14px",fontWeight:"bold"}},"\u670d\u52a1\u63d0\u9192")),o.default.createElement(h.default,null,o.default.createElement(p.default,{span:24},o.default.createElement(f.default,{columns:i,dataSource:this.state.remindList,pagination:this.state.remindPagination,onChange:e=>this.onRemindPageChange(e),expandedRowRender:e=>this.showRemindFollowList(e),rowKey:"SID"}))),o.default.createElement(h.default,null,o.default.createElement(p.default,{span:24,style:{fontSize:"14px",fontWeight:"bold"}},"\u670d\u52a1\u8bb0\u5f55")),o.default.createElement(h.default,null,o.default.createElement(p.default,{span:24},o.default.createElement("div",{style:{marginTop:"10px",marginBottom:"10px"}},"\u603b\u8ba1\u6d88\u8d39\uff1a",o.default.createElement("font",{style:{fontWeight:"bold",color:"green"}},this.state.totalServiceInfo.totalFee,"\u5143")," ",o.default.createElement(c.default,{type:"vertical"})," \u4fdd\u517b\uff1a",o.default.createElement("font",{style:{fontWeight:"bold",color:"green"}},this.state.totalServiceInfo.type0,"\u6b21")," ",o.default.createElement(c.default,{type:"vertical"})," \u5e38\u89c4\u673a\u4fee\uff1a",o.default.createElement("font",{style:{fontWeight:"bold",color:"green"}},this.state.totalServiceInfo.type1,"\u6b21"),o.default.createElement(c.default,{type:"vertical"})," \u4e8b\u6545\u7ef4\u4fee\uff1a",o.default.createElement("font",{style:{fontWeight:"bold",color:"green"}},this.state.totalServiceInfo.type2,"\u6b21")," ",o.default.createElement(c.default,{type:"vertical"})," \u7eed\u4fdd\uff1a",o.default.createElement("font",{style:{fontWeight:"bold",color:"green"}},this.state.totalServiceInfo.type3,"\u6b21")),o.default.createElement(f.default,{columns:l,dataSource:this.state.serviceList,pagination:this.state.servicePagination,onChange:e=>this.onServicePageChange(e),rowKey:"SID",size:"small"})))),o.default.createElement(n.default,{title:"\u4fee\u6539\u91cc\u7a0b",visible:this.state.showMileFlag,onCancel:()=>this.cancelShowMile(),onOk:()=>this.updateCurrentMile(),width:500},o.default.createElement(h.default,null,o.default.createElement(p.default,{span:20},o.default.createElement(k,(0,d.default)({},t,{label:"\u91cc\u7a0b\uff1a"}),a("currentMile",{rules:[{required:!0,message:"\u8bf7\u586b\u5199\u91cc\u7a0b"}],initialValue:this.showValue(this.state.vehicleInfo,"CURRENT_MILE")})(o.default.createElement(u.default,{maxLength:10,placeholder:"\u8bf7\u8f93\u5165"})))))),o.default.createElement(n.default,{title:"\u670d\u52a1\u8be6\u60c5",visible:this.state.showServiceDetailFlag,onCancel:()=>this.cancelShowService(),footer:null,width:700},o.default.createElement("div",{id:"memberInfoDetail",style:{height:"350px"}},o.default.createElement("div",{style:{float:"left",width:"15%"}},o.default.createElement(E.default,{sex:this.showValue(this.state.serviceInfoDetail,"SEX"),memberLevel:this.showValue(this.state.serviceInfoDetail,"LEVEL"),headImage:this.state.serviceInfoDetail.WECHAT_HEADIMGURL})),o.default.createElement("div",{style:{float:"left",width:"85%"}},o.default.createElement(h.default,null,o.default.createElement(p.default,{span:6},this.showValue(this.state.serviceInfoDetail,"NAME"),"\uff08","0"===this.showValue(this.state.serviceInfoDetail,"SEX")?"\u5148\u751f":"\u5973\u58eb","\uff09")),o.default.createElement(h.default,null,o.default.createElement(p.default,{span:6},this.showValue(this.state.serviceInfoDetail,"MOBILE_NO"))),o.default.createElement(h.default,null,o.default.createElement(p.default,{span:6},"\u8f66\u724c\uff1a",this.showValue(this.state.serviceInfoDetail,"VEHICLE_NUM")),o.default.createElement(p.default,{span:10},"VIN\u7801\uff1a",this.showValue(this.state.serviceInfoDetail,"VIN")),o.default.createElement(p.default,{span:8},"\u8f66\u578b\uff1a",this.showCarType(this.showValue(this.state.serviceInfoDetail,"CAR_MODEL"))))),o.default.createElement("div",null,o.default.createElement(h.default,null,o.default.createElement(p.default,{span:24},"\u670d\u52a1\u4fe1\u606f")),o.default.createElement(h.default,null,o.default.createElement(p.default,{span:8},"\u670d\u52a1\u7c7b\u578b\uff1a",this.showServiceType(this.state.serviceInfoDetail,"SERVICE_TYPE")),o.default.createElement(p.default,{span:8},"\u6d88\u8d39\u91d1\u989d\uff1a",this.showValue(this.state.serviceInfoDetail,"SERVICE_FEE"),"\xa0\u5143"),o.default.createElement(p.default,{span:8},"\u91cc\u7a0b\uff1a",this.showValue(this.state.serviceInfoDetail,"MILE"),"\xa0\u516c\u91cc")),o.default.createElement(h.default,null,o.default.createElement(p.default,{span:8},"\u63a5\u5f85\u95e8\u5e97\uff1a",this.showValue(this.state.serviceInfoDetail,"SHOP_ID")),o.default.createElement(p.default,{span:8},"\u63a5\u5f85\u4eba\u5458\uff1a",this.showValue(this.state.serviceInfoDetail,"STAFF"))),o.default.createElement(h.default,null,o.default.createElement(p.default,{span:24},"\u670d\u52a1\u5907\u6ce8\uff1a",this.showValue(this.state.serviceInfoDetail,"MEMO"))),o.default.createElement(h.default,null,o.default.createElement(p.default,{span:24},"\u5ba2\u6237\u8bc4\u5206\uff1a",o.default.createElement(s.default,{disabled:!0,defaultValue:this.state.serviceInfoDetail.MEMBER_RANKING}))),o.default.createElement(h.default,null,o.default.createElement(p.default,{span:24},"\u5ba2\u6237\u8bc4\u4ef7\uff1a",this.showValue(this.state.serviceInfoDetail,"MEMBER_REMARKING")))))),Object.values(this.state.dialogs))}),this.state={showUpdateMemberFlag:!1,showMileFlag:!1,showServiceDetailFlag:!1,memberInfo:this.props.memberInfo,vehicleInfo:this.props.vehicleInfo,serviceList:this.props.serviceList,insuranceInfo:this.props.insuranceInfo,remindList:[],serviceInfoDetail:{},totalServiceInfo:{},remindPagination:{style:{marginRight:5},showSizeChanger:!0,showQuickJumper:!0,current:1,pageSize:5,total:null,size:"small"},servicePagination:{style:{marginRight:5},showSizeChanger:!0,showQuickJumper:!0,current:1,pageSize:5,total:null},dialogs:{}},this.loadMemberInfo(e)}loadMemberInfo(e){(0,b.getMemberRelationInfo)({memberIdAndCarId:e.state.memberIdAndCarId}).then(e=>{this.setState({memberInfo:e.data.memberInfo,vehicleInfo:e.data.vehicleInfo,serviceList:e.data.serviceList,insuranceInfo:e.data.insuranceInfo})}).catch(e=>{r.default.error("\u9009\u62e9\u4f1a\u5458\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7cfb\u7edf\u7ba1\u7406\u5458\uff01",10)}),(0,b.getRemindAndFollowList)({memberId:e.state.memberIdAndCarId}).then(e=>{e.data.success?this.setState({remindList:e.data.remindList}):r.default.error("\u83b7\u53d6\u63d0\u9192\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7cfb\u7edf\u7ba1\u7406\u5458\uff01",10)}).catch(e=>{console.log(e)}),(0,b.getTotalServiceInfo)({memberId:e.state.memberIdAndCarId}).then(e=>{e.data.success?this.setState({totalServiceInfo:e.data.totalServiceInfo}):r.default.error("\u83b7\u53d6\u4fdd\u517b\u548c\u6295\u4fdd\u7edf\u8ba1\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7cfb\u7edf\u7ba1\u7406\u5458\uff01",10)}).catch(e=>{console.log(e)})}componentWillReceiveProps(e){console.info("member info update",e.state),e.state.memberIdAndCarId!=this.props.state.memberIdAndCarId&&this.loadMemberInfo(e)}showValue(e,t){return null==e||"undefined"==e||null==e[t]||"undefined"==e[t]?"-":"VEHICLE_NUM"==t&&e[t]==e.VIN?"-":e[t]}showCarType(e){return null==e||""===e?e:e.replace(/,/g,"/")}showServiceType(e,t){return null==e||"undefined"==e||null==e[t]||"undefined"==e[t]?"\u4fdd\u517b":"0"===e[t]?"\u4fdd\u517b":"1"===e[t]?"\u5e38\u89c4\u673a\u4fee":"2"===e[t]?"\u4e8b\u6545\u7ef4\u4fee":"3"===e[t]?"\u7eed\u4fdd":e[t]}onRemindPageChange(e){this.setState({remindPagination:e})}onServicePageChange(e){this.setState({servicePagination:e})}showRemindFollowList(e){var t=[{title:"\u65f6\u95f4",dataIndex:"CREATEDATE",width:"20%"},{title:"\u8ddf\u8fdb\u4eba\u5458",dataIndex:"USER_ID",width:"15%",render:(e,t,a)=>{return o.default.createElement("div",null,t.USER_ID,t.NAME)}},{title:"\u6839\u636e\u72b6\u6001",dataIndex:"FOLLOW_STATUS",width:"15%",render:e=>{return"0"===e?"\u5f85\u8ddf\u8fdb":"1"===e?"\u5df2\u9884\u7ea6":"2"===e?"\u5df2\u6218\u8d25":"-"}},{title:"\u5ba2\u6237\u610f\u613f",dataIndex:"RETURN_DESIRE",width:"15%",render:e=>{return"0"===e?"\u610f\u613f\u5f31":"1"===e?"\u610f\u613f\u4e2d":"2"===e?"\u610f\u613f\u5f3a":"-"}},{title:"\u5907\u6ce8",dataIndex:"MEMO",width:"35%"}];return o.default.createElement("div",null,o.default.createElement(f.default,{showHeader:!1,columns:t,dataSource:e.FOLLOWLIST,pagination:!1,rowKey:"SID"}))}modifyMile(){this.setState({showMileFlag:!0})}cancelShowMile(){this.setState({showMileFlag:!1})}updateCurrentMile(){var e=this.form.getFieldsValue();(0,b.updateCurrentMile)({vehicleId:this.state.vehicleInfo.SID,currentMile:e.currentMile}).then(t=>{t.data.success?(this.setState({showMileFlag:!1,vehicleInfo:(0,v.default)({},this.state.vehicleInfo,{CURRENT_MILE:e.currentMile})}),r.default.success("\u4fee\u6539\u5f53\u524d\u91cc\u7a0b\u6210\u529f")):r.default.error("\u4fee\u6539\u5f53\u524d\u91cc\u7a0b\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7cfb\u7edf\u7ba1\u7406\u5458",10)}).catch(e=>{console.log(e)})}cancelUpdateMember(){this.setState({showUpdateMemberFlag:!1})}showUpdateMemberInfo(){this.showEditAction.logic(this,"showCreateInList",this.state.memberInfo,0,null)}showUpdateVehicleInfo(){this.showEditVehicleAction.logic(this,"showCreateInList",this.state.vehicleInfo,0,null)}cancelShowService(){this.setState({showServiceDetailFlag:!1})}updateMemberInfo(){var e=this.form.getFieldsValue();(0,b.updateMemberInfo)({memberId:this.state.memberInfo.SID,memberInfo:e}).then(t=>{t.data.success?(this.setState({showUpdateMemberFlag:!1,memberInfo:(0,v.default)({},this.state.memberInfo,e)}),r.default.success("\u66f4\u65b0\u4f1a\u5458\u8d44\u6599\u6210\u529f")):r.default.error("\u66f4\u65b0\u4f1a\u5458\u8d44\u6599\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7cfb\u7edf\u7ba1\u7406\u5458",10)}).catch(e=>{console.log(e)})}clickListRow(e){(0,b.getServiceDetailById)({serviceId:e.SID}).then(e=>{e.data.success?this.setState({serviceInfoDetail:e.data.serviceDetail,showServiceDetailFlag:!0}):r.default.error("\u83b7\u53d6\u670d\u52a1\u8be6\u60c5\u5931\u8d25\uff0c\u8bf7\u8054\u7cfb\u7cfb\u7edf\u7ba1\u7406\u5458\uff01")}).catch(e=>{console.log(e)})}goHistory(){this.props.jumpTo(this.props.state.prePath,{memberIdAndCarId:this.props.state.memberIdAndCarId},this.props.backParams)}showMemberAddress(e){return null==e||""===e?e:e.replace(/\u3001/g,"")}render(){var e=this.CustomizedForm;return o.default.createElement(e,{onChange:this.handleFormChange})}})||y);t.default=T},yXd3:function(e,t,a){"use strict";var l=a("284h"),i=a("TqRt");Object.defineProperty(t,"__esModule",{value:!0}),t.layout=d,t.logic=u,t.handleOk=c,t.handleCancel=f;var o=i(a("q1tI")),r=i(a("MVZn"));a("Pwec");var s=i(a("CtXQ")),n=l(a("uYVn"));function d(e,t,a,l){return this.view=e,this.action=e.getLayout().actionArgs[t],o.default.createElement("span",{key:this.action.fw_index,onClick:i=>this.logic(e,t,a,l,i)},o.default.createElement("a",{href:"javascript:;"},o.default.createElement(s.default,{type:this.action.icon}),this.action.label," "))}function u(e,t,a,l,i){this.view=e,this.action=e.getLayout().actionArgs[t],this.record=a,this.recordIndex=l,this.event=i,this.view.state.fwParam=(0,r.default)({},this.view.state.fwParam,{oldData:(0,r.default)({},this.view.props.selectedData),newData:(0,r.default)({},this.view.props.selectedData)}),this.view.props.getEditData({fwCoord:this.view.getFwCoord(),fwParam:{selectedData:(0,r.default)({},this.view.props.selectedData)},callback:e=>{var t={};Object.keys(e).map(a=>t[a]={value:e[a]}),this.view.setState({fwParam:(0,r.default)({},this.view.state.fwParam,{oldData:(0,r.default)({},e),newData:(0,r.default)({},e)}),formData:t,manualValues:{},refData:{}})}})}function c(e){var t=this.dialog.state.form;t.validateFieldsAndScroll((a,l)=>{a?console.info("error",a):(console.info("values",l,this.dialog.props.fwParam.oldData),this.dialog.props.saveEditData({fwCoord:this.dialog.getFwCoord(),fwParam:(0,r.default)({},this.dialog.state.fwParam),callback:a=>{if(a.success)n.isEmpty(a.errorMsg)?message.success("\u4fdd\u5b58\u6210\u529f"):message.info(a.errorMsg,10),this.dialog.getGridData({}),this.handleCancel(e);else{if(a.validResultMap){var i={};Object.keys(a.validResultMap).map(e=>{i[e]={value:l[e],errors:[new Error(a.validResultMap[e])]}}),t.setFields(i)}n.isEmpty(a.errorMsg)||message.error(a.errorMsg,10)}}}))})}function f(e){var t=this.dialog.state.dialogs;delete t[this.id],this.dialog.setState({dialogs:t})}}}]);